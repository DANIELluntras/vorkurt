"use strict";(self.webpackChunkvorkurt=self.webpackChunkvorkurt||[]).push([[746],{3461:(si,Ze,I)=>{I.d(Ze,{_t:()=>w});var v=I(7716),re=I(8583),f=I(1386),V=I(521),j=I(9490),J=I(9238),Ne=I(7574),me=I(3637),pe=I(6561);function Yt(m){const{subscriber:a,counter:c,period:h}=m;a.next(c),this.schedule({subscriber:a,counter:c+1,period:h},h)}var ne=I(9765),$e=I(5319),ri=I(1927),rt=I(6682),Ct=I(6782);function qe(m,a,c){for(let h in a)if(a.hasOwnProperty(h)){const p=a[h];p?m.setProperty(h,p,(null==c?void 0:c.has(h))?"important":""):m.removeProperty(h)}return m}function k(m,a){const c=a?"":"none";qe(m.style,{"touch-action":a?"":"none","-webkit-user-drag":a?"":"none","-webkit-tap-highlight-color":a?"":"transparent","user-select":c,"-ms-user-select":c,"-webkit-user-select":c,"-moz-user-select":c})}function Wt(m,a,c){qe(m.style,{position:a?"":"fixed",top:a?"":"0",opacity:a?"":"0",left:a?"":"-999em"},c)}function B(m,a){return a&&"none"!=a?m+" "+a:m}function At(m){const a=m.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(m)*a}function ut(m,a){return m.getPropertyValue(a).split(",").map(h=>h.trim())}function bn(m){const a=m.getBoundingClientRect();return{top:a.top,right:a.right,bottom:a.bottom,left:a.left,width:a.width,height:a.height}}function Rt(m,a,c){const{top:h,bottom:p,left:y,right:b}=m;return c>=h&&c<=p&&a>=y&&a<=b}function mt(m,a,c){m.top+=a,m.bottom=m.top+m.height,m.left+=c,m.right=m.left+m.width}function oi(m,a,c,h){const{top:p,right:y,bottom:b,left:D,width:L,height:q}=m,U=L*a,G=q*a;return h>p-G&&h<b+G&&c>D-U&&c<y+U}I(9761),I(8002),I(5257),I(3342),I(3190),I(946);class Tn{constructor(a,c){this._document=a,this._viewportRuler=c,this.positions=new Map}clear(){this.positions.clear()}cache(a){this.clear(),this.positions.set(this._document,{scrollPosition:this._viewportRuler.getViewportScrollPosition()}),a.forEach(c=>{this.positions.set(c,{scrollPosition:{top:c.scrollTop,left:c.scrollLeft},clientRect:bn(c)})})}handleScroll(a){const c=(0,V.sA)(a),h=this.positions.get(c);if(!h)return null;const p=c===this._document?c.documentElement:c,y=h.scrollPosition;let b,D;if(c===this._document){const U=this._viewportRuler.getViewportScrollPosition();b=U.top,D=U.left}else b=c.scrollTop,D=c.scrollLeft;const L=y.top-b,q=y.left-D;return this.positions.forEach((U,G)=>{U.clientRect&&c!==G&&p.contains(G)&&mt(U.clientRect,L,q)}),y.top=b,y.left=D,{top:L,left:q}}}function le(m){const a=m.cloneNode(!0),c=a.querySelectorAll("[id]"),h=m.nodeName.toLowerCase();a.removeAttribute("id");for(let p=0;p<c.length;p++)c[p].removeAttribute("id");return"canvas"===h?En(m,a):("input"===h||"select"===h||"textarea"===h)&&Xe(m,a),Pt("canvas",m,a,En),Pt("input, textarea, select",m,a,Xe),a}function Pt(m,a,c,h){const p=a.querySelectorAll(m);if(p.length){const y=c.querySelectorAll(m);for(let b=0;b<p.length;b++)h(p[b],y[b])}}let ge=0;function Xe(m,a){"file"!==a.type&&(a.value=m.value),"radio"===a.type&&a.name&&(a.name=`mat-clone-${a.name}-${ge++}`)}function En(m,a){const c=a.getContext("2d");if(c)try{c.drawImage(m,0,0)}catch(h){}}const ai=(0,V.i$)({passive:!0}),In=(0,V.i$)({passive:!1}),Dn=new Set(["position"]);class Nt{constructor(a,c,h,p,y,b){this._config=c,this._document=h,this._ngZone=p,this._viewportRuler=y,this._dragDropRegistry=b,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=!1,this._moveEvents=new ne.xQ,this._pointerMoveSubscription=$e.w.EMPTY,this._pointerUpSubscription=$e.w.EMPTY,this._scrollSubscription=$e.w.EMPTY,this._resizeSubscription=$e.w.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new ne.xQ,this.started=new ne.xQ,this.released=new ne.xQ,this.ended=new ne.xQ,this.entered=new ne.xQ,this.exited=new ne.xQ,this.dropped=new ne.xQ,this.moved=this._moveEvents,this._pointerDown=D=>{if(this.beforeStarted.next(),this._handles.length){const L=this._handles.find(q=>{const U=(0,V.sA)(D);return!!U&&(U===q||q.contains(U))});L&&!this._disabledHandles.has(L)&&!this.disabled&&this._initializeDragSequence(L,D)}else this.disabled||this._initializeDragSequence(this._rootElement,D)},this._pointerMove=D=>{const L=this._getPointerPositionOnPage(D);if(!this._hasStartedDragging){if(Math.abs(L.x-this._pickupPositionOnPage.x)+Math.abs(L.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const te=Date.now()>=this._dragStartTime+this._getDragStartDelay(D),ot=this._dropContainer;if(!te)return void this._endDragSequence(D);(!ot||!ot.isDragging()&&!ot.isReceiving())&&(D.preventDefault(),this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(D)))}return}this._boundaryElement&&(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=(this._preview||this._rootElement).getBoundingClientRect()),D.preventDefault();const q=this._getConstrainedPointerPosition(L);if(this._hasMoved=!0,this._lastKnownPointerPosition=L,this._updatePointerDirectionDelta(q),this._dropContainer)this._updateActiveDropContainer(q,L);else{const U=this._activeTransform;U.x=q.x-this._pickupPositionOnPage.x+this._passiveTransform.x,U.y=q.y-this._pickupPositionOnPage.y+this._passiveTransform.y,this._applyRootElementTransform(U.x,U.y),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&this._rootElement.setAttribute("transform",`translate(${U.x} ${U.y})`)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:q,event:D,distance:this._getDragDistance(q),delta:this._pointerDirectionDelta})})},this._pointerUp=D=>{this._endDragSequence(D)},this.withRootElement(a).withParent(c.parentDragRef||null),this._parentPositions=new Tn(h,y),b.registerDragItem(this)}get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(a){const c=(0,j.Ig)(a);c!==this._disabled&&(this._disabled=c,this._toggleNativeDragInteractions(),this._handles.forEach(h=>k(h,c)))}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(a){this._handles=a.map(h=>(0,j.fI)(h)),this._handles.forEach(h=>k(h,this.disabled)),this._toggleNativeDragInteractions();const c=new Set;return this._disabledHandles.forEach(h=>{this._handles.indexOf(h)>-1&&c.add(h)}),this._disabledHandles=c,this}withPreviewTemplate(a){return this._previewTemplate=a,this}withPlaceholderTemplate(a){return this._placeholderTemplate=a,this}withRootElement(a){const c=(0,j.fI)(a);return c!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{c.addEventListener("mousedown",this._pointerDown,In),c.addEventListener("touchstart",this._pointerDown,ai)}),this._initialTransform=void 0,this._rootElement=c),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(a){return this._boundaryElement=a?(0,j.fI)(a):null,this._resizeSubscription.unsubscribe(),a&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(a){return this._parentDragRef=a,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&Lt(this._rootElement),Lt(this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(a){!this._disabledHandles.has(a)&&this._handles.indexOf(a)>-1&&(this._disabledHandles.add(a),k(a,!0))}enableHandle(a){this._disabledHandles.has(a)&&(this._disabledHandles.delete(a),k(a,this.disabled))}withDirection(a){return this._direction=a,this}_withDropContainer(a){this._dropContainer=a}getFreeDragPosition(){const a=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:a.x,y:a.y}}setFreeDragPosition(a){return this._activeTransform={x:0,y:0},this._passiveTransform.x=a.x,this._passiveTransform.y=a.y,this._dropContainer||this._applyRootElementTransform(a.x,a.y),this}withPreviewContainer(a){return this._previewContainer=a,this}_sortFromLastPointerPosition(){const a=this._lastKnownPointerPosition;a&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(a),a)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){this._preview&&Lt(this._preview),this._previewRef&&this._previewRef.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){this._placeholder&&Lt(this._placeholder),this._placeholderRef&&this._placeholderRef.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(a){if(this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging))if(this.released.next({source:this}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(a),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const c=this._getPointerPositionOnPage(a);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(c),dropPoint:c})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(a){ce(a)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const c=this._dropContainer;if(c){const h=this._rootElement,p=h.parentNode,y=this._placeholder=this._createPlaceholderElement(),b=this._anchor=this._anchor||this._document.createComment(""),D=this._getShadowRoot();p.insertBefore(b,h),this._initialTransform=h.style.transform||"",this._preview=this._createPreviewElement(),Wt(h,!1,Dn),this._document.body.appendChild(p.replaceChild(y,h)),this._getPreviewInsertionPoint(p,D).appendChild(this._preview),this.started.next({source:this}),c.start(),this._initialContainer=c,this._initialIndex=c.getItemIndex(this)}else this.started.next({source:this}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(c?c.getScrollableParents():[])}_initializeDragSequence(a,c){this._parentDragRef&&c.stopPropagation();const h=this.isDragging(),p=ce(c),y=!p&&0!==c.button,b=this._rootElement,D=(0,V.sA)(c),L=!p&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),q=p?(0,J.yG)(c):(0,J.X6)(c);if(D&&D.draggable&&"mousedown"===c.type&&c.preventDefault(),h||y||L||q)return;this._handles.length&&(this._rootElementTapHighlight=b.style.webkitTapHighlightColor||"",b.style.webkitTapHighlightColor="transparent"),this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(Y=>this._updateOnScroll(Y)),this._boundaryElement&&(this._boundaryRect=bn(this._boundaryElement));const U=this._previewTemplate;this._pickupPositionInElement=U&&U.template&&!U.matchSize?{x:0,y:0}:this._getPointerPositionInElement(a,c);const G=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(c);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:G.x,y:G.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,c)}_cleanupDragArtifacts(a){Wt(this._rootElement,!0,Dn),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const c=this._dropContainer,h=c.getItemIndex(this),p=this._getPointerPositionOnPage(a),y=this._getDragDistance(p),b=c._isOverContainer(p.x,p.y);this.ended.next({source:this,distance:y,dropPoint:p}),this.dropped.next({item:this,currentIndex:h,previousIndex:this._initialIndex,container:c,previousContainer:this._initialContainer,isPointerOverContainer:b,distance:y,dropPoint:p}),c.drop(this,h,this._initialIndex,this._initialContainer,b,y,p),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:a,y:c},{x:h,y:p}){let y=this._initialContainer._getSiblingContainerFromPosition(this,a,c);!y&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(a,c)&&(y=this._initialContainer),y&&y!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=y,this._dropContainer.enter(this,a,c,y===this._initialContainer&&y.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:y,currentIndex:y.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(h,p),this._dropContainer._sortItem(this,a,c,this._pointerDirectionDelta),this._applyPreviewTransform(a-this._pickupPositionInElement.x,c-this._pickupPositionInElement.y))}_createPreviewElement(){const a=this._previewTemplate,c=this.previewClass,h=a?a.template:null;let p;if(h&&a){const y=a.matchSize?this._rootElement.getBoundingClientRect():null,b=a.viewContainer.createEmbeddedView(h,a.context);b.detectChanges(),p=Xt(b,this._document),this._previewRef=b,a.matchSize?ye(p,y):p.style.transform=Fe(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else{const y=this._rootElement;p=le(y),ye(p,y.getBoundingClientRect()),this._initialTransform&&(p.style.transform=this._initialTransform)}return qe(p.style,{"pointer-events":"none",margin:"0",position:"fixed",top:"0",left:"0","z-index":`${this._config.zIndex||1e3}`},Dn),k(p,!1),p.classList.add("cdk-drag-preview"),p.setAttribute("dir",this._direction),c&&(Array.isArray(c)?c.forEach(y=>p.classList.add(y)):p.classList.add(c)),p}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const a=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._applyPreviewTransform(a.left,a.top);const c=function(m){const a=getComputedStyle(m),c=ut(a,"transition-property"),h=c.find(D=>"transform"===D||"all"===D);if(!h)return 0;const p=c.indexOf(h),y=ut(a,"transition-duration"),b=ut(a,"transition-delay");return At(y[p])+At(b[p])}(this._preview);return 0===c?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(h=>{const p=b=>{var D;(!b||(0,V.sA)(b)===this._preview&&"transform"===b.propertyName)&&(null===(D=this._preview)||void 0===D||D.removeEventListener("transitionend",p),h(),clearTimeout(y))},y=setTimeout(p,1.5*c);this._preview.addEventListener("transitionend",p)}))}_createPlaceholderElement(){const a=this._placeholderTemplate,c=a?a.template:null;let h;return c?(this._placeholderRef=a.viewContainer.createEmbeddedView(c,a.context),this._placeholderRef.detectChanges(),h=Xt(this._placeholderRef,this._document)):h=le(this._rootElement),h.classList.add("cdk-drag-placeholder"),h}_getPointerPositionInElement(a,c){const h=this._rootElement.getBoundingClientRect(),p=a===this._rootElement?null:a,y=p?p.getBoundingClientRect():h,b=ce(c)?c.targetTouches[0]:c,D=this._getViewportScrollPosition();return{x:y.left-h.left+(b.pageX-y.left-D.left),y:y.top-h.top+(b.pageY-y.top-D.top)}}_getPointerPositionOnPage(a){const c=this._getViewportScrollPosition(),h=ce(a)?a.touches[0]||a.changedTouches[0]||{pageX:0,pageY:0}:a,p=h.pageX-c.left,y=h.pageY-c.top;if(this._ownerSVGElement){const b=this._ownerSVGElement.getScreenCTM();if(b){const D=this._ownerSVGElement.createSVGPoint();return D.x=p,D.y=y,D.matrixTransform(b.inverse())}}return{x:p,y}}_getConstrainedPointerPosition(a){const c=this._dropContainer?this._dropContainer.lockAxis:null;let{x:h,y:p}=this.constrainPosition?this.constrainPosition(a,this):a;if("x"===this.lockAxis||"x"===c?p=this._pickupPositionOnPage.y:("y"===this.lockAxis||"y"===c)&&(h=this._pickupPositionOnPage.x),this._boundaryRect){const{x:y,y:b}=this._pickupPositionInElement,D=this._boundaryRect,L=this._previewRect,q=D.top+b,U=D.bottom-(L.height-b);h=kt(h,D.left+y,D.right-(L.width-y)),p=kt(p,q,U)}return{x:h,y:p}}_updatePointerDirectionDelta(a){const{x:c,y:h}=a,p=this._pointerDirectionDelta,y=this._pointerPositionAtLastDirectionChange,b=Math.abs(c-y.x),D=Math.abs(h-y.y);return b>this._config.pointerDirectionChangeThreshold&&(p.x=c>y.x?1:-1,y.x=c),D>this._config.pointerDirectionChangeThreshold&&(p.y=h>y.y?1:-1,y.y=h),p}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const a=this._handles.length>0||!this.isDragging();a!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=a,k(this._rootElement,a))}_removeRootElementListeners(a){a.removeEventListener("mousedown",this._pointerDown,In),a.removeEventListener("touchstart",this._pointerDown,ai)}_applyRootElementTransform(a,c){const h=Fe(a,c);null==this._initialTransform&&(this._initialTransform=this._rootElement.style.transform&&"none"!=this._rootElement.style.transform?this._rootElement.style.transform:""),this._rootElement.style.transform=B(h,this._initialTransform)}_applyPreviewTransform(a,c){var h;const p=(null===(h=this._previewTemplate)||void 0===h?void 0:h.template)?void 0:this._initialTransform,y=Fe(a,c);this._preview.style.transform=B(y,p)}_getDragDistance(a){const c=this._pickupPositionOnPage;return c?{x:a.x-c.x,y:a.y-c.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:a,y:c}=this._passiveTransform;if(0===a&&0===c||this.isDragging()||!this._boundaryElement)return;const h=this._boundaryElement.getBoundingClientRect(),p=this._rootElement.getBoundingClientRect();if(0===h.width&&0===h.height||0===p.width&&0===p.height)return;const y=h.left-p.left,b=p.right-h.right,D=h.top-p.top,L=p.bottom-h.bottom;h.width>p.width?(y>0&&(a+=y),b>0&&(a-=b)):a=0,h.height>p.height?(D>0&&(c+=D),L>0&&(c-=L)):c=0,(a!==this._passiveTransform.x||c!==this._passiveTransform.y)&&this.setFreeDragPosition({y:c,x:a})}_getDragStartDelay(a){const c=this.dragStartDelay;return"number"==typeof c?c:ce(a)?c.touch:c?c.mouse:0}_updateOnScroll(a){const c=this._parentPositions.handleScroll(a);if(c){const h=(0,V.sA)(a);this._boundaryRect&&(h===this._document||h!==this._boundaryElement&&h.contains(this._boundaryElement))&&mt(this._boundaryRect,c.top,c.left),this._pickupPositionOnPage.x+=c.left,this._pickupPositionOnPage.y+=c.top,this._dropContainer||(this._activeTransform.x-=c.left,this._activeTransform.y-=c.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){const a=this._parentPositions.positions.get(this._document);return a?a.scrollPosition:this._viewportRuler.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=(0,V.kV)(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(a,c){const h=this._previewContainer||"global";if("parent"===h)return a;if("global"===h){const p=this._document;return c||p.fullscreenElement||p.webkitFullscreenElement||p.mozFullScreenElement||p.msFullscreenElement||p.body}return(0,j.fI)(h)}}function Fe(m,a){return`translate3d(${Math.round(m)}px, ${Math.round(a)}px, 0)`}function kt(m,a,c){return Math.max(a,Math.min(c,m))}function Lt(m){m&&m.parentNode&&m.parentNode.removeChild(m)}function ce(m){return"t"===m.type[0]}function Xt(m,a){const c=m.rootNodes;if(1===c.length&&c[0].nodeType===a.ELEMENT_NODE)return c[0];const h=a.createElement("div");return c.forEach(p=>h.appendChild(p)),h}function ye(m,a){m.style.width=`${a.width}px`,m.style.height=`${a.height}px`,m.style.transform=Fe(a.left,a.top)}function yt(m,a){return Math.max(0,Math.min(a,m))}class An{constructor(a,c,h,p,y){this._dragDropRegistry=c,this._ngZone=p,this._viewportRuler=y,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new ne.xQ,this.entered=new ne.xQ,this.exited=new ne.xQ,this.dropped=new ne.xQ,this.sorted=new ne.xQ,this._isDragging=!1,this._itemPositions=[],this._previousSwap={drag:null,delta:0,overlaps:!1},this._draggables=[],this._siblings=[],this._orientation="vertical",this._activeSiblings=new Set,this._direction="ltr",this._viewportScrollSubscription=$e.w.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new ne.xQ,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),function(m=0,a=me.P){return(!(0,pe.k)(m)||m<0)&&(m=0),(!a||"function"!=typeof a.schedule)&&(a=me.P),new Ne.y(c=>(c.add(a.schedule(Yt,m,{subscriber:c,counter:0,period:m})),c))}(0,ri.Z).pipe((0,Ct.R)(this._stopScrollTimers)).subscribe(()=>{const b=this._scrollNode,D=this.autoScrollStep;1===this._verticalScrollDirection?ui(b,-D):2===this._verticalScrollDirection&&ui(b,D),1===this._horizontalScrollDirection?ht(b,-D):2===this._horizontalScrollDirection&&ht(b,D)})},this.element=(0,j.fI)(a),this._document=h,this.withScrollableParents([this.element]),c.registerDropContainer(this),this._parentPositions=new Tn(h,y)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(a,c,h,p){let y;this._draggingStarted(),null==p?(y=this.sortingDisabled?this._draggables.indexOf(a):-1,-1===y&&(y=this._getItemIndexFromPointerPosition(a,c,h))):y=p;const b=this._activeDraggables,D=b.indexOf(a),L=a.getPlaceholderElement();let q=b[y];if(q===a&&(q=b[y+1]),D>-1&&b.splice(D,1),q&&!this._dragDropRegistry.isDragging(q)){const U=q.getRootElement();U.parentElement.insertBefore(L,U),b.splice(y,0,a)}else if(this._shouldEnterAsFirstChild(c,h)){const U=b[0].getRootElement();U.parentNode.insertBefore(L,U),b.unshift(a)}else(0,j.fI)(this.element).appendChild(L),b.push(a);L.style.transform="",this._cacheItemPositions(),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:a,container:this,currentIndex:this.getItemIndex(a)})}exit(a){this._reset(),this.exited.next({item:a,container:this})}drop(a,c,h,p,y,b,D){this._reset(),this.dropped.next({item:a,currentIndex:c,previousIndex:h,container:this,previousContainer:p,isPointerOverContainer:y,distance:b,dropPoint:D})}withItems(a){const c=this._draggables;return this._draggables=a,a.forEach(h=>h._withDropContainer(this)),this.isDragging()&&(c.filter(p=>p.isDragging()).every(p=>-1===a.indexOf(p))?this._reset():this._cacheItems()),this}withDirection(a){return this._direction=a,this}connectedTo(a){return this._siblings=a.slice(),this}withOrientation(a){return this._orientation=a,this}withScrollableParents(a){const c=(0,j.fI)(this.element);return this._scrollableElements=-1===a.indexOf(c)?[c,...a]:a.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(a){return this._isDragging?Rn("horizontal"===this._orientation&&"rtl"===this._direction?this._itemPositions.slice().reverse():this._itemPositions,h=>h.drag===a):this._draggables.indexOf(a)}isReceiving(){return this._activeSiblings.size>0}_sortItem(a,c,h,p){if(this.sortingDisabled||!this._clientRect||!oi(this._clientRect,.05,c,h))return;const y=this._itemPositions,b=this._getItemIndexFromPointerPosition(a,c,h,p);if(-1===b&&y.length>0)return;const D="horizontal"===this._orientation,L=Rn(y,He=>He.drag===a),q=y[b],G=q.clientRect,Y=L>b?1:-1,te=this._getItemOffsetPx(y[L].clientRect,G,Y),ot=this._getSiblingOffsetPx(L,y,Y),bt=y.slice();(function(m,a,c){const h=yt(a,m.length-1),p=yt(c,m.length-1);if(h===p)return;const y=m[h],b=p<h?-1:1;for(let D=h;D!==p;D+=b)m[D]=m[D+b];m[p]=y})(y,L,b),this.sorted.next({previousIndex:L,currentIndex:b,container:this,item:a}),y.forEach((He,io)=>{if(bt[io]===He)return;const es=He.drag===a,ts=es?te:ot,Ws=es?a.getPlaceholderElement():He.drag.getRootElement();He.offset+=ts,D?(Ws.style.transform=B(`translate3d(${Math.round(He.offset)}px, 0, 0)`,He.initialTransform),mt(He.clientRect,0,ts)):(Ws.style.transform=B(`translate3d(0, ${Math.round(He.offset)}px, 0)`,He.initialTransform),mt(He.clientRect,ts,0))}),this._previousSwap.overlaps=Rt(G,c,h),this._previousSwap.drag=q.drag,this._previousSwap.delta=D?p.x:p.y}_startScrollingIfNecessary(a,c){if(this.autoScrollDisabled)return;let h,p=0,y=0;if(this._parentPositions.positions.forEach((b,D)=>{D===this._document||!b.clientRect||h||oi(b.clientRect,.05,a,c)&&([p,y]=function(m,a,c,h){const p=Ot(a,h),y=Mt(a,c);let b=0,D=0;if(p){const L=m.scrollTop;1===p?L>0&&(b=1):m.scrollHeight-L>m.clientHeight&&(b=2)}if(y){const L=m.scrollLeft;1===y?L>0&&(D=1):m.scrollWidth-L>m.clientWidth&&(D=2)}return[b,D]}(D,b.clientRect,a,c),(p||y)&&(h=D))}),!p&&!y){const{width:b,height:D}=this._viewportRuler.getViewportSize(),L={width:b,height:D,top:0,right:b,bottom:D,left:0};p=Ot(L,c),y=Mt(L,a),h=window}h&&(p!==this._verticalScrollDirection||y!==this._horizontalScrollDirection||h!==this._scrollNode)&&(this._verticalScrollDirection=p,this._horizontalScrollDirection=y,this._scrollNode=h,(p||y)&&h?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const a=(0,j.fI)(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=a.msScrollSnapType||a.scrollSnapType||"",a.scrollSnapType=a.msScrollSnapType="none",this._cacheItems(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){const a=(0,j.fI)(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(a).clientRect}_cacheItemPositions(){const a="horizontal"===this._orientation;this._itemPositions=this._activeDraggables.map(c=>{const h=c.getVisibleElement();return{drag:c,offset:0,initialTransform:h.style.transform||"",clientRect:bn(h)}}).sort((c,h)=>a?c.clientRect.left-h.clientRect.left:c.clientRect.top-h.clientRect.top)}_reset(){this._isDragging=!1;const a=(0,j.fI)(this.element).style;a.scrollSnapType=a.msScrollSnapType=this._initialScrollSnap,this._activeDraggables.forEach(c=>{var h;const p=c.getRootElement();if(p){const y=null===(h=this._itemPositions.find(b=>b.drag===c))||void 0===h?void 0:h.initialTransform;p.style.transform=y||""}}),this._siblings.forEach(c=>c._stopReceiving(this)),this._activeDraggables=[],this._itemPositions=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1,this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_getSiblingOffsetPx(a,c,h){const p="horizontal"===this._orientation,y=c[a].clientRect,b=c[a+-1*h];let D=y[p?"width":"height"]*h;if(b){const L=p?"left":"top",q=p?"right":"bottom";-1===h?D-=b.clientRect[L]-y[q]:D+=y[L]-b.clientRect[q]}return D}_getItemOffsetPx(a,c,h){const p="horizontal"===this._orientation;let y=p?c.left-a.left:c.top-a.top;return-1===h&&(y+=p?c.width-a.width:c.height-a.height),y}_shouldEnterAsFirstChild(a,c){if(!this._activeDraggables.length)return!1;const h=this._itemPositions,p="horizontal"===this._orientation;if(h[0].drag!==this._activeDraggables[0]){const b=h[h.length-1].clientRect;return p?a>=b.right:c>=b.bottom}{const b=h[0].clientRect;return p?a<=b.left:c<=b.top}}_getItemIndexFromPointerPosition(a,c,h,p){const y="horizontal"===this._orientation,b=Rn(this._itemPositions,({drag:D,clientRect:L},q,U)=>{if(D===a)return U.length<2;if(p){const G=y?p.x:p.y;if(D===this._previousSwap.drag&&this._previousSwap.overlaps&&G===this._previousSwap.delta)return!1}return y?c>=Math.floor(L.left)&&c<Math.floor(L.right):h>=Math.floor(L.top)&&h<Math.floor(L.bottom)});return-1!==b&&this.sortPredicate(b,a,this)?b:-1}_cacheItems(){this._activeDraggables=this._draggables.slice(),this._cacheItemPositions(),this._cacheParentPositions()}_isOverContainer(a,c){return null!=this._clientRect&&Rt(this._clientRect,a,c)}_getSiblingContainerFromPosition(a,c,h){return this._siblings.find(p=>p._canReceive(a,c,h))}_canReceive(a,c,h){if(!this._clientRect||!Rt(this._clientRect,c,h)||!this.enterPredicate(a,this))return!1;const p=this._getShadowRoot().elementFromPoint(c,h);if(!p)return!1;const y=(0,j.fI)(this.element);return p===y||y.contains(p)}_startReceiving(a,c){const h=this._activeSiblings;!h.has(a)&&c.every(p=>this.enterPredicate(p,this)||this._draggables.indexOf(p)>-1)&&(h.add(a),this._cacheParentPositions(),this._listenToScrollEvents())}_stopReceiving(a){this._activeSiblings.delete(a),this._viewportScrollSubscription.unsubscribe()}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(a=>{if(this.isDragging()){const c=this._parentPositions.handleScroll(a);c&&(this._itemPositions.forEach(({clientRect:h})=>{mt(h,c.top,c.left)}),this._itemPositions.forEach(({drag:h})=>{this._dragDropRegistry.isDragging(h)&&h._sortFromLastPointerPosition()}))}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const a=(0,V.kV)((0,j.fI)(this.element));this._cachedShadowRoot=a||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const a=this._activeDraggables.filter(c=>c.isDragging());this._siblings.forEach(c=>c._startReceiving(this,a))}}function Rn(m,a){for(let c=0;c<m.length;c++)if(a(m[c],c,m))return c;return-1}function ui(m,a){m===window?m.scrollBy(0,a):m.scrollTop+=a}function ht(m,a){m===window?m.scrollBy(a,0):m.scrollLeft+=a}function Ot(m,a){const{top:c,bottom:h,height:p}=m,y=.05*p;return a>=c-y&&a<=c+y?1:a>=h-y&&a<=h+y?2:0}function Mt(m,a){const{left:c,right:h,width:p}=m,y=.05*p;return a>=c-y&&a<=c+y?1:a>=h-y&&a<=h+y?2:0}const _t=(0,V.i$)({passive:!1,capture:!0});let Je=(()=>{class m{constructor(c,h){this._ngZone=c,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=[],this._globalListeners=new Map,this._draggingPredicate=p=>p.isDragging(),this.pointerMove=new ne.xQ,this.pointerUp=new ne.xQ,this.scroll=new ne.xQ,this._preventDefaultWhileDragging=p=>{this._activeDragInstances.length>0&&p.preventDefault()},this._persistentTouchmoveListener=p=>{this._activeDragInstances.length>0&&(this._activeDragInstances.some(this._draggingPredicate)&&p.preventDefault(),this.pointerMove.next(p))},this._document=h}registerDropContainer(c){this._dropInstances.has(c)||this._dropInstances.add(c)}registerDragItem(c){this._dragInstances.add(c),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,_t)})}removeDropContainer(c){this._dropInstances.delete(c)}removeDragItem(c){this._dragInstances.delete(c),this.stopDragging(c),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,_t)}startDragging(c,h){if(!(this._activeDragInstances.indexOf(c)>-1)&&(this._activeDragInstances.push(c),1===this._activeDragInstances.length)){const p=h.type.startsWith("touch");this._globalListeners.set(p?"touchend":"mouseup",{handler:y=>this.pointerUp.next(y),options:!0}).set("scroll",{handler:y=>this.scroll.next(y),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:_t}),p||this._globalListeners.set("mousemove",{handler:y=>this.pointerMove.next(y),options:_t}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((y,b)=>{this._document.addEventListener(b,y.handler,y.options)})})}}stopDragging(c){const h=this._activeDragInstances.indexOf(c);h>-1&&(this._activeDragInstances.splice(h,1),0===this._activeDragInstances.length&&this._clearGlobalListeners())}isDragging(c){return this._activeDragInstances.indexOf(c)>-1}scrolled(c){const h=[this.scroll];return c&&c!==this._document&&h.push(new Ne.y(p=>this._ngZone.runOutsideAngular(()=>{const b=D=>{this._activeDragInstances.length&&p.next(D)};return c.addEventListener("scroll",b,!0),()=>{c.removeEventListener("scroll",b,!0)}}))),(0,rt.T)(...h)}ngOnDestroy(){this._dragInstances.forEach(c=>this.removeDragItem(c)),this._dropInstances.forEach(c=>this.removeDropContainer(c)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((c,h)=>{this._document.removeEventListener(h,c.handler,c.options)}),this._globalListeners.clear()}}return m.\u0275fac=function(c){return new(c||m)(v.LFG(v.R0b),v.LFG(re.K0))},m.\u0275prov=v.Yz7({factory:function(){return new m(v.LFG(v.R0b),v.LFG(re.K0))},token:m,providedIn:"root"}),m})();const Jt={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let vt=(()=>{class m{constructor(c,h,p,y){this._document=c,this._ngZone=h,this._viewportRuler=p,this._dragDropRegistry=y}createDrag(c,h=Jt){return new Nt(c,h,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(c){return new An(c,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}return m.\u0275fac=function(c){return new(c||m)(v.LFG(re.K0),v.LFG(v.R0b),v.LFG(f.rL),v.LFG(Je))},m.\u0275prov=v.Yz7({factory:function(){return new m(v.LFG(re.K0),v.LFG(v.R0b),v.LFG(f.rL),v.LFG(Je))},token:m,providedIn:"root"}),m})(),w=(()=>{class m{}return m.\u0275fac=function(c){return new(c||m)},m.\u0275mod=v.oAB({type:m}),m.\u0275inj=v.cJS({providers:[vt],imports:[f.ZD]}),m})()},6746:(si,Ze,I)=>{I.r(Ze),I.d(Ze,{HeaderModule:()=>tn});var v=I(8583),re=I(4419),f=I(7716),V=I(7238),j=I(8002),J=I(2809),Ne=I(8753);function me(w,m){if(1&w&&(f.TgZ(0,"div",3),f.TgZ(1,"div",4),f.TgZ(2,"div",5),f._uU(3),f.qZA(),f.TgZ(4,"div"),f._uU(5),f.qZA(),f.qZA(),f.qZA()),2&w){const a=m.$implicit;f.xp6(3),f.Oqu(a.id),f.xp6(2),f.Oqu(a.name)}}function pe(w,m){if(1&w&&(f.TgZ(0,"elix-jumbotron",1),f.YNc(1,me,6,2,"div",2),f.qZA()),2&w){const a=f.oxw();f.Q6J("type","template"),f.xp6(1),f.Q6J("ngForOf",a.notifications)}}let st=(()=>{class w{constructor(a){this._timerService=a}ngOnInit(){this._timerService.counterData$.subscribe(a=>this.notifications=a)}}return w.\u0275fac=function(a){return new(a||w)(f.Y36(J.f))},w.\u0275cmp=f.Xpm({type:w,selectors:[["elix-notification"]],decls:1,vars:1,consts:[["class","text-xl vorkurt__color-text flex vorkurt__container-template",3,"type",4,"ngIf"],[1,"text-xl","vorkurt__color-text","flex","vorkurt__container-template",3,"type"],["class","flex flex-col",4,"ngFor","ngForOf"],[1,"flex","flex-col"],[1,"hover:","cursor-pointer","flex","vorkurt__notification"],[1,"w-10"]],template:function(a,c){1&a&&f.YNc(0,pe,2,2,"elix-jumbotron",0),2&a&&f.Q6J("ngIf",c.notifications.length)},directives:[v.O5,Ne.w,v.sg],styles:[".vorkurt__notification[_ngcontent-%COMP%]:hover{background:#316dca;color:#8f8f8f}"]}),w})();var Yt=I(7118),ne=I(6215),$e=I(9765);let ri=(()=>{class w{constructor(){this._statePopUpLogin=new ne.X(!1),this.statePopUp$=this._statePopUpLogin.asObservable(),this._coordinates=new $e.xQ,this.coordinates$=this._coordinates.asObservable()}coordinates(a){this._coordinates.next(a)}statePopLogin(a){this._statePopUpLogin.next(a)}}return w.\u0275fac=function(a){return new(a||w)},w.\u0275prov=f.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})();var rt=I(625),Ct=I(7636),S=I(9335),Qt=I(8403),_n=I(1233),De=I(2458),$=I(9490),vn=I(6237),qe=I(5319),k=I(2759),Wt=I(5435);const B=["primaryValueBar"],At=(0,De.pj)(class{constructor(w){this._elementRef=w}},"primary"),wn=new f.OlP("mat-progress-bar-location",{providedIn:"root",factory:function(){const w=(0,f.f3M)(v.K0),m=w?w.location:null;return{getPathname:()=>m?m.pathname+m.search:""}}});let bn=0,Rt=(()=>{class w extends At{constructor(a,c,h,p){super(a),this._ngZone=c,this._animationMode=h,this._isNoopAnimation=!1,this._value=0,this._bufferValue=0,this.animationEnd=new f.vpe,this._animationEndSubscription=qe.w.EMPTY,this.mode="determinate",this.progressbarId="mat-progress-bar-"+bn++;const y=p?p.getPathname().split("#")[0]:"";this._rectangleFillValue=`url('${y}#${this.progressbarId}')`,this._isNoopAnimation="NoopAnimations"===h}get value(){return this._value}set value(a){this._value=mt((0,$.su)(a)||0)}get bufferValue(){return this._bufferValue}set bufferValue(a){this._bufferValue=mt(a||0)}_primaryTransform(){return{transform:`scale3d(${this.value/100}, 1, 1)`}}_bufferTransform(){return"buffer"===this.mode?{transform:`scale3d(${this.bufferValue/100}, 1, 1)`}:null}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{const a=this._primaryValueBar.nativeElement;this._animationEndSubscription=(0,k.R)(a,"transitionend").pipe((0,Wt.h)(c=>c.target===a)).subscribe(()=>{("determinate"===this.mode||"buffer"===this.mode)&&this._ngZone.run(()=>this.animationEnd.next({value:this.value}))})})}ngOnDestroy(){this._animationEndSubscription.unsubscribe()}}return w.\u0275fac=function(a){return new(a||w)(f.Y36(f.SBq),f.Y36(f.R0b),f.Y36(vn.Qb,8),f.Y36(wn,8))},w.\u0275cmp=f.Xpm({type:w,selectors:[["mat-progress-bar"]],viewQuery:function(a,c){if(1&a&&f.Gf(B,5),2&a){let h;f.iGM(h=f.CRH())&&(c._primaryValueBar=h.first)}},hostAttrs:["role","progressbar","aria-valuemin","0","aria-valuemax","100","tabindex","-1",1,"mat-progress-bar"],hostVars:4,hostBindings:function(a,c){2&a&&(f.uIk("aria-valuenow","indeterminate"===c.mode||"query"===c.mode?null:c.value)("mode",c.mode),f.ekj("_mat-animation-noopable",c._isNoopAnimation))},inputs:{color:"color",mode:"mode",value:"value",bufferValue:"bufferValue"},outputs:{animationEnd:"animationEnd"},exportAs:["matProgressBar"],features:[f.qOj],decls:10,vars:4,consts:[["aria-hidden","true"],["width","100%","height","4","focusable","false",1,"mat-progress-bar-background","mat-progress-bar-element"],["x","4","y","0","width","8","height","4","patternUnits","userSpaceOnUse",3,"id"],["cx","2","cy","2","r","2"],["width","100%","height","100%"],[1,"mat-progress-bar-buffer","mat-progress-bar-element",3,"ngStyle"],[1,"mat-progress-bar-primary","mat-progress-bar-fill","mat-progress-bar-element",3,"ngStyle"],["primaryValueBar",""],[1,"mat-progress-bar-secondary","mat-progress-bar-fill","mat-progress-bar-element"]],template:function(a,c){1&a&&(f.TgZ(0,"div",0),f.O4$(),f.TgZ(1,"svg",1),f.TgZ(2,"defs"),f.TgZ(3,"pattern",2),f._UZ(4,"circle",3),f.qZA(),f.qZA(),f._UZ(5,"rect",4),f.qZA(),f.kcU(),f._UZ(6,"div",5),f._UZ(7,"div",6,7),f._UZ(9,"div",8),f.qZA()),2&a&&(f.xp6(3),f.Q6J("id",c.progressbarId),f.xp6(2),f.uIk("fill",c._rectangleFillValue),f.xp6(1),f.Q6J("ngStyle",c._bufferTransform()),f.xp6(1),f.Q6J("ngStyle",c._primaryTransform()))},directives:[v.PC],styles:['.mat-progress-bar{display:block;height:4px;overflow:hidden;position:relative;transition:opacity 250ms linear;width:100%}._mat-animation-noopable.mat-progress-bar{transition:none;animation:none}.mat-progress-bar .mat-progress-bar-element,.mat-progress-bar .mat-progress-bar-fill::after{height:100%;position:absolute;width:100%}.mat-progress-bar .mat-progress-bar-background{width:calc(100% + 10px)}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-background{display:none}.mat-progress-bar .mat-progress-bar-buffer{transform-origin:top left;transition:transform 250ms ease}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-buffer{border-top:solid 5px;opacity:.5}.mat-progress-bar .mat-progress-bar-secondary{display:none}.mat-progress-bar .mat-progress-bar-fill{animation:none;transform-origin:top left;transition:transform 250ms ease}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-fill{border-top:solid 4px}.mat-progress-bar .mat-progress-bar-fill::after{animation:none;content:"";display:inline-block;left:0}.mat-progress-bar[dir=rtl],[dir=rtl] .mat-progress-bar{transform:rotateY(180deg)}.mat-progress-bar[mode=query]{transform:rotateZ(180deg)}.mat-progress-bar[mode=query][dir=rtl],[dir=rtl] .mat-progress-bar[mode=query]{transform:rotateZ(180deg) rotateY(180deg)}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-fill,.mat-progress-bar[mode=query] .mat-progress-bar-fill{transition:none}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary,.mat-progress-bar[mode=query] .mat-progress-bar-primary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-translate 2000ms infinite linear;left:-145.166611%}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-primary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-scale 2000ms infinite linear}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary,.mat-progress-bar[mode=query] .mat-progress-bar-secondary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-translate 2000ms infinite linear;left:-54.888891%;display:block}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-secondary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-scale 2000ms infinite linear}.mat-progress-bar[mode=buffer] .mat-progress-bar-background{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-background-scroll 250ms infinite linear;display:block}.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-buffer,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-background{animation:none;transition-duration:1ms}@keyframes mat-progress-bar-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(83.67142%)}100%{transform:translateX(200.611057%)}}@keyframes mat-progress-bar-primary-indeterminate-scale{0%{transform:scaleX(0.08)}36.65%{animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);transform:scaleX(0.08)}69.15%{animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);transform:scaleX(0.661479)}100%{transform:scaleX(0.08)}}@keyframes mat-progress-bar-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(84.386165%)}100%{transform:translateX(160.277782%)}}@keyframes mat-progress-bar-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:scaleX(0.08)}19.15%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:scaleX(0.457104)}44.15%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:scaleX(0.72796)}100%{transform:scaleX(0.08)}}@keyframes mat-progress-bar-background-scroll{to{transform:translateX(-8px)}}\n'],encapsulation:2,changeDetection:0}),w})();function mt(w,m=0,a=100){return Math.max(m,Math.min(a,w))}let oi=(()=>{class w{}return w.\u0275fac=function(a){return new(a||w)},w.\u0275mod=f.oAB({type:w}),w.\u0275inj=f.cJS({imports:[[v.ez,De.BQ],De.BQ]}),w})();var Tn=I(1095);const le=["popUp"];let Pt=(()=>{class w{constructor(a,c,h,p,y,b){this._popState=a,this._render=c,this._authService=h,this._userService=p,this._spinnerService=y,this._overlayConfig=b,this.start=0,this.timer=0}ngOnInit(){this.dataUser=this._userService.getUserLoggedIn(),this.resumeTimeOut()}signOut(){this._popState.statePopLogin(!1),this._spinnerService.setStateBehaviorSpinner(!0),this._authService.logout(),this._spinnerService.setStateBehaviorSpinner(!1),this._overlayConfig.closeOverlay()}stopTimer(){window.setTimeout(()=>{this.componentRef.destroy()})}pauseTimeout(){window.clearInterval(this.timer)}resumeTimeOut(){this.timer=window.setInterval(()=>{if(!(this.start<100))return this.pauseTimeout(),void this._overlayConfig.closeOverlay();this.start+=10},500)}}return w.\u0275fac=function(a){return new(a||w)(f.Y36(ri),f.Y36(f.Qsj),f.Y36(S.e),f.Y36(Qt.K),f.Y36(_n.V),f.Y36(En))},w.\u0275cmp=f.Xpm({type:w,selectors:[["elix-pop-up-login"]],viewQuery:function(a,c){if(1&a&&f.Gf(le,5),2&a){let h;f.iGM(h=f.CRH())&&(c.popUp=h.first)}},inputs:{componentRef:"componentRef"},decls:11,vars:2,consts:[[1,"border-2","rounded-2xl","text-white","w-44","elix__border-color","border-solid",3,"mouseenter","mouseleave"],["popUp",""],[1,"truncate"],["mode","determinate",3,"value"],[1,"flex","justify-center"],["mat-flat-button","",3,"click"]],template:function(a,c){1&a&&(f.TgZ(0,"div",0,1),f.NdJ("mouseenter",function(){return c.pauseTimeout()})("mouseleave",function(){return c.resumeTimeOut()}),f.TgZ(2,"div"),f.TgZ(3,"div"),f.TgZ(4,"p",2),f._uU(5),f.qZA(),f.qZA(),f.TgZ(6,"div"),f._UZ(7,"mat-progress-bar",3),f.qZA(),f.TgZ(8,"div",4),f.TgZ(9,"button",5),f.NdJ("click",function(){return c.signOut()}),f._uU(10,"Sign Out"),f.qZA(),f.qZA(),f.qZA(),f.qZA()),2&a&&(f.xp6(5),f.hij("",c.dataUser.email||c.dataUser.user.email," "),f.xp6(2),f.Q6J("value",c.start))},directives:[Rt,Tn.lW],styles:[".elix__border-color[_ngcontent-%COMP%]{border-color:#1ea7fd;box-shadow:2px 1px 8px #00f,-8px 0 8px;position:absolute;z-index:100000000;height:min-content}h1[_ngcontent-%COMP%]{margin:0;padding:1em}"]}),w})(),ge=(()=>{class w{constructor(a){this._overlayRef=a}close(){this._overlayRef.dispose(),this._overlayRef.detach()}}return w.\u0275fac=function(a){return new(a||w)(f.LFG(rt.Iu))},w.\u0275prov=f.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})();const Xe={hasBackdrop:!0,backdropClass:"dark-backdrop",panelClass:"elixir-dialog-panel"};let En=(()=>{class w{constructor(a){this._overlay=a}open(a,c={}){const h=Object.assign(Object.assign({},Xe),c);return this.overlayRef=this.createOverlay(h,a),this.dialogRef=new ge(this.overlayRef),this.filePortal=new Ct.C5(Pt),this.overlayRef.attach(this.filePortal),this.overlayRef.backdropClick().subscribe(p=>this.dialogRef.close()),this.overlayRef}closeOverlay(){this.dialogRef.close()}createOverlay(a,c){const h=this.getOverlayConfig(a,c);return this._overlay.create(h)}getOverlayConfig(a,c){const h=this._overlay.position().global().left(c.clientX-176+"px").top(c.clientY+3+"px");return new rt.X_({hasBackdrop:a.hasBackdrop,backdropClass:a.backdropClass,panelClass:a.panelClass,scrollStrategy:this._overlay.scrollStrategies.block(),positionStrategy:h})}}return w.\u0275fac=function(a){return new(a||w)(f.LFG(rt.aV))},w.\u0275prov=f.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"}),w})();var ai=I(531);let In=(()=>{class w{constructor(a,c){this._elementRef=a,this._renderer=c,this.defaultColor="transparent",this.resizableGrabWidth=8,this.resizableMinWidth=10,this.dragging=!1;const b=G=>{const Y=Math.max(this.resizableMinWidth,G);a.nativeElement.style.width=Y+"px"};document.addEventListener("mousemove",G=>{!this.dragging||(b(G.clientX+a.nativeElement.offsetLeft),G.stopPropagation())},!0),document.addEventListener("mouseup",G=>{!this.dragging||(document.body.style.pointerEvents="auto",this.dragging=!1,G.stopPropagation())},!0),a.nativeElement.addEventListener("mousedown",G=>{this.inDragRegion(G)&&(this.dragging=!0,document.body.style.pointerEvents="none",G.stopPropagation())},!0),a.nativeElement.addEventListener("mousemove",G=>{a.nativeElement.style.cursor=this.inDragRegion(G)||this.dragging?"col-resize":"default"},!0)}ngOnInit(){}inDragRegion(a){return this._elementRef.nativeElement.clientWidth-a.clientX+this._elementRef.nativeElement.offsetLeft<this.resizableGrabWidth}}return w.\u0275fac=function(a){return new(a||w)(f.Y36(f.SBq),f.Y36(f.Qsj))},w.\u0275dir=f.lG2({type:w,selectors:[["","elixElixDrag",""]],inputs:{defaultColor:"defaultColor",resizableGrabWidth:"resizableGrabWidth",resizableMinWidth:"resizableMinWidth"}}),w})();var Sn=I(6627),Dn=I(2181),Nt=I(3679),Fe=I(9238);let kt=0;const Lt=(0,De.Id)(class{});let ce=(()=>{class w extends Lt{constructor(a,c,h,p,y){super(),this._ngZone=a,this._elementRef=c,this._ariaDescriber=h,this._renderer=p,this._animationMode=y,this._hasContent=!1,this._color="primary",this._overlap=!0,this.position="above after",this.size="medium",this._id=kt++}get color(){return this._color}set color(a){this._setColor(a),this._color=a}get overlap(){return this._overlap}set overlap(a){this._overlap=(0,$.Ig)(a)}get description(){return this._description}set description(a){if(a!==this._description){const c=this._badgeElement;this._updateHostAriaDescription(a,this._description),this._description=a,c&&(a?c.setAttribute("aria-label",a):c.removeAttribute("aria-label"))}}get hidden(){return this._hidden}set hidden(a){this._hidden=(0,$.Ig)(a)}isAbove(){return-1===this.position.indexOf("below")}isAfter(){return-1===this.position.indexOf("before")}ngOnChanges(a){const c=a.content;if(c){const h=c.currentValue;this._hasContent=null!=h&&`${h}`.trim().length>0,this._updateTextContent()}}ngOnDestroy(){const a=this._badgeElement;a&&(this.description&&this._ariaDescriber.removeDescription(a,this.description),this._renderer.destroyNode&&this._renderer.destroyNode(a))}getBadgeElement(){return this._badgeElement}_updateTextContent(){return this._badgeElement?this._badgeElement.textContent=this._stringifyContent():this._badgeElement=this._createBadgeElement(),this._badgeElement}_createBadgeElement(){const a=this._renderer.createElement("span"),c="mat-badge-active",h="mat-badge-content";return this._clearExistingBadges(h),a.setAttribute("id",`mat-badge-content-${this._id}`),a.classList.add(h),a.textContent=this._stringifyContent(),"NoopAnimations"===this._animationMode&&a.classList.add("_mat-animation-noopable"),this.description&&a.setAttribute("aria-label",this.description),this._elementRef.nativeElement.appendChild(a),"function"==typeof requestAnimationFrame&&"NoopAnimations"!==this._animationMode?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{a.classList.add(c)})}):a.classList.add(c),a}_updateHostAriaDescription(a,c){const h=this._updateTextContent();c&&this._ariaDescriber.removeDescription(h,c),a&&this._ariaDescriber.describe(h,a)}_setColor(a){if(a!==this._color){const c=this._elementRef.nativeElement.classList;this._color&&c.remove(`mat-badge-${this._color}`),a&&c.add(`mat-badge-${a}`)}}_clearExistingBadges(a){const c=this._elementRef.nativeElement;let h=c.children.length;for(;h--;){const p=c.children[h];p.classList.contains(a)&&c.removeChild(p)}}_stringifyContent(){const a=this.content;return null==a?"":`${a}`}}return w.\u0275fac=function(a){return new(a||w)(f.Y36(f.R0b),f.Y36(f.SBq),f.Y36(Fe.$s),f.Y36(f.Qsj),f.Y36(vn.Qb,8))},w.\u0275dir=f.lG2({type:w,selectors:[["","matBadge",""]],hostAttrs:[1,"mat-badge"],hostVars:20,hostBindings:function(a,c){2&a&&f.ekj("mat-badge-overlap",c.overlap)("mat-badge-above",c.isAbove())("mat-badge-below",!c.isAbove())("mat-badge-before",!c.isAfter())("mat-badge-after",c.isAfter())("mat-badge-small","small"===c.size)("mat-badge-medium","medium"===c.size)("mat-badge-large","large"===c.size)("mat-badge-hidden",c.hidden||!c._hasContent)("mat-badge-disabled",c.disabled)},inputs:{disabled:["matBadgeDisabled","disabled"],position:["matBadgePosition","position"],size:["matBadgeSize","size"],color:["matBadgeColor","color"],overlap:["matBadgeOverlap","overlap"],description:["matBadgeDescription","description"],hidden:["matBadgeHidden","hidden"],content:["matBadge","content"]},features:[f.qOj,f.TTD]}),w})(),Xt=(()=>{class w{}return w.\u0275fac=function(a){return new(a||w)},w.\u0275mod=f.oAB({type:w}),w.\u0275inj=f.cJS({imports:[[Fe.rt,De.BQ],De.BQ]}),w})();const ye=["pointIcon"],ci=["notification"],Wi=function(w){return[w]};function li(w,m){if(1&w&&(f.TgZ(0,"div",17),f.TgZ(1,"a",18),f._uU(2),f.qZA(),f.qZA()),2&w){const a=m.$implicit,c=f.oxw();f.Q6J("routerLink",f.VKq(3,Wi,a.path)),f.xp6(1),f.Q6J("ngClass","colorIcon-"+c.color),f.xp6(1),f.Oqu(a.name)}}const yt=function(){return["account/pull_request"]},An=[{path:"",redirectTo:"account",pathMatch:"full"},{path:"",component:(()=>{class w{constructor(a,c,h,p,y,b){this._firebaseTry=a,this._popUpState=c,this._overlayPopUpService=h,this._router=p,this._timer=y,this._overlayAll=b,this.inputValue="",this.color="transparent",this.onSayHello=new f.vpe,this.background="transparent",this.routerData=[],this._firebaseTry.setUrl("/repository")}ngOnInit(){this._timer.counterData$.subscribe(a=>this.number=a.length),this._firebaseTry.data.snapshotChanges().pipe((0,j.U)(a=>a.map(c=>{let h=c.payload.doc.data();return{key:c.payload.doc.id,value:h[Object.keys(h)[0]]}}))).subscribe(a=>console.log(a)),this.routerData=this._router.snapshot.data.data}resizeData(a,c){this.inputValue=c?" ":""}retriveCoordinates(a){this.onSayHello.emit(a),this._popUpState.statePopLogin(!0),this._overlayPopUpService.open(a)}openBadge(){this._overlayAll.display(this.notification,st)}}return w.\u0275fac=function(a){return new(a||w)(f.Y36(Yt.M),f.Y36(ri),f.Y36(En),f.Y36(re.gz),f.Y36(J.f),f.Y36(ai.F))},w.\u0275cmp=f.Xpm({type:w,selectors:[["elix-header"]],viewQuery:function(a,c){if(1&a&&(f.Gf(ye,5),f.Gf(ci,5)),2&a){let h;f.iGM(h=f.CRH())&&(c.pointIcon=h.first),f.iGM(h=f.CRH())&&(c.notification=h.first)}},inputs:{inputValue:"inputValue",name:"name",color:"color",background:"background"},outputs:{onSayHello:"onSayHello"},decls:21,vars:17,consts:[[1,"bg-blue-700","sticky","iufce__top",3,"ngClass"],["elixElixDrag","",1,"flex","pl-9","justify-center","items-center","h-16"],[1,"w-8","h-8","mr-4","cursor-pointer",3,"routerLink"],[1,"iufce__icon",3,"svgIcon","ngClass"],["elixInputPrimary","",1,"flex","flex-1","items-center"],["type","text",1,"w-1/6","h-7","text-black","pl-3","vorkurt__background-primary","text-white",3,"ngClass","ngModel","focus","ngModelChange","focusout"],[1,"ml-2","h-10","flex","items-center"],["routerLinkActive","active",1,"text-white","vorkurt__text-size-secondary","flex","items-center",3,"routerLink","ngClass"],["class","ml-2 vorkurt__router flex items-center cursor-pointer","routerLinkActive","active",3,"routerLink",4,"ngFor","ngForOf"],[1,"flex","pr-8"],[1,"w-5","h-5"],["notification",""],[3,"matBadge","click"],[1,"iufce__icon","cursor-pointer",3,"svgIcon","ngClass"],[1,"w-5","h-5","ml-2"],["pointIcon",""],[1,"iufce__icon","cursor-pointer",3,"svgIcon","ngClass","click"],["routerLinkActive","active",1,"ml-2","vorkurt__router","flex","items-center","cursor-pointer",3,"routerLink"],[1,"text-white","vorkurt__text-size-secondary",3,"ngClass"]],template:function(a,c){1&a&&(f.TgZ(0,"div",0),f.TgZ(1,"div",1),f.TgZ(2,"div",2),f._UZ(3,"mat-icon",3),f.qZA(),f.TgZ(4,"div",4),f.TgZ(5,"input",5),f.NdJ("focus",function(p){return c.resizeData(p,!0)})("ngModelChange",function(p){return c.inputValue=p})("focusout",function(p){return c.resizeData(p,!1)}),f.qZA(),f.TgZ(6,"div",6),f.TgZ(7,"a",7),f._uU(8,"Pull request"),f.qZA(),f.qZA(),f.YNc(9,li,3,5,"div",8),f.qZA(),f.TgZ(10,"div",9),f.TgZ(11,"div",10,11),f.TgZ(13,"button",12),f.NdJ("click",function(){return c.openBadge()}),f._UZ(14,"mat-icon",13),f.qZA(),f.qZA(),f.TgZ(15,"div",14),f._UZ(16,"mat-icon",13),f.qZA(),f.TgZ(17,"div",14,15),f.TgZ(19,"mat-icon",16),f.NdJ("click",function(p){return c.retriveCoordinates(p)}),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f._UZ(20,"router-outlet")),2&a&&(f.Q6J("ngClass"," vorkurt__background-thrid iufce__parrent-header background-"+c.background),f.xp6(2),f.Q6J("routerLink","account"),f.xp6(1),f.Q6J("svgIcon","fa_brands:github")("ngClass","colorIcon-"+c.color),f.xp6(2),f.Q6J("ngClass",c.inputValue?"iufce__expand-input":"")("ngModel",c.inputValue),f.xp6(2),f.Q6J("routerLink",f.DdM(16,yt))("ngClass","colorIcon-"+c.color),f.xp6(2),f.Q6J("ngForOf",c.routerData),f.xp6(4),f.Q6J("matBadge",0===c.number?"":c.number),f.xp6(1),f.Q6J("svgIcon","fa_solid:bell")("ngClass","colorIcon-"+c.color),f.xp6(2),f.Q6J("svgIcon","fa_solid:plus")("ngClass","colorIcon-"+c.color),f.xp6(3),f.Q6J("svgIcon","fa_solid:user-circle")("ngClass","colorIcon-"+c.color))},directives:[v.mk,In,re.rH,Sn.Hw,Dn.F,Nt.Fj,Nt.JJ,Nt.On,re.yS,re.Od,v.sg,ce,re.lC],styles:[".iufce__icon[_ngcontent-%COMP%]{color:#cdd9e5;height:inherit;width:inherit}.iufce__top[_ngcontent-%COMP%]{top:0px}.iufce__expand-input[_ngcontent-%COMP%]{width:32.75rem;transition:all .5s ease-in-out}.iufce__parrent-header.background-dark[_ngcontent-%COMP%]{background:#8F8F8F}.iufce__parrent-header.background-transparent[_ngcontent-%COMP%]{background:#2d333b}.iufce__parrent-header.background-light[_ngcontent-%COMP%]{background:#F6F6F6}.colorIcon-dark[_ngcontent-%COMP%]{color:#d9e5ff}.colorIcon-transparent[_ngcontent-%COMP%]{color:#92a2bd}.colorIcon-light[_ngcontent-%COMP%]{color:#8f8f8f}.active[_ngcontent-%COMP%]{height:2rem;border:1px solid;border-radius:5px}.vorkurt__router[_ngcontent-%COMP%]{height:2rem;color:#92a2bd}"],data:{animation:[(0,V.X$)("openClose",[(0,V.SB)("open",(0,V.oB)({height:"200px",opacity:1,backgroundColor:"yellow"})),(0,V.SB)("closed",(0,V.oB)({height:"100px",opacity:.8,backgroundColor:"#c6ecff"})),(0,V.eR)("open => closed",[(0,V.jt)("1s")]),(0,V.eR)("closed => open",[(0,V.jt)("0.5s")])])]}}),w})(),children:[{path:"account",loadChildren:()=>Promise.all([I.e(295),I.e(592),I.e(690)]).then(I.bind(I,4690)).then(w=>w.AccountModule)},{path:"new",loadChildren:()=>Promise.all([I.e(295),I.e(983),I.e(539),I.e(105)]).then(I.bind(I,7105)).then(w=>w.NewRepoModule)},{path:"timer",loadChildren:()=>Promise.all([I.e(295),I.e(983),I.e(342)]).then(I.bind(I,7342)).then(w=>w.TimerModule)},{path:"tms",loadChildren:()=>I.e(969).then(I.bind(I,4969)).then(w=>w.TransportModule)},{path:"explore",loadChildren:()=>I.e(515).then(I.bind(I,2515)).then(w=>w.ExploreModule)},{path:":id",canActivate:[I(5704).e],loadChildren:()=>Promise.all([I.e(592),I.e(864)]).then(I.bind(I,4864)).then(w=>w.RepositoryModule)}]}];let Rn=(()=>{class w{}return w.\u0275fac=function(a){return new(a||w)},w.\u0275mod=f.oAB({type:w}),w.\u0275inj=f.cJS({imports:[[re.Bz.forChild(An)],re.Bz]}),w})();var ui=I(3461),ht=I(4466),Ot=I(1386);I(6461),I(5072),I(521),I(6782),I(5257),I(946);const dt={provide:new f.OlP("mat-tooltip-scroll-strategy"),deps:[rt.aV],useFactory:function(w){return()=>w.scrollStrategies.reposition({scrollThrottle:20})}};let fi=(()=>{class w{}return w.\u0275fac=function(a){return new(a||w)},w.\u0275mod=f.oAB({type:w}),w.\u0275inj=f.cJS({providers:[dt],imports:[[Fe.rt,v.ez,rt.U8,De.BQ],De.BQ,Ot.ZD]}),w})(),tn=(()=>{class w{}return w.\u0275fac=function(a){return new(a||w)},w.\u0275mod=f.oAB({type:w}),w.\u0275inj=f.cJS({imports:[[rt.U8,Sn.Ps,Nt.u5,v.ez,Rn,ui._t,ht.m,Tn.ot,fi,oi,Xt]]}),w})()},8753:(si,Ze,I)=>{I.d(Ze,{w:()=>Ne});var v=I(7716),re=I(8583);function f(me,pe){1&me&&(v.TgZ(0,"div",3),v.TgZ(1,"div",4),v.TgZ(2,"div",5),v.TgZ(3,"h1"),v._uU(4,"TItle"),v.qZA(),v.qZA(),v.TgZ(5,"div"),v._uU(6," Action "),v.qZA(),v.qZA(),v.TgZ(7,"div"),v.Hsn(8),v.qZA(),v._UZ(9,"div"),v.TgZ(10,"footer"),v.TgZ(11,"div",6),v.TgZ(12,"div",7),v.TgZ(13,"div"),v._uU(14,"language"),v.qZA(),v.TgZ(15,"div"),v._uU(16," star"),v.qZA(),v.TgZ(17,"div"),v._uU(18,"Update date"),v.qZA(),v.qZA(),v.qZA(),v.qZA(),v.qZA())}function V(me,pe){1&me&&(v.TgZ(0,"div",8),v.TgZ(1,"div"),v.Hsn(2,1),v.qZA(),v.qZA())}const j=[[["","post",""]],"*"],J=["[post]","*"];let Ne=(()=>{class me{constructor(){}ngOnInit(){}}return me.\u0275fac=function(st){return new(st||me)},me.\u0275cmp=v.Xpm({type:me,selectors:[["elix-jumbotron"]],inputs:{closeAction:"closeAction",title:"title",action:"action",type:"type"},ngContentSelectors:J,decls:3,vars:2,consts:[[1,"vorkurt__color-background","border-2","elix__shared-border-color","border-solid","rounded-lg","m-2"],["class","pl-2 pr-2",4,"ngIf"],["class","w-96 pl-2 pr-2",4,"ngIf"],[1,"pl-2","pr-2"],[1,"flex"],[1,"flex-1"],[1,"w-72"],[1,"flex","justify-between"],[1,"w-96","pl-2","pr-2"]],template:function(st,Yt){1&st&&(v.F$t(j),v.TgZ(0,"div",0),v.YNc(1,f,19,0,"div",1),v.YNc(2,V,3,0,"div",2),v.qZA()),2&st&&(v.xp6(1),v.Q6J("ngIf","post"===Yt.type),v.xp6(1),v.Q6J("ngIf","template"===Yt.type))},directives:[re.O5],styles:[".elix__shared-border-color[_ngcontent-%COMP%]{border-color:#444c56;width:100%}"]}),me})()},2181:(si,Ze,I)=>{I.d(Ze,{F:()=>re});var v=I(7716);let re=(()=>{class f{constructor(j,J){this._el=j,this._renderer=J,this._renderer.addClass(this._el.nativeElement,"vorkurt__primary-input")}}return f.\u0275fac=function(j){return new(j||f)(v.Y36(v.SBq),v.Y36(v.Qsj))},f.\u0275dir=v.lG2({type:f,selectors:[["","elixInputPrimary",""]]}),f})()},7118:(si,Ze,I)=>{I.d(Ze,{M:()=>ly});var k,v=I(7716),re=I(3637),f=I(7574),V=I(4402),j=I(5917),J=I(6643),Ne=I(9761),me=I(9328),pe=I(8002),st=I(2145),Yt=I(7519),ne=I(5435),$e=I(8939),ri=I(8583),Ct=(I(4671),I(4486)),S=I(8239),Qt=I(5452),_n=I(6034),De=I(5601),$=I(3854),vn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},qe={},Wt=Wt||{},B=vn||self;function At(){}function wn(n){var e=typeof n;return"array"==(e="object"!=e?e:n?Array.isArray(n)?"array":e:"null")||"object"==e&&"number"==typeof n.length}function ut(n){var e=typeof n;return"object"==e&&null!=n||"function"==e}var Rt="closure_uid_"+(1e9*Math.random()>>>0),mt=0;function oi(n,e,t){return n.call.apply(n.bind,arguments)}function Tn(n,e,t){if(!n)throw Error();if(2<arguments.length){var i=Array.prototype.slice.call(arguments,2);return function(){var s=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(s,i),n.apply(e,s)}}return function(){return n.apply(e,arguments)}}function le(n,e,t){return(le=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?oi:Tn).apply(null,arguments)}function Pt(n,e){var t=Array.prototype.slice.call(arguments,1);return function(){var i=t.slice();return i.push.apply(i,arguments),n.apply(this,i)}}function ge(n,e){function t(){}t.prototype=e.prototype,n.Z=e.prototype,n.prototype=new t,n.prototype.constructor=n,n.Vb=function(i,s,r){for(var o=Array(arguments.length-2),l=2;l<arguments.length;l++)o[l-2]=arguments[l];return e.prototype[s].apply(i,o)}}function Xe(){this.s=this.s,this.o=this.o}var ai={};Xe.prototype.s=!1,Xe.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var n=function(n){return Object.prototype.hasOwnProperty.call(n,Rt)&&n[Rt]||(n[Rt]=++mt)}(this);delete ai[n]}},Xe.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const In=Array.prototype.indexOf?function(n,e){return Array.prototype.indexOf.call(n,e,void 0)}:function(n,e){if("string"==typeof n)return"string"!=typeof e||1!=e.length?-1:n.indexOf(e,0);for(let t=0;t<n.length;t++)if(t in n&&n[t]===e)return t;return-1},Sn=Array.prototype.forEach?function(n,e,t){Array.prototype.forEach.call(n,e,t)}:function(n,e,t){const i=n.length,s="string"==typeof n?n.split(""):n;for(let r=0;r<i;r++)r in s&&e.call(t,s[r],r,n)};function Nt(n){return Array.prototype.concat.apply([],arguments)}function Fe(n){const e=n.length;if(0<e){const t=Array(e);for(let i=0;i<e;i++)t[i]=n[i];return t}return[]}function kt(n){return/^[\s\xa0]*$/.test(n)}var ye,Lt=String.prototype.trim?function(n){return n.trim()}:function(n){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(n)[1]};function ce(n,e){return-1!=n.indexOf(e)}function Xt(n,e){return n<e?-1:n>e?1:0}e:{var ci=B.navigator;if(ci){var Wi=ci.userAgent;if(Wi){ye=Wi;break e}}ye=""}function li(n,e,t){for(const i in n)e.call(t,n[i],i,n)}function yt(n){const e={};for(const t in n)e[t]=n[t];return e}var xn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Cn(n,e){let t,i;for(let s=1;s<arguments.length;s++){for(t in i=arguments[s],i)n[t]=i[t];for(let r=0;r<xn.length;r++)t=xn[r],Object.prototype.hasOwnProperty.call(i,t)&&(n[t]=i[t])}}function An(n){return An[" "](n),n}An[" "]=At;var Jt,n,ui=ce(ye,"Opera"),ht=ce(ye,"Trident")||ce(ye,"MSIE"),Ot=ce(ye,"Edge"),Mt=Ot||ht,Pn=ce(ye,"Gecko")&&!(ce(ye.toLowerCase(),"webkit")&&!ce(ye,"Edge"))&&!(ce(ye,"Trident")||ce(ye,"MSIE"))&&!ce(ye,"Edge"),_t=ce(ye.toLowerCase(),"webkit")&&!ce(ye,"Edge");function Je(){var n=B.document;return n?n.documentMode:void 0}e:{var vt="",Ft=(n=ye,Pn?/rv:([^\);]+)(\)|;)/.exec(n):Ot?/Edge\/([\d\.]+)/.exec(n):ht?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(n):_t?/WebKit\/(\S+)/.exec(n):ui?/(?:Version)[ \/]?(\S+)/.exec(n):void 0);if(Ft&&(vt=Ft?Ft[1]:""),ht){var Ut=Je();if(null!=Ut&&Ut>parseFloat(vt)){Jt=String(Ut);break e}}Jt=vt}var no={};function Nn(){return e=no,Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=function(){let n=0;const e=Lt(String(Jt)).split("."),t=Lt("9").split("."),i=Math.max(e.length,t.length);for(let o=0;0==n&&o<i;o++){var s=e[o]||"",r=t[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],r=/(\d*)(\D*)(.*)/.exec(r)||["","","",""],0==s[0].length&&0==r[0].length)break;n=Xt(0==s[1].length?0:parseInt(s[1],10),0==r[1].length?0:parseInt(r[1],10))||Xt(0==s[2].length,0==r[2].length)||Xt(s[2],r[2]),s=s[3],r=r[3]}while(0==n)}return 0<=n}();var e}var Xi=B.document&&ht&&(Je()||parseInt(Jt,10))||void 0,di=function(){if(!B.addEventListener||!Object.defineProperty)return!1;var n=!1,e=Object.defineProperty({},"passive",{get:function(){n=!0}});try{B.addEventListener("test",At,e),B.removeEventListener("test",At,e)}catch(t){}return n}();function Ee(n,e){this.type=n,this.g=this.target=e,this.defaultPrevented=!1}function dt(n,e){if(Ee.call(this,n?n.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,n){var t=this.type=n.type,i=n.changedTouches&&n.changedTouches.length?n.changedTouches[0]:null;if(this.target=n.target||n.srcElement,this.g=e,e=n.relatedTarget){if(Pn){e:{try{An(e.nodeName);var s=!0;break e}catch(r){}s=!1}s||(e=null)}}else"mouseover"==t?e=n.fromElement:"mouseout"==t&&(e=n.toElement);this.relatedTarget=e,i?(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0):(this.clientX=void 0!==n.clientX?n.clientX:n.pageX,this.clientY=void 0!==n.clientY?n.clientY:n.pageY,this.screenX=n.screenX||0,this.screenY=n.screenY||0),this.button=n.button,this.key=n.key||"",this.ctrlKey=n.ctrlKey,this.altKey=n.altKey,this.shiftKey=n.shiftKey,this.metaKey=n.metaKey,this.pointerId=n.pointerId||0,this.pointerType="string"==typeof n.pointerType?n.pointerType:Ys[n.pointerType]||"",this.state=n.state,this.i=n,n.defaultPrevented&&dt.Z.h.call(this)}}Ee.prototype.h=function(){this.defaultPrevented=!0},ge(dt,Ee);var Ys={2:"touch",3:"pen",4:"mouse"};dt.prototype.h=function(){dt.Z.h.call(this);var n=this.i;n.preventDefault?n.preventDefault():n.returnValue=!1};var wt="closure_listenable_"+(1e6*Math.random()|0),Qs=0;function Ji(n,e,t,i,s){this.listener=n,this.proxy=null,this.src=e,this.type=t,this.capture=!!i,this.ia=s,this.key=++Qs,this.ca=this.fa=!1}function Ln(n){n.ca=!0,n.listener=null,n.proxy=null,n.src=null,n.ia=null}function en(n){this.src=n,this.g={},this.h=0}function fi(n,e){var t=e.type;if(t in n.g){var r,i=n.g[t],s=In(i,e);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(Ln(e),0==n.g[t].length&&(delete n.g[t],n.h--))}}function tn(n,e,t,i){for(var s=0;s<n.length;++s){var r=n[s];if(!r.ca&&r.listener==e&&r.capture==!!t&&r.ia==i)return s}return-1}en.prototype.add=function(n,e,t,i,s){var r=n.toString();(n=this.g[r])||(n=this.g[r]=[],this.h++);var o=tn(n,e,i,s);return-1<o?(e=n[o],t||(e.fa=!1)):((e=new Ji(e,this.src,r,!!i,s)).fa=t,n.push(e)),e};var w="closure_lm_"+(1e6*Math.random()|0),m={};function a(n,e,t,i,s){if(i&&i.once)return p(n,e,t,i,s);if(Array.isArray(e)){for(var r=0;r<e.length;r++)a(n,e[r],t,i,s);return null}return t=G(t),n&&n[wt]?n.N(e,t,ut(i)?!!i.capture:!!i,s):c(n,e,t,!1,i,s)}function c(n,e,t,i,s,r){if(!e)throw Error("Invalid event type");var o=ut(s)?!!s.capture:!!s,l=q(n);if(l||(n[w]=l=new en(n)),(t=l.add(e,t,i,o,r)).proxy)return t;if(i=function(){var e=L;return function n(t){return e.call(n.src,n.listener,t)}}(),t.proxy=i,i.src=n,i.listener=t,n.addEventListener)di||(s=o),void 0===s&&(s=!1),n.addEventListener(e.toString(),i,s);else if(n.attachEvent)n.attachEvent(D(e.toString()),i);else{if(!n.addListener||!n.removeListener)throw Error("addEventListener and attachEvent are unavailable.");n.addListener(i)}return t}function p(n,e,t,i,s){if(Array.isArray(e)){for(var r=0;r<e.length;r++)p(n,e[r],t,i,s);return null}return t=G(t),n&&n[wt]?n.O(e,t,ut(i)?!!i.capture:!!i,s):c(n,e,t,!0,i,s)}function y(n,e,t,i,s){if(Array.isArray(e))for(var r=0;r<e.length;r++)y(n,e[r],t,i,s);else i=ut(i)?!!i.capture:!!i,t=G(t),n&&n[wt]?(n=n.i,(e=String(e).toString())in n.g&&-1<(t=tn(r=n.g[e],t,i,s))&&(Ln(r[t]),Array.prototype.splice.call(r,t,1),0==r.length&&(delete n.g[e],n.h--))):n&&(n=q(n))&&(e=n.g[e.toString()],n=-1,e&&(n=tn(e,t,i,s)),(t=-1<n?e[n]:null)&&b(t))}function b(n){if("number"!=typeof n&&n&&!n.ca){var e=n.src;if(e&&e[wt])fi(e.i,n);else{var t=n.type,i=n.proxy;e.removeEventListener?e.removeEventListener(t,i,n.capture):e.detachEvent?e.detachEvent(D(t),i):e.addListener&&e.removeListener&&e.removeListener(i),(t=q(e))?(fi(t,n),0==t.h&&(t.src=null,e[w]=null)):Ln(n)}}}function D(n){return n in m?m[n]:m[n]="on"+n}function L(n,e){if(n.ca)n=!0;else{e=new dt(e,this);var t=n.listener,i=n.ia||n.src;n.fa&&b(n),n=t.call(i,e)}return n}function q(n){return(n=n[w])instanceof en?n:null}var U="__closure_events_fn_"+(1e9*Math.random()>>>0);function G(n){return"function"==typeof n?n:(n[U]||(n[U]=function(e){return n.handleEvent(e)}),n[U])}function Y(){Xe.call(this),this.i=new en(this),this.P=this,this.I=null}function te(n,e){var t,i=n.I;if(i)for(t=[];i;i=i.I)t.push(i);if(n=n.P,i=e.type||e,"string"==typeof e)e=new Ee(e,n);else if(e instanceof Ee)e.target=e.target||n;else{var s=e;Cn(e=new Ee(i,n),s)}if(s=!0,t)for(var r=t.length-1;0<=r;r--){var o=e.g=t[r];s=ot(o,i,!0,e)&&s}if(s=ot(o=e.g=n,i,!0,e)&&s,s=ot(o,i,!1,e)&&s,t)for(r=0;r<t.length;r++)s=ot(o=e.g=t[r],i,!1,e)&&s}function ot(n,e,t,i){if(!(e=n.i.g[String(e)]))return!0;e=e.concat();for(var s=!0,r=0;r<e.length;++r){var o=e[r];if(o&&!o.ca&&o.capture==t){var l=o.listener,u=o.ia||o.src;o.fa&&fi(n.i,o),s=!1!==l.call(u,i)&&s}}return s&&!i.defaultPrevented}ge(Y,Xe),Y.prototype[wt]=!0,Y.prototype.removeEventListener=function(n,e,t,i){y(this,n,e,t,i)},Y.prototype.M=function(){if(Y.Z.M.call(this),this.i){var e,n=this.i;for(e in n.g){for(var t=n.g[e],i=0;i<t.length;i++)Ln(t[i]);delete n.g[e],n.h--}}this.I=null},Y.prototype.N=function(n,e,t,i){return this.i.add(String(n),e,!1,t,i)},Y.prototype.O=function(n,e,t,i){return this.i.add(String(n),e,!0,t,i)};var bt=B.JSON.stringify;function He(){var n=Oc;let e=null;return n.g&&(e=n.g,n.g=n.g.next,n.g||(n.h=null),e.next=null),e}var ro,es=new class{constructor(n,e){this.i=n,this.j=e,this.h=0,this.g=null}get(){let n;return 0<this.h?(this.h--,n=this.g,this.g=n.next,n.next=null):n=this.i(),n}}(()=>new ts,n=>n.reset());class ts{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Ws(n){B.setTimeout(()=>{throw n},0)}function so(n,e){ro||function(){var n=B.Promise.resolve(void 0);ro=function(){n.then(Pd)}}(),oo||(ro(),oo=!0),Oc.add(n,e)}var oo=!1,Oc=new class{constructor(){this.h=this.g=null}add(e,t){const i=es.get();i.set(e,t),this.h?this.h.next=i:this.g=i,this.h=i}};function Pd(){for(var n;n=He();){try{n.h.call(n.g)}catch(t){Ws(t)}var e=es;e.j(n),100>e.h&&(e.h++,n.next=e.g,e.g=n)}oo=!1}function Xs(n,e){Y.call(this),this.h=n||1,this.g=e||B,this.j=le(this.kb,this),this.l=Date.now()}function ao(n){n.da=!1,n.S&&(n.g.clearTimeout(n.S),n.S=null)}function co(n,e,t){if("function"==typeof n)t&&(n=le(n,t));else{if(!n||"function"!=typeof n.handleEvent)throw Error("Invalid listener argument");n=le(n.handleEvent,n)}return 2147483647<Number(e)?-1:B.setTimeout(n,e||0)}function Mc(n){n.g=co(()=>{n.g=null,n.i&&(n.i=!1,Mc(n))},n.j);const e=n.h;n.h=null,n.m.apply(null,e)}ge(Xs,Y),(k=Xs.prototype).da=!1,k.S=null,k.kb=function(){if(this.da){var n=Date.now()-this.l;0<n&&n<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-n):(this.S&&(this.g.clearTimeout(this.S),this.S=null),te(this,"tick"),this.da&&(ao(this),this.start()))}},k.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},k.M=function(){Xs.Z.M.call(this),ao(this),delete this.g};class Nd extends Xe{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:Mc(this)}M(){super.M(),this.g&&(B.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ns(n){Xe.call(this),this.h=n,this.g={}}ge(ns,Xe);var Fc=[];function Uc(n,e,t,i){Array.isArray(t)||(t&&(Fc[0]=t.toString()),t=Fc);for(var s=0;s<t.length;s++){var r=a(e,t[s],i||n.handleEvent,!1,n.h||n);if(!r)break;n.g[r.key]=r}}function Vc(n){li(n.g,function(e,t){this.g.hasOwnProperty(t)&&b(e)},n),n.g={}}function Js(){this.g=!0}function pi(n,e,t,i){n.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(n,e){if(!n.g)return e;if(!e)return null;try{var t=JSON.parse(e);if(t)for(n=0;n<t.length;n++)if(Array.isArray(t[n])){var i=t[n];if(!(2>i.length)){var s=i[1];if(Array.isArray(s)&&!(1>s.length)){var r=s[0];if("noop"!=r&&"stop"!=r&&"close"!=r)for(var o=1;o<s.length;o++)s[o]=""}}}return bt(t)}catch(l){return e}}(n,t)+(i?" "+i:"")})}ns.prototype.M=function(){ns.Z.M.call(this),Vc(this)},ns.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Js.prototype.Aa=function(){this.g=!1},Js.prototype.info=function(){};var On={},Bc=null;function er(){return Bc=Bc||new Y}function qc(n){Ee.call(this,On.Ma,n)}function is(n){const e=er();te(e,new qc(e,n))}function Gc(n,e){Ee.call(this,On.STAT_EVENT,n),this.stat=e}function Ge(n){const e=er();te(e,new Gc(e,n))}function zc(n,e){Ee.call(this,On.Na,n),this.size=e}function ss(n,e){if("function"!=typeof n)throw Error("Fn must not be null and must be a function");return B.setTimeout(function(){n()},e)}On.Ma="serverreachability",ge(qc,Ee),On.STAT_EVENT="statevent",ge(Gc,Ee),On.Na="timingevent",ge(zc,Ee);var tr={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},jc={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function lo(){}function Zc(){}lo.prototype.h=null;var fo,rs={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function uo(){Ee.call(this,"d")}function ho(){Ee.call(this,"c")}function nr(){}function os(n,e,t,i){this.l=n,this.j=e,this.m=t,this.X=i||1,this.V=new ns(this),this.P=Fd,this.W=new Xs(n=Mt?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new $c}function $c(){this.i=null,this.g="",this.h=!1}ge(uo,Ee),ge(ho,Ee),ge(nr,lo),nr.prototype.g=function(){return new XMLHttpRequest},nr.prototype.i=function(){return{}},fo=new nr;var Fd=45e3,po={},ir={};function go(n,e,t){n.K=1,n.v=cr(Vt(e)),n.s=t,n.U=!0,Hc(n,null)}function Hc(n,e){n.F=Date.now(),as(n),n.A=Vt(n.v);var t=n.A,i=n.X;Array.isArray(i)||(i=[String(i)]),il(t.h,"t",i),n.C=0,t=n.l.H,n.h=new $c,n.g=Dl(n.l,t?e:null,!n.s),0<n.O&&(n.L=new Nd(le(n.Ia,n,n.g),n.O)),Uc(n.V,n.g,"readystatechange",n.gb),e=n.H?yt(n.H):{},n.s?(n.u||(n.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",n.g.ea(n.A,n.u,n.s,e)):(n.u="GET",n.g.ea(n.A,n.u,null,e)),is(1),function(n,e,t,i,s,r){n.info(function(){if(n.g)if(r)for(var o="",l=r.split("&"),u=0;u<l.length;u++){var d=l[u].split("=");if(1<d.length){var g=d[0];d=d[1];var _=g.split("_");o=2<=_.length&&"type"==_[1]?o+(g+"=")+d+"&":o+(g+"=redacted&")}}else o=null;else o=r;return"XMLHTTP REQ ("+i+") [attempt "+s+"]: "+e+"\n"+t+"\n"+o})}(n.j,n.u,n.A,n.m,n.X,n.s)}function Yc(n){return!!n.g&&"GET"==n.u&&2!=n.K&&n.l.Ba}function Qc(n,e,t){let s,i=!0;for(;!n.I&&n.C<t.length;){if(s=Ud(n,t),s==ir){4==e&&(n.o=4,Ge(14),i=!1),pi(n.j,n.m,null,"[Incomplete Response]");break}if(s==po){n.o=4,Ge(15),pi(n.j,n.m,t,"[Invalid Chunk]"),i=!1;break}pi(n.j,n.m,s,null),mo(n,s)}Yc(n)&&s!=ir&&s!=po&&(n.h.g="",n.C=0),4!=e||0!=t.length||n.h.h||(n.o=1,Ge(16),i=!1),n.i=n.i&&i,i?0<t.length&&!n.aa&&(n.aa=!0,(e=n.l).g==n&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+t.length),xo(e),e.L=!0,Ge(11))):(pi(n.j,n.m,t,"[Invalid Chunked Response]"),Mn(n),cs(n))}function Ud(n,e){var t=n.C,i=e.indexOf("\n",t);return-1==i?ir:(t=Number(e.substring(t,i)),isNaN(t)?po:(i+=1)+t>e.length?ir:(e=e.substr(i,t),n.C=i+t,e))}function as(n){n.Y=Date.now()+n.P,Wc(n,n.P)}function Wc(n,e){if(null!=n.B)throw Error("WatchDog timer not null");n.B=ss(le(n.eb,n),e)}function sr(n){n.B&&(B.clearTimeout(n.B),n.B=null)}function cs(n){0==n.l.G||n.I||Tl(n.l,n)}function Mn(n){sr(n);var e=n.L;e&&"function"==typeof e.na&&e.na(),n.L=null,ao(n.W),Vc(n.V),n.g&&(e=n.g,n.g=null,e.abort(),e.na())}function mo(n,e){try{var t=n.l;if(0!=t.G&&(t.g==n||vo(t.i,n)))if(t.I=n.N,!n.J&&vo(t.i,n)&&3==t.G){try{var i=t.Ca.g.parse(e)}catch(d){i=null}if(Array.isArray(i)&&3==i.length){var s=i;if(0==s[0])e:if(t.u)t.ta=s[1],0<t.ta-t.U&&37500>s[2]&&t.N&&0==t.A&&!t.v&&(t.v=ss(le(t.ab,t),6e3));else{if(t.g){if(!(t.g.F+3e3<n.F))break e;pr(t),dr(t)}Do(t),Ge(18)}if(1>=ol(t.i)&&t.ka){try{t.ka()}catch(d){}t.ka=void 0}}else Vn(t,11)}else if((n.J||t.g==n)&&pr(t),!kt(e))for(s=t.Ca.g.parse(e),e=0;e<s.length;e++){let d=s[e];if(t.U=d[0],d=d[1],2==t.G)if("c"==d[0]){t.J=d[1],t.la=d[2];const g=d[3];null!=g&&(t.ma=g,t.h.info("VER="+t.ma));const _=d[4];null!=_&&(t.za=_,t.h.info("SVER="+t.za));const E=d[5];null!=E&&"number"==typeof E&&0<E&&(t.K=i=1.5*E,t.h.info("backChannelRequestTimeoutMs_="+i)),i=t;const x=n.g;if(x){const P=x.g?x.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(P){var r=i.i;!r.g&&(ce(P,"spdy")||ce(P,"quic")||ce(P,"h2"))&&(r.j=r.l,r.g=new Set,r.h&&(wo(r,r.h),r.h=null))}if(i.D){const F=x.g?x.g.getResponseHeader("X-HTTP-Session-Id"):null;F&&(i.sa=F,oe(i.F,i.D,F))}}t.G=3,t.j&&t.j.xa(),t.$&&(t.O=Date.now()-n.F,t.h.info("Handshake RTT: "+t.O+"ms"));var o=n;if((i=t).oa=Sl(i,i.H?i.la:null,i.W),o.J){al(i.i,o);var l=o,u=i.K;u&&l.setTimeout(u),l.B&&(sr(l),as(l)),i.g=o}else wl(i);0<t.l.length&&fr(t)}else"stop"!=d[0]&&"close"!=d[0]||Vn(t,7);else 3==t.G&&("stop"==d[0]||"close"==d[0]?"stop"==d[0]?Vn(t,7):Io(t):"noop"!=d[0]&&t.j&&t.j.wa(d),t.A=0)}is(4)}catch(d){}}function yo(n,e){if(n.forEach&&"function"==typeof n.forEach)n.forEach(e,void 0);else if(wn(n)||"string"==typeof n)Sn(n,e,void 0);else{if(n.T&&"function"==typeof n.T)var t=n.T();else if(n.R&&"function"==typeof n.R)t=void 0;else if(wn(n)||"string"==typeof n){t=[];for(var i=n.length,s=0;s<i;s++)t.push(s)}else for(s in t=[],i=0,n)t[i++]=s;s=(i=function(n){if(n.R&&"function"==typeof n.R)return n.R();if("string"==typeof n)return n.split("");if(wn(n)){for(var e=[],t=n.length,i=0;i<t;i++)e.push(n[i]);return e}for(i in e=[],t=0,n)e[t++]=n[i];return e}(n)).length;for(var r=0;r<s;r++)e.call(void 0,i[r],t&&t[r],n)}}function gi(n,e){this.h={},this.g=[],this.i=0;var t=arguments.length;if(1<t){if(t%2)throw Error("Uneven number of arguments");for(var i=0;i<t;i+=2)this.set(arguments[i],arguments[i+1])}else if(n)if(n instanceof gi)for(t=n.T(),i=0;i<t.length;i++)this.set(t[i],n.get(t[i]));else for(i in n)this.set(i,n[i])}function _o(n){if(n.i!=n.g.length){for(var e=0,t=0;e<n.g.length;){var i=n.g[e];Fn(n.h,i)&&(n.g[t++]=i),e++}n.g.length=t}if(n.i!=n.g.length){var s={};for(t=e=0;e<n.g.length;)Fn(s,i=n.g[e])||(n.g[t++]=i,s[i]=1),e++;n.g.length=t}}function Fn(n,e){return Object.prototype.hasOwnProperty.call(n,e)}(k=os.prototype).setTimeout=function(n){this.P=n},k.gb=function(n){n=n.target;const e=this.L;e&&3==Bt(n)?e.l():this.Ia(n)},k.Ia=function(n){try{if(n==this.g)e:{const g=Bt(this.g);var e=this.g.Da();const _=this.g.ba();if(!(3>g)&&(3!=g||Mt||this.g&&(this.h.h||this.g.ga()||gl(this.g)))){this.I||4!=g||7==e||is(8==e||0>=_?3:2),sr(this);var t=this.g.ba();this.N=t;t:if(Yc(this)){var i=gl(this.g);n="";var s=i.length,r=4==Bt(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Mn(this),cs(this);var o="";break t}this.h.i=new B.TextDecoder}for(e=0;e<s;e++)this.h.h=!0,n+=this.h.i.decode(i[e],{stream:r&&e==s-1});i.splice(0,s),this.h.g+=n,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=200==t,function(n,e,t,i,s,r,o){n.info(function(){return"XMLHTTP RESP ("+i+") [ attempt "+s+"]: "+e+"\n"+t+"\n"+r+" "+o})}(this.j,this.u,this.A,this.m,this.X,g,t),this.i){if(this.$&&!this.J){t:{if(this.g){var l,u=this.g;if((l=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!kt(l)){var d=l;break t}}d=null}if(!(t=d)){this.i=!1,this.o=3,Ge(12),Mn(this),cs(this);break e}pi(this.j,this.m,t,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,mo(this,t)}this.U?(Qc(this,g,o),Mt&&this.i&&3==g&&(Uc(this.V,this.W,"tick",this.fb),this.W.start())):(pi(this.j,this.m,o,null),mo(this,o)),4==g&&Mn(this),this.i&&!this.I&&(4==g?Tl(this.l,this):(this.i=!1,as(this)))}else 400==t&&0<o.indexOf("Unknown SID")?(this.o=3,Ge(12)):(this.o=0,Ge(13)),Mn(this),cs(this)}}}catch(g){}},k.fb=function(){if(this.g){var n=Bt(this.g),e=this.g.ga();this.C<e.length&&(sr(this),Qc(this,n,e),this.i&&4!=n&&as(this))}},k.cancel=function(){this.I=!0,Mn(this)},k.eb=function(){this.B=null;const n=Date.now();0<=n-this.Y?(function(n,e){n.info(function(){return"TIMEOUT: "+e})}(this.j,this.A),2!=this.K&&(is(3),Ge(17)),Mn(this),this.o=2,cs(this)):Wc(this,this.Y-n)},(k=gi.prototype).R=function(){_o(this);for(var n=[],e=0;e<this.g.length;e++)n.push(this.h[this.g[e]]);return n},k.T=function(){return _o(this),this.g.concat()},k.get=function(n,e){return Fn(this.h,n)?this.h[n]:e},k.set=function(n,e){Fn(this.h,n)||(this.i++,this.g.push(n)),this.h[n]=e},k.forEach=function(n,e){for(var t=this.T(),i=0;i<t.length;i++){var s=t[i],r=this.get(s);n.call(e,r,s,this)}};var Xc=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Un(n,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,n instanceof Un){this.g=void 0!==e?e:n.g,rr(this,n.j),this.s=n.s,or(this,n.i),ar(this,n.m),this.l=n.l,e=n.h;var t=new hs;t.i=e.i,e.g&&(t.g=new gi(e.g),t.h=e.h),Jc(this,t),this.o=n.o}else n&&(t=String(n).match(Xc))?(this.g=!!e,rr(this,t[1]||"",!0),this.s=ls(t[2]||""),or(this,t[3]||"",!0),ar(this,t[4]),this.l=ls(t[5]||"",!0),Jc(this,t[6]||"",!0),this.o=ls(t[7]||"")):(this.g=!!e,this.h=new hs(null,this.g))}function Vt(n){return new Un(n)}function rr(n,e,t){n.j=t?ls(e,!0):e,n.j&&(n.j=n.j.replace(/:$/,""))}function or(n,e,t){n.i=t?ls(e,!0):e}function ar(n,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);n.m=e}else n.m=null}function Jc(n,e,t){e instanceof hs?(n.h=e,function(n,e){e&&!n.j&&(nn(n),n.i=null,n.g.forEach(function(t,i){var s=i.toLowerCase();i!=s&&(tl(this,i),il(this,s,t))},n)),n.j=e}(n.h,n.g)):(t||(e=us(e,Zd)),n.h=new hs(e,n.g))}function oe(n,e,t){n.h.set(e,t)}function cr(n){return oe(n,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),n}function ls(n,e){return n?e?decodeURI(n.replace(/%25/g,"%2525")):decodeURIComponent(n):""}function us(n,e,t){return"string"==typeof n?(n=encodeURI(n).replace(e,zd),t&&(n=n.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n):null}function zd(n){return"%"+((n=n.charCodeAt(0))>>4&15).toString(16)+(15&n).toString(16)}Un.prototype.toString=function(){var n=[],e=this.j;e&&n.push(us(e,el,!0),":");var t=this.i;return(t||"file"==e)&&(n.push("//"),(e=this.s)&&n.push(us(e,el,!0),"@"),n.push(encodeURIComponent(String(t)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(t=this.m)&&n.push(":",String(t))),(t=this.l)&&(this.i&&"/"!=t.charAt(0)&&n.push("/"),n.push(us(t,"/"==t.charAt(0)?Kd:jd,!0))),(t=this.h.toString())&&n.push("?",t),(t=this.o)&&n.push("#",us(t,$d)),n.join("")};var el=/[#\/\?@]/g,jd=/[#\?:]/g,Kd=/[#\?]/g,Zd=/[#\?@]/g,$d=/#/g;function hs(n,e){this.h=this.g=null,this.i=n||null,this.j=!!e}function nn(n){n.g||(n.g=new gi,n.h=0,n.i&&function(n,e){if(n){n=n.split("&");for(var t=0;t<n.length;t++){var i=n[t].indexOf("="),s=null;if(0<=i){var r=n[t].substring(0,i);s=n[t].substring(i+1)}else r=n[t];e(r,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(n.i,function(e,t){n.add(decodeURIComponent(e.replace(/\+/g," ")),t)}))}function tl(n,e){nn(n),e=mi(n,e),Fn(n.g.h,e)&&(n.i=null,n.h-=n.g.get(e).length,Fn((n=n.g).h,e)&&(delete n.h[e],n.i--,n.g.length>2*n.i&&_o(n)))}function nl(n,e){return nn(n),e=mi(n,e),Fn(n.g.h,e)}function il(n,e,t){tl(n,e),0<t.length&&(n.i=null,n.g.set(mi(n,e),Fe(t)),n.h+=t.length)}function mi(n,e){return e=String(e),n.j&&(e=e.toLowerCase()),e}function sl(n){this.l=n||Qd,n=B.PerformanceNavigationTiming?0<(n=B.performance.getEntriesByType("navigation")).length&&("hq"==n[0].nextHopProtocol||"h2"==n[0].nextHopProtocol):!!(B.g&&B.g.Ea&&B.g.Ea()&&B.g.Ea().Zb),this.j=n?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}(k=hs.prototype).add=function(n,e){nn(this),this.i=null,n=mi(this,n);var t=this.g.get(n);return t||this.g.set(n,t=[]),t.push(e),this.h+=1,this},k.forEach=function(n,e){nn(this),this.g.forEach(function(t,i){Sn(t,function(s){n.call(e,s,i,this)},this)},this)},k.T=function(){nn(this);for(var n=this.g.R(),e=this.g.T(),t=[],i=0;i<e.length;i++)for(var s=n[i],r=0;r<s.length;r++)t.push(e[i]);return t},k.R=function(n){nn(this);var e=[];if("string"==typeof n)nl(this,n)&&(e=Nt(e,this.g.get(mi(this,n))));else{n=this.g.R();for(var t=0;t<n.length;t++)e=Nt(e,n[t])}return e},k.set=function(n,e){return nn(this),this.i=null,nl(this,n=mi(this,n))&&(this.h-=this.g.get(n).length),this.g.set(n,[e]),this.h+=1,this},k.get=function(n,e){return n&&0<(n=this.R(n)).length?String(n[0]):e},k.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var n=[],e=this.g.T(),t=0;t<e.length;t++){var i=e[t],s=encodeURIComponent(String(i));i=this.R(i);for(var r=0;r<i.length;r++){var o=s;""!==i[r]&&(o+="="+encodeURIComponent(String(i[r]))),n.push(o)}}return this.i=n.join("&")};var Qd=10;function rl(n){return!!n.h||!!n.g&&n.g.size>=n.j}function ol(n){return n.h?1:n.g?n.g.size:0}function vo(n,e){return n.h?n.h==e:!!n.g&&n.g.has(e)}function wo(n,e){n.g?n.g.add(e):n.h=e}function al(n,e){n.h&&n.h==e?n.h=null:n.g&&n.g.has(e)&&n.g.delete(e)}function cl(n){if(null!=n.h)return n.i.concat(n.h.D);if(null!=n.g&&0!==n.g.size){let e=n.i;for(const t of n.g.values())e=e.concat(t.D);return e}return Fe(n.i)}function bo(){}function Wd(){this.g=new bo}function Xd(n,e,t){const i=t||"";try{yo(n,function(s,r){let o=s;ut(s)&&(o=bt(s)),e.push(i+r+"="+encodeURIComponent(o))})}catch(s){throw e.push(i+"type="+encodeURIComponent("_badmap")),s}}function lr(n,e,t,i,s){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,s(i)}catch(r){}}function ds(n){this.l=n.$b||null,this.j=n.ib||!1}function ur(n,e){Y.call(this),this.D=n,this.u=e,this.m=void 0,this.readyState=To,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}sl.prototype.cancel=function(){if(this.i=cl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const n of this.g.values())n.cancel();this.g.clear()}},bo.prototype.stringify=function(n){return B.JSON.stringify(n,void 0)},bo.prototype.parse=function(n){return B.JSON.parse(n,void 0)},ge(ds,lo),ds.prototype.g=function(){return new ur(this.l,this.j)},ds.prototype.i=function(n){return function(){return n}}({}),ge(ur,Y);var To=0;function ll(n){n.j.read().then(n.Sa.bind(n)).catch(n.ha.bind(n))}function fs(n){n.readyState=4,n.l=null,n.j=null,n.A=null,ps(n)}function ps(n){n.onreadystatechange&&n.onreadystatechange.call(n)}(k=ur.prototype).open=function(n,e){if(this.readyState!=To)throw this.abort(),Error("Error reopening a connection");this.C=n,this.B=e,this.readyState=1,ps(this)},k.send=function(n){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};n&&(e.body=n),(this.D||B).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))},k.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,fs(this)),this.readyState=To},k.Va=function(n){if(this.g&&(this.l=n,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=n.headers,this.readyState=2,ps(this)),this.g&&(this.readyState=3,ps(this),this.g)))if("arraybuffer"===this.responseType)n.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==B.ReadableStream&&"body"in n){if(this.j=n.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;ll(this)}else n.text().then(this.Ua.bind(this),this.ha.bind(this))},k.Sa=function(n){if(this.g){if(this.u&&n.value)this.response.push(n.value);else if(!this.u){var e=n.value?n.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!n.done}))&&(this.response=this.responseText+=e)}n.done?fs(this):ps(this),3==this.readyState&&ll(this)}},k.Ua=function(n){this.g&&(this.response=this.responseText=n,fs(this))},k.Ta=function(n){this.g&&(this.response=n,fs(this))},k.ha=function(){this.g&&fs(this)},k.setRequestHeader=function(n,e){this.v.append(n,e)},k.getResponseHeader=function(n){return this.h&&this.h.get(n.toLowerCase())||""},k.getAllResponseHeaders=function(){if(!this.h)return"";const n=[],e=this.h.entries();for(var t=e.next();!t.done;)n.push((t=t.value)[0]+": "+t[1]),t=e.next();return n.join("\r\n")},Object.defineProperty(ur.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(n){this.m=n?"include":"same-origin"}});var ef=B.JSON.parse;function _e(n){Y.call(this),this.headers=new gi,this.u=n||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=ul,this.K=this.L=!1}ge(_e,Y);var ul="",tf=/^https?$/i,nf=["POST","PUT"];function rf(n){return"content-type"==n.toLowerCase()}function hl(n,e){n.h=!1,n.g&&(n.l=!0,n.g.abort(),n.l=!1),n.j=e,n.m=5,dl(n),hr(n)}function dl(n){n.D||(n.D=!0,te(n,"complete"),te(n,"error"))}function fl(n){if(n.h&&void 0!==Wt&&(!n.C[1]||4!=Bt(n)||2!=n.ba()))if(n.v&&4==Bt(n))co(n.Fa,0,n);else if(te(n,"readystatechange"),4==Bt(n)){n.h=!1;try{const l=n.ba();e:switch(l){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var e=!0;break e;default:e=!1}var t;if(!(t=e)){var i;if(i=0===l){var s=String(n.H).match(Xc)[1]||null;if(!s&&B.self&&B.self.location){var r=B.self.location.protocol;s=r.substr(0,r.length-1)}i=!tf.test(s?s.toLowerCase():"")}t=i}if(t)te(n,"complete"),te(n,"success");else{n.m=6;try{var o=2<Bt(n)?n.g.statusText:""}catch(u){o=""}n.j=o+" ["+n.ba()+"]",dl(n)}}finally{hr(n)}}}function hr(n,e){if(n.g){pl(n);const t=n.g,i=n.C[0]?At:null;n.g=null,n.C=null,e||te(n,"ready");try{t.onreadystatechange=i}catch(s){}}}function pl(n){n.g&&n.K&&(n.g.ontimeout=null),n.A&&(B.clearTimeout(n.A),n.A=null)}function Bt(n){return n.g?n.g.readyState:0}function gl(n){try{if(!n.g)return null;if("response"in n.g)return n.g.response;switch(n.J){case ul:case"text":return n.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in n.g)return n.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Eo(n,e,t){e:{for(i in t){var i=!1;break e}i=!0}i||(t=function(n){let e="";return li(n,function(t,i){e+=i,e+=":",e+=t,e+="\r\n"}),e}(t),"string"==typeof n?null!=t&&encodeURIComponent(String(t)):oe(n,e,t))}function gs(n,e,t){return t&&t.internalChannelParams&&t.internalChannelParams[n]||e}function ml(n){this.za=0,this.l=[],this.h=new Js,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=gs("failFast",!1,n),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=gs("baseRetryDelayMs",5e3,n),this.$a=gs("retryDelaySeedMs",1e4,n),this.Ya=gs("forwardChannelMaxRetries",2,n),this.ra=gs("forwardChannelRequestTimeoutMs",2e4,n),this.qa=n&&n.xmlHttpFactory||void 0,this.Ba=n&&n.Yb||!1,this.K=void 0,this.H=n&&n.supportsCrossDomainXhr||!1,this.J="",this.i=new sl(n&&n.concurrentRequestLimit),this.Ca=new Wd,this.ja=n&&n.fastHandshake||!1,this.Ra=n&&n.Wb||!1,n&&n.Aa&&this.h.Aa(),n&&n.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&n&&n.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!n||!1!==n.Xb}function Io(n){if(yl(n),3==n.G){var e=n.V++,t=Vt(n.F);oe(t,"SID",n.J),oe(t,"RID",e),oe(t,"TYPE","terminate"),ms(n,t),(e=new os(n,n.h,e,void 0)).K=2,e.v=cr(Vt(t)),t=!1,B.navigator&&B.navigator.sendBeacon&&(t=B.navigator.sendBeacon(e.v.toString(),"")),!t&&B.Image&&((new Image).src=e.v,t=!0),t||(e.g=Dl(e.l,null),e.g.ea(e.v)),e.F=Date.now(),as(e)}Il(n)}function dr(n){n.g&&(xo(n),n.g.cancel(),n.g=null)}function yl(n){dr(n),n.u&&(B.clearTimeout(n.u),n.u=null),pr(n),n.i.cancel(),n.m&&("number"==typeof n.m&&B.clearTimeout(n.m),n.m=null)}function So(n,e){n.l.push(new class{constructor(n,e){this.h=n,this.g=e}}(n.Za++,e)),3==n.G&&fr(n)}function fr(n){rl(n.i)||n.m||(n.m=!0,so(n.Ha,n),n.C=0)}function _l(n,e){var t;t=e?e.m:n.V++;const i=Vt(n.F);oe(i,"SID",n.J),oe(i,"RID",t),oe(i,"AID",n.U),ms(n,i),n.o&&n.s&&Eo(i,n.o,n.s),t=new os(n,n.h,t,n.C+1),null===n.o&&(t.H=n.s),e&&(n.l=e.D.concat(n.l)),e=vl(n,t,1e3),t.setTimeout(Math.round(.5*n.ra)+Math.round(.5*n.ra*Math.random())),wo(n.i,t),go(t,i,e)}function ms(n,e){n.j&&yo({},function(t,i){oe(e,i,t)})}function vl(n,e,t){t=Math.min(n.l.length,t);var i=n.j?le(n.j.Oa,n.j,n):null;e:{var s=n.l;let r=-1;for(;;){const o=["count="+t];-1==r?0<t?(r=s[0].h,o.push("ofs="+r)):r=0:o.push("ofs="+r);let l=!0;for(let u=0;u<t;u++){let d=s[u].h;const g=s[u].g;if(d-=r,0>d)r=Math.max(0,s[u].h-100),l=!1;else try{Xd(g,o,"req"+d+"_")}catch(_){i&&i(g)}}if(l){i=o.join("&");break e}}}return n=n.l.splice(0,t),e.D=n,i}function wl(n){n.g||n.u||(n.Y=1,so(n.Ga,n),n.A=0)}function Do(n){return!(n.g||n.u||3<=n.A||(n.Y++,n.u=ss(le(n.Ga,n),El(n,n.A)),n.A++,0))}function xo(n){null!=n.B&&(B.clearTimeout(n.B),n.B=null)}function bl(n){n.g=new os(n,n.h,"rpc",n.Y),null===n.o&&(n.g.H=n.s),n.g.O=0;var e=Vt(n.oa);oe(e,"RID","rpc"),oe(e,"SID",n.J),oe(e,"CI",n.N?"0":"1"),oe(e,"AID",n.U),ms(n,e),oe(e,"TYPE","xmlhttp"),n.o&&n.s&&Eo(e,n.o,n.s),n.K&&n.g.setTimeout(n.K);var t=n.g;n=n.la,t.K=1,t.v=cr(Vt(e)),t.s=null,t.U=!0,Hc(t,n)}function pr(n){null!=n.v&&(B.clearTimeout(n.v),n.v=null)}function Tl(n,e){var t=null;if(n.g==e){pr(n),xo(n),n.g=null;var i=2}else{if(!vo(n.i,e))return;t=e.D,al(n.i,e),i=1}if(n.I=e.N,0!=n.G)if(e.i)if(1==i){t=e.s?e.s.length:0,e=Date.now()-e.F;var s=n.C;te(i=er(),new zc(i,t,e,s)),fr(n)}else wl(n);else if(3==(s=e.o)||0==s&&0<n.I||!(1==i&&function(n,e){return!(ol(n.i)>=n.i.j-(n.m?1:0)||(n.m?(n.l=e.D.concat(n.l),0):1==n.G||2==n.G||n.C>=(n.Xa?0:n.Ya)||(n.m=ss(le(n.Ha,n,e),El(n,n.C)),n.C++,0)))}(n,e)||2==i&&Do(n)))switch(t&&0<t.length&&(e=n.i,e.i=e.i.concat(t)),s){case 1:Vn(n,5);break;case 4:Vn(n,10);break;case 3:Vn(n,6);break;default:Vn(n,2)}}function El(n,e){let t=n.Pa+Math.floor(Math.random()*n.$a);return n.j||(t*=2),t*e}function Vn(n,e){if(n.h.info("Error code "+e),2==e){var t=null;n.j&&(t=null);var i=le(n.jb,n);t||(t=new Un("//www.google.com/images/cleardot.gif"),B.location&&"http"==B.location.protocol||rr(t,"https"),cr(t)),function(n,e){const t=new Js;if(B.Image){const i=new Image;i.onload=Pt(lr,t,i,"TestLoadImage: loaded",!0,e),i.onerror=Pt(lr,t,i,"TestLoadImage: error",!1,e),i.onabort=Pt(lr,t,i,"TestLoadImage: abort",!1,e),i.ontimeout=Pt(lr,t,i,"TestLoadImage: timeout",!1,e),B.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n}else e(!1)}(t.toString(),i)}else Ge(2);n.G=0,n.j&&n.j.va(e),Il(n),yl(n)}function Il(n){n.G=0,n.I=-1,n.j&&((0!=cl(n.i).length||0!=n.l.length)&&(n.i.i.length=0,Fe(n.l),n.l.length=0),n.j.ua())}function Sl(n,e,t){let i=function(n){return n instanceof Un?Vt(n):new Un(n,void 0)}(t);if(""!=i.i)e&&or(i,e+"."+i.i),ar(i,i.m);else{const s=B.location;i=function(n,e,t,i){var s=new Un(null,void 0);return n&&rr(s,n),e&&or(s,e),t&&ar(s,t),i&&(s.l=i),s}(s.protocol,e?e+"."+s.hostname:s.hostname,+s.port,t)}return n.aa&&li(n.aa,function(s,r){oe(i,r,s)}),t=n.sa,(e=n.D)&&t&&oe(i,e,t),oe(i,"VER",n.ma),ms(n,i),i}function Dl(n,e,t){if(e&&!n.H)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new _e(t&&n.Ba&&!n.qa?new ds({ib:!0}):n.qa)).L=n.H,e}function xl(){}function gr(){if(ht&&!(10<=Number(Xi)))throw Error("Environmental error: no available transport.")}function et(n,e){Y.call(this),this.g=new ml(e),this.l=n,this.h=e&&e.messageUrlParams||null,n=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(n?n["X-Client-Protocol"]="webchannel":n={"X-Client-Protocol":"webchannel"}),this.g.s=n,n=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(n?n["X-WebChannel-Content-Type"]=e.messageContentType:n={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(n?n["X-WebChannel-Client-Profile"]=e.ya:n={"X-WebChannel-Client-Profile":e.ya}),this.g.P=n,(n=e&&e.httpHeadersOverwriteParam)&&!kt(n)&&(this.g.o=n),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!kt(e)&&(this.g.D=e,null!==(n=this.h)&&e in n&&e in(n=this.h)&&delete n[e]),this.j=new yi(this)}function Cl(n){uo.call(this);var e=n.__sm__;if(e){e:{for(const t in e){n=t;break e}n=void 0}(this.i=n)&&(n=this.i,e=null!==e&&n in e?e[n]:void 0),this.data=e}else this.data=n}function Al(){ho.call(this),this.status=1}function yi(n){this.g=n}(k=_e.prototype).ea=function(n,e,t,i){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+n);e=e?e.toUpperCase():"GET",this.H=n,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():fo.g(),this.C=function(n){return n.h||(n.h=n.i())}(this.u?this.u:fo),this.g.onreadystatechange=le(this.Fa,this);try{this.F=!0,this.g.open(e,String(n),!0),this.F=!1}catch(r){return void hl(this,r)}n=t||"";const s=new gi(this.headers);i&&yo(i,function(r,o){s.set(o,r)}),i=function(n){e:{var e=rf;const t=n.length,i="string"==typeof n?n.split(""):n;for(let s=0;s<t;s++)if(s in i&&e.call(void 0,i[s],s,n)){e=s;break e}e=-1}return 0>e?null:"string"==typeof n?n.charAt(e):n[e]}(s.T()),t=B.FormData&&n instanceof B.FormData,!(0<=In(nf,e))||i||t||s.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),s.forEach(function(r,o){this.g.setRequestHeader(o,r)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{pl(this),0<this.B&&((this.K=function(n){return ht&&Nn()&&"number"==typeof n.timeout&&void 0!==n.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=le(this.pa,this)):this.A=co(this.pa,this.B,this)),this.v=!0,this.g.send(n),this.v=!1}catch(r){hl(this,r)}},k.pa=function(){void 0!==Wt&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,te(this,"timeout"),this.abort(8))},k.abort=function(n){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=n||7,te(this,"complete"),te(this,"abort"),hr(this))},k.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),hr(this,!0)),_e.Z.M.call(this)},k.Fa=function(){this.s||(this.F||this.v||this.l?fl(this):this.cb())},k.cb=function(){fl(this)},k.ba=function(){try{return 2<Bt(this)?this.g.status:-1}catch(n){return-1}},k.ga=function(){try{return this.g?this.g.responseText:""}catch(n){return""}},k.Qa=function(n){if(this.g){var e=this.g.responseText;return n&&0==e.indexOf(n)&&(e=e.substring(n.length)),ef(e)}},k.Da=function(){return this.m},k.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(k=ml.prototype).ma=8,k.G=1,k.hb=function(n){try{this.h.info("Origin Trials invoked: "+n)}catch(e){}},k.Ha=function(n){if(this.m)if(this.m=null,1==this.G){if(!n){this.V=Math.floor(1e5*Math.random()),n=this.V++;const s=new os(this,this.h,n,void 0);let r=this.s;if(this.P&&(r?(r=yt(r),Cn(r,this.P)):r=this.P),null===this.o&&(s.H=r),this.ja)e:{for(var e=0,t=0;t<this.l.length;t++){var i=this.l[t];if(void 0===(i="__data__"in i.g&&"string"==typeof(i=i.g.__data__)?i.length:void 0))break;if(4096<(e+=i)){e=t;break e}if(4096===e||t===this.l.length-1){e=t+1;break e}}e=1e3}else e=1e3;e=vl(this,s,e),oe(t=Vt(this.F),"RID",n),oe(t,"CVER",22),this.D&&oe(t,"X-HTTP-Session-Id",this.D),ms(this,t),this.o&&r&&Eo(t,this.o,r),wo(this.i,s),this.Ra&&oe(t,"TYPE","init"),this.ja?(oe(t,"$req",e),oe(t,"SID","null"),s.$=!0,go(s,t,null)):go(s,t,e),this.G=2}}else 3==this.G&&(n?_l(this,n):0==this.l.length||rl(this.i)||_l(this))},k.Ga=function(){if(this.u=null,bl(this),this.$&&!(this.L||null==this.g||0>=this.O)){var n=2*this.O;this.h.info("BP detection timer enabled: "+n),this.B=ss(le(this.bb,this),n)}},k.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Ge(10),dr(this),bl(this))},k.ab=function(){null!=this.v&&(this.v=null,dr(this),Do(this),Ge(19))},k.jb=function(n){n?(this.h.info("Successfully pinged google.com"),Ge(2)):(this.h.info("Failed to ping google.com"),Ge(1))},(k=xl.prototype).xa=function(){},k.wa=function(){},k.va=function(){},k.ua=function(){},k.Oa=function(){},gr.prototype.g=function(n,e){return new et(n,e)},ge(et,Y),et.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var n=this.g,e=this.l,t=this.h||void 0;n.Wa&&(n.h.info("Origin Trials enabled."),so(le(n.hb,n,e))),Ge(0),n.W=e,n.aa=t||{},n.N=n.X,n.F=Sl(n,null,n.W),fr(n)},et.prototype.close=function(){Io(this.g)},et.prototype.u=function(n){if("string"==typeof n){var e={};e.__data__=n,So(this.g,e)}else this.v?((e={}).__data__=bt(n),So(this.g,e)):So(this.g,n)},et.prototype.M=function(){this.g.j=null,delete this.j,Io(this.g),delete this.g,et.Z.M.call(this)},ge(Cl,uo),ge(Al,ho),ge(yi,xl),yi.prototype.xa=function(){te(this.g,"a")},yi.prototype.wa=function(n){te(this.g,new Cl(n))},yi.prototype.va=function(n){te(this.g,new Al(n))},yi.prototype.ua=function(){te(this.g,"b")},gr.prototype.createWebChannel=gr.prototype.g,et.prototype.send=et.prototype.u,et.prototype.open=et.prototype.m,et.prototype.close=et.prototype.close,tr.NO_ERROR=0,tr.TIMEOUT=8,tr.HTTP_ERROR=6,jc.COMPLETE="complete",Zc.EventType=rs,rs.OPEN="a",rs.CLOSE="b",rs.ERROR="c",rs.MESSAGE="d",Y.prototype.listen=Y.prototype.N,_e.prototype.listenOnce=_e.prototype.O,_e.prototype.getLastError=_e.prototype.La,_e.prototype.getLastErrorCode=_e.prototype.Da,_e.prototype.getStatus=_e.prototype.ba,_e.prototype.getResponseJson=_e.prototype.Qa,_e.prototype.getResponseText=_e.prototype.ga,_e.prototype.send=_e.prototype.ea;var cf=qe.createWebChannelTransport=function(){return new gr},lf=qe.getStatEventTarget=function(){return er()},Co=qe.ErrorCode=tr,uf=qe.EventType=jc,hf=qe.Event=On,Rl=qe.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},df=qe.FetchXmlHttpFactory=ds,mr=qe.WebChannel=Zc,ff=qe.XhrIo=_e;const Pl="@firebase/firestore";class ke{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}ke.UNAUTHENTICATED=new ke(null),ke.GOOGLE_CREDENTIALS=new ke("google-credentials-uid"),ke.FIRST_PARTY=new ke("first-party-uid"),ke.MOCK_USER=new ke("mock-user");let _i="9.1.3";const sn=new De.Yd("@firebase/firestore");function Ao(){return sn.logLevel}function R(n,...e){if(sn.logLevel<=De.in.DEBUG){const t=e.map(Ro);sn.debug(`Firestore (${_i}): ${n}`,...t)}}function ve(n,...e){if(sn.logLevel<=De.in.ERROR){const t=e.map(Ro);sn.error(`Firestore (${_i}): ${n}`,...t)}}function ys(n,...e){if(sn.logLevel<=De.in.WARN){const t=e.map(Ro);sn.warn(`Firestore (${_i}): ${n}`,...t)}}function Ro(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch(t){return n}}function M(n="Unexpected state"){const e=`FIRESTORE (${_i}) INTERNAL ASSERTION FAILED: `+n;throw ve(e),new Error(e)}function z(n,e){n||M()}function N(n,e){return n}const T={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class A extends Error{constructor(e,t){super(t),this.code=e,this.message=t,this.name="FirebaseError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class xe{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class Nl{constructor(e,t){this.user=t,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization=`Bearer ${e}`}}class mf{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(ke.UNAUTHENTICATED))}shutdown(){}}class yf{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class _f{constructor(e){this.t=e,this.currentUser=ke.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var i=this;let s=this.i;const r=d=>this.i!==s?(s=this.i,t(d)):Promise.resolve();let o=new xe;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new xe,e.enqueueRetryable(()=>r(this.currentUser))};const l=()=>{const d=o;e.enqueueRetryable((0,S.Z)(function*(){yield d.promise,yield r(i.currentUser)}))},u=d=>{R("FirebaseCredentialsProvider","Auth detected"),this.auth=d,this.auth.addAuthTokenListener(this.o),l()};this.t.onInit(d=>u(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?u(d):(R("FirebaseCredentialsProvider","Auth not yet detected"),o.resolve(),o=new xe)}},0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(i=>this.i!==e?(R("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(z("string"==typeof i.accessToken),new Nl(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return z(null===e||"string"==typeof e),new ke(e)}}class vf{constructor(e,t,i){this.h=e,this.l=t,this.m=i,this.type="FirstParty",this.user=ke.FIRST_PARTY}get authHeaders(){const e={"X-Goog-AuthUser":this.l},t=this.h.auth.getAuthHeaderValueForFirstParty([]);return t&&(e.Authorization=t),this.m&&(e["X-Goog-Iam-Authorization-Token"]=this.m),e}}class wf{constructor(e,t,i){this.h=e,this.l=t,this.m=i}getToken(){return Promise.resolve(new vf(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(ke.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class tt{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=i=>this.g(i),this.p=i=>t.writeSequenceNumber(i))}g(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.p&&this.p(e),e}}function bf(n){const e="undefined"!=typeof self&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let i=0;i<n;i++)t[i]=Math.floor(256*Math.random());return t}tt.T=-1;class kl{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let i="";for(;i.length<20;){const s=bf(40);for(let r=0;r<s.length;++r)i.length<20&&s[r]<t&&(i+=e.charAt(s[r]%e.length))}return i}}function H(n,e){return n<e?-1:n>e?1:0}function vi(n,e,t){return n.length===e.length&&n.every((i,s)=>t(i,e[s]))}function Ll(n){return n+"\0"}class Ce{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new A(T.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new A(T.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new A(T.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new A(T.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Ce.fromMillis(Date.now())}static fromDate(e){return Ce.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),i=Math.floor(1e6*(e-1e3*t));return new Ce(t,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?H(this.nanoseconds,e.nanoseconds):H(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class K{constructor(e){this.timestamp=e}static fromTimestamp(e){return new K(e)}static min(){return new K(new Ce(0,0))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function Ol(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Bn(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Ml(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class _s{constructor(e,t,i){void 0===t?t=0:t>e.length&&M(),void 0===i?i=e.length-t:i>e.length-t&&M(),this.segments=e,this.offset=t,this.len=i}get length(){return this.len}isEqual(e){return 0===_s.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof _s?e.forEach(i=>{t.push(i)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,i=this.limit();t<i;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const i=Math.min(e.length,t.length);for(let s=0;s<i;s++){const r=e.get(s),o=t.get(s);if(r<o)return-1;if(r>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class X extends _s{construct(e,t,i){return new X(e,t,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const i of e){if(i.indexOf("//")>=0)throw new A(T.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);t.push(...i.split("/").filter(s=>s.length>0))}return new X(t)}static emptyPath(){return new X([])}}const Tf=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Le extends _s{construct(e,t,i){return new Le(e,t,i)}static isValidIdentifier(e){return Tf.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Le.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Le(["__name__"])}static fromServerFormat(e){const t=[];let i="",s=0;const r=()=>{if(0===i.length)throw new A(T.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(i),i=""};let o=!1;for(;s<e.length;){const l=e[s];if("\\"===l){if(s+1===e.length)throw new A(T.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new A(T.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);i+=u,s+=2}else"`"===l?(o=!o,s++):"."!==l||o?(i+=l,s++):(r(),s++)}if(r(),o)throw new A(T.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Le(t)}static emptyPath(){return new Le([])}}class wi{constructor(e){this.fields=e,e.sort(Le.comparator)}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return vi(this.fields,e.fields,(t,i)=>t.isEqual(i))}}class Ae{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new Ae(t)}static fromUint8Array(e){const t=function(i){let s="";for(let r=0;r<i.length;++r)s+=String.fromCharCode(i[r]);return s}(e);return new Ae(t)}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return H(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ae.EMPTY_BYTE_STRING=new Ae("");const If=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function rn(n){if(z(!!n),"string"==typeof n){let e=0;const t=If.exec(n);if(z(!!t),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:e}}return{seconds:we(n.seconds),nanos:we(n.nanos)}}function we(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function bi(n){return"string"==typeof n?Ae.fromBase64String(n):Ae.fromUint8Array(n)}function Po(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=null==n?void 0:n.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Fl(n){const e=n.mapValue.fields.__previous_value__;return Po(e)?Fl(e):e}function vs(n){const e=rn(n.mapValue.fields.__local_write_time__.timestampValue);return new Ce(e.seconds,e.nanos)}function qn(n){return null==n}function yr(n){return 0===n&&1/n==-1/0}function Ul(n){return"number"==typeof n&&Number.isInteger(n)&&!yr(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}class O{constructor(e){this.path=e}static fromPath(e){return new O(X.fromString(e))}static fromName(e){return new O(X.fromString(e).popFirst(5))}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}isEqual(e){return null!==e&&0===X.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return X.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new O(new X(e.slice()))}}function Gn(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Po(n)?4:10:M()}function Tt(n,e){const t=Gn(n);if(t!==Gn(e))return!1;switch(t){case 0:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return vs(n).isEqual(vs(e));case 3:return function(i,s){if("string"==typeof i.timestampValue&&"string"==typeof s.timestampValue&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const r=rn(i.timestampValue),o=rn(s.timestampValue);return r.seconds===o.seconds&&r.nanos===o.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return s=e,bi(n.bytesValue).isEqual(bi(s.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return we(i.geoPointValue.latitude)===we(s.geoPointValue.latitude)&&we(i.geoPointValue.longitude)===we(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return we(i.integerValue)===we(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const r=we(i.doubleValue),o=we(s.doubleValue);return r===o?yr(r)===yr(o):isNaN(r)&&isNaN(o)}return!1}(n,e);case 9:return vi(n.arrayValue.values||[],e.arrayValue.values||[],Tt);case 10:return function(i,s){const r=i.mapValue.fields||{},o=s.mapValue.fields||{};if(Ol(r)!==Ol(o))return!1;for(const l in r)if(r.hasOwnProperty(l)&&(void 0===o[l]||!Tt(r[l],o[l])))return!1;return!0}(n,e);default:return M()}var s}function ws(n,e){return void 0!==(n.values||[]).find(t=>Tt(t,e))}function Ti(n,e){const t=Gn(n),i=Gn(e);if(t!==i)return H(t,i);switch(t){case 0:return 0;case 1:return H(n.booleanValue,e.booleanValue);case 2:return function(s,r){const o=we(s.integerValue||s.doubleValue),l=we(r.integerValue||r.doubleValue);return o<l?-1:o>l?1:o===l?0:isNaN(o)?isNaN(l)?0:-1:1}(n,e);case 3:return Vl(n.timestampValue,e.timestampValue);case 4:return Vl(vs(n),vs(e));case 5:return H(n.stringValue,e.stringValue);case 6:return function(s,r){const o=bi(s),l=bi(r);return o.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,r){const o=s.split("/"),l=r.split("/");for(let u=0;u<o.length&&u<l.length;u++){const d=H(o[u],l[u]);if(0!==d)return d}return H(o.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,r){const o=H(we(s.latitude),we(r.latitude));return 0!==o?o:H(we(s.longitude),we(r.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return function(s,r){const o=s.values||[],l=r.values||[];for(let u=0;u<o.length&&u<l.length;++u){const d=Ti(o[u],l[u]);if(d)return d}return H(o.length,l.length)}(n.arrayValue,e.arrayValue);case 10:return function(s,r){const o=s.fields||{},l=Object.keys(o),u=r.fields||{},d=Object.keys(u);l.sort(),d.sort();for(let g=0;g<l.length&&g<d.length;++g){const _=H(l[g],d[g]);if(0!==_)return _;const E=Ti(o[l[g]],u[d[g]]);if(0!==E)return E}return H(l.length,d.length)}(n.mapValue,e.mapValue);default:throw M()}}function Vl(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return H(n,e);const t=rn(n),i=rn(e),s=H(t.seconds,i.seconds);return 0!==s?s:H(t.nanos,i.nanos)}function No(n){return ko(n)}function ko(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(i){const s=rn(i);return`time(${s.seconds},${s.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?bi(n.bytesValue).toBase64():"referenceValue"in n?O.fromName(n.referenceValue).toString():"geoPointValue"in n?`geo(${(e=n.geoPointValue).latitude},${e.longitude})`:"arrayValue"in n?function(i){let s="[",r=!0;for(const o of i.values||[])r?r=!1:s+=",",s+=ko(o);return s+"]"}(n.arrayValue):"mapValue"in n?function(i){const s=Object.keys(i.fields||{}).sort();let r="{",o=!0;for(const l of s)o?o=!1:r+=",",r+=`${l}:${ko(i.fields[l])}`;return r+"}"}(n.mapValue):M();var e}function _r(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Lo(n){return!!n&&"integerValue"in n}function Oo(n){return!!n&&"arrayValue"in n}function Bl(n){return!!n&&"nullValue"in n}function ql(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function vr(n){return!!n&&"mapValue"in n}function bs(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Bn(n.mapValue.fields,(t,i)=>e.mapValue.fields[t]=bs(i)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=bs(n.arrayValue.values[t]);return e}return Object.assign({},n)}class Ue{constructor(e){this.value=e}static empty(){return new Ue({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let i=0;i<e.length-1;++i)if(t=(t.mapValue.fields||{})[e.get(i)],!vr(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=bs(t)}setAll(e){let t=Le.emptyPath(),i={},s=[];e.forEach((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,i,s),i={},s=[],t=l.popLast()}o?i[l.lastSegment()]=bs(o):s.push(l.lastSegment())});const r=this.getFieldsMap(t);this.applyChanges(r,i,s)}delete(e){const t=this.field(e.popLast());vr(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Tt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let i=0;i<e.length;++i){let s=t.mapValue.fields[e.get(i)];vr(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(i)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,i){Bn(t,(s,r)=>e[s]=r);for(const s of i)delete e[s]}clone(){return new Ue(bs(this.value))}}function Gl(n){const e=[];return Bn(n.fields,(t,i)=>{const s=new Le([t]);if(vr(i)){const r=Gl(i.mapValue).fields;if(0===r.length)e.push(s);else for(const o of r)e.push(s.child(o))}else e.push(s)}),new wi(e)}class ae{constructor(e,t,i,s,r){this.key=e,this.documentType=t,this.version=i,this.data=s,this.documentState=r}static newInvalidDocument(e){return new ae(e,0,K.min(),Ue.empty(),0)}static newFoundDocument(e,t,i){return new ae(e,1,t,i,0)}static newNoDocument(e,t){return new ae(e,2,t,Ue.empty(),0)}static newUnknownDocument(e,t){return new ae(e,3,t,Ue.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ue.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ue.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof ae&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}clone(){return new ae(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Sf{constructor(e,t=null,i=[],s=[],r=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=i,this.filters=s,this.limit=r,this.startAt=o,this.endAt=l,this.A=null}}function zl(n,e=null,t=[],i=[],s=null,r=null,o=null){return new Sf(n,e,t,i,s,r,o)}function Ts(n){const e=N(n);if(null===e.A){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(i=>function(n){return n.field.canonicalString()+n.op.toString()+No(n.value)}(i)).join(","),t+="|ob:",t+=e.orderBy.map(i=>{return(s=i).field.canonicalString()+s.dir;var s}).join(","),qn(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Tr(e.startAt)),e.endAt&&(t+="|ub:",t+=Tr(e.endAt)),e.A=t}return e.A}function wr(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let s=0;s<n.orderBy.length;s++)if(!Of(n.orderBy[s],e.orderBy[s]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let s=0;s<n.filters.length;s++)if((t=n.filters[s]).op!==(i=e.filters[s]).op||!t.field.isEqual(i.field)||!Tt(t.value,i.value))return!1;var t,i;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Zl(n.startAt,e.startAt)&&Zl(n.endAt,e.endAt)}function br(n){return O.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}class ze extends class{}{constructor(e,t,i){super(),this.field=e,this.op=t,this.value=i}static create(e,t,i){return e.isKeyField()?"in"===t||"not-in"===t?this.R(e,t,i):new Cf(e,t,i):"array-contains"===t?new Pf(e,i):"in"===t?new Nf(e,i):"not-in"===t?new kf(e,i):"array-contains-any"===t?new Lf(e,i):new ze(e,t,i)}static R(e,t,i){return"in"===t?new Af(e,i):new Rf(e,i)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.P(Ti(t,this.value)):null!==t&&Gn(this.value)===Gn(t)&&this.P(Ti(t,this.value))}P(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return M()}}v(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Cf extends ze{constructor(e,t,i){super(e,t,i),this.key=O.fromName(i.referenceValue)}matches(e){const t=O.comparator(e.key,this.key);return this.P(t)}}class Af extends ze{constructor(e,t){super(e,"in",t),this.keys=jl(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Rf extends ze{constructor(e,t){super(e,"not-in",t),this.keys=jl(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function jl(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(i=>O.fromName(i.referenceValue))}class Pf extends ze{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Oo(t)&&ws(t.arrayValue,this.value)}}class Nf extends ze{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&ws(this.value.arrayValue,t)}}class kf extends ze{constructor(e,t){super(e,"not-in",t)}matches(e){if(ws(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!ws(this.value.arrayValue,t)}}class Lf extends ze{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Oo(t)||!t.arrayValue.values)&&t.arrayValue.values.some(i=>ws(this.value.arrayValue,i))}}class Es{constructor(e,t){this.position=e,this.before=t}}function Tr(n){return`${n.before?"b":"a"}:${n.position.map(e=>No(e)).join(",")}`}class Ei{constructor(e,t="asc"){this.field=e,this.dir=t}}function Of(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}function Kl(n,e,t){let i=0;for(let s=0;s<n.position.length;s++){const r=e[s],o=n.position[s];if(i=r.field.isKeyField()?O.comparator(O.fromName(o.referenceValue),t.key):Ti(o,t.data.field(r.field)),"desc"===r.dir&&(i*=-1),0!==i)break}return n.before?i<=0:i<0}function Zl(n,e){if(null===n)return null===e;if(null===e||n.before!==e.before||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Tt(n.position[t],e.position[t]))return!1;return!0}class qt{constructor(e,t=null,i=[],s=[],r=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=i,this.filters=s,this.limit=r,this.limitType=o,this.startAt=l,this.endAt=u,this.V=null,this.S=null}}function $l(n,e,t,i,s,r,o,l){return new qt(n,e,t,i,s,r,o,l)}function Ii(n){return new qt(n)}function Er(n){return!qn(n.limit)&&"F"===n.limitType}function Ir(n){return!qn(n.limit)&&"L"===n.limitType}function Mo(n){return n.explicitOrderBy.length>0?n.explicitOrderBy[0].field:null}function Fo(n){for(const e of n.filters)if(e.v())return e.field;return null}function Uo(n){return null!==n.collectionGroup}function Si(n){const e=N(n);if(null===e.V){e.V=[];const t=Fo(e),i=Mo(e);if(null!==t&&null===i)t.isKeyField()||e.V.push(new Ei(t)),e.V.push(new Ei(Le.keyField(),"asc"));else{let s=!1;for(const r of e.explicitOrderBy)e.V.push(r),r.field.isKeyField()&&(s=!0);if(!s){const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.V.push(new Ei(Le.keyField(),r))}}}return e.V}function at(n){const e=N(n);if(!e.S)if("F"===e.limitType)e.S=zl(e.path,e.collectionGroup,Si(e),e.filters,e.limit,e.startAt,e.endAt);else{const t=[];for(const r of Si(e))t.push(new Ei(r.field,"desc"===r.dir?"asc":"desc"));const i=e.endAt?new Es(e.endAt.position,!e.endAt.before):null,s=e.startAt?new Es(e.startAt.position,!e.startAt.before):null;e.S=zl(e.path,e.collectionGroup,t,e.filters,e.limit,i,s)}return e.S}function Hl(n,e,t){return new qt(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Is(n,e){return wr(at(n),at(e))&&n.limitType===e.limitType}function Yl(n){return`${Ts(at(n))}|lt:${n.limitType}`}function Vo(n){return`Query(target=${function(n){let e=n.path.canonicalString();return null!==n.collectionGroup&&(e+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(e+=`, filters: [${n.filters.map(t=>{return`${(i=t).field.canonicalString()} ${i.op} ${No(i.value)}`;var i}).join(", ")}]`),qn(n.limit)||(e+=", limit: "+n.limit),n.orderBy.length>0&&(e+=`, orderBy: [${n.orderBy.map(t=>{return`${(i=t).field.canonicalString()} (${i.dir})`;var i}).join(", ")}]`),n.startAt&&(e+=", startAt: "+Tr(n.startAt)),n.endAt&&(e+=", endAt: "+Tr(n.endAt)),`Target(${e})`}(at(n))}; limitType=${n.limitType})`}function Ss(n,e){return e.isFoundDocument()&&function(t,i){const s=i.key.path;return null!==t.collectionGroup?i.key.hasCollectionId(t.collectionGroup)&&t.path.isPrefixOf(s):O.isDocumentKey(t.path)?t.path.isEqual(s):t.path.isImmediateParentOf(s)}(n,e)&&function(t,i){for(const s of t.explicitOrderBy)if(!s.field.isKeyField()&&null===i.data.field(s.field))return!1;return!0}(n,e)&&function(t,i){for(const s of t.filters)if(!s.matches(i))return!1;return!0}(n,e)&&(i=e,!((t=n).startAt&&!Kl(t.startAt,Si(t),i)||t.endAt&&Kl(t.endAt,Si(t),i)));var t,i}function Ql(n){return(e,t)=>{let i=!1;for(const s of Si(n)){const r=Mf(s,e,t);if(0!==r)return r;i=i||s.field.isKeyField()}return 0}}function Mf(n,e,t){const i=n.field.isKeyField()?O.comparator(e.key,t.key):function(s,r,o){const l=r.data.field(s),u=o.data.field(s);return null!==l&&null!==u?Ti(l,u):M()}(n.field,e,t);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return M()}}function Wl(n,e){if(n.D){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yr(e)?"-0":e}}function Xl(n){return{integerValue:""+n}}function Jl(n,e){return Ul(e)?Xl(e):Wl(n,e)}class Sr{constructor(){this._=void 0}}function Ff(n,e,t){return n instanceof Di?function(i,s){const r={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&(r.fields.__previous_value__=s),{mapValue:r}}(t,e):n instanceof zn?tu(n,e):n instanceof jn?nu(n,e):function(i,s){const r=eu(i,s),o=iu(r)+iu(i.C);return Lo(r)&&Lo(i.C)?Xl(o):Wl(i.N,o)}(n,e)}function Uf(n,e,t){return n instanceof zn?tu(n,e):n instanceof jn?nu(n,e):t}function eu(n,e){return n instanceof xi?Lo(t=e)||(i=t)&&"doubleValue"in i?e:{integerValue:0}:null;var i,t}class Di extends Sr{}class zn extends Sr{constructor(e){super(),this.elements=e}}function tu(n,e){const t=su(e);for(const i of n.elements)t.some(s=>Tt(s,i))||t.push(i);return{arrayValue:{values:t}}}class jn extends Sr{constructor(e){super(),this.elements=e}}function nu(n,e){let t=su(e);for(const i of n.elements)t=t.filter(s=>!Tt(s,i));return{arrayValue:{values:t}}}class xi extends Sr{constructor(e,t){super(),this.N=e,this.C=t}}function iu(n){return we(n.integerValue||n.doubleValue)}function su(n){return Oo(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Ds{constructor(e,t){this.field=e,this.transform=t}}class Bf{constructor(e,t){this.version=e,this.transformResults=t}}class be{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new be}static exists(e){return new be(void 0,e)}static updateTime(e){return new be(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Dr(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class xr{}function qf(n,e,t){n instanceof xs?function(i,s,r){const o=i.value.clone(),l=cu(i.fieldTransforms,s,r.transformResults);o.setAll(l),s.convertToFoundDocument(r.version,o).setHasCommittedMutations()}(n,e,t):n instanceof on?function(i,s,r){if(!Dr(i.precondition,s))return void s.convertToUnknownDocument(r.version);const o=cu(i.fieldTransforms,s,r.transformResults),l=s.data;l.setAll(au(i)),l.setAll(o),s.convertToFoundDocument(r.version,l).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function Bo(n,e,t){var s;n instanceof xs?function(i,s,r){if(!Dr(i.precondition,s))return;const o=i.value.clone(),l=lu(i.fieldTransforms,r,s);o.setAll(l),s.convertToFoundDocument(ou(s),o).setHasLocalMutations()}(n,e,t):n instanceof on?function(i,s,r){if(!Dr(i.precondition,s))return;const o=lu(i.fieldTransforms,r,s),l=s.data;l.setAll(au(i)),l.setAll(o),s.convertToFoundDocument(ou(s),l).setHasLocalMutations()}(n,e,t):Dr(n.precondition,s=e)&&s.convertToNoDocument(K.min())}function Gf(n,e){let t=null;for(const i of n.fieldTransforms){const s=e.data.field(i.field),r=eu(i.transform,s||null);null!=r&&(null==t&&(t=Ue.empty()),t.set(i.field,r))}return t||null}function ru(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(t=n.fieldTransforms)&&void 0===i||t&&i&&vi(t,i,(s,r)=>function(n,e){return n.field.isEqual(e.field)&&(i=e.transform,(t=n.transform)instanceof zn&&i instanceof zn||t instanceof jn&&i instanceof jn?vi(t.elements,i.elements,Tt):t instanceof xi&&i instanceof xi?Tt(t.C,i.C):t instanceof Di&&i instanceof Di);var t,i}(s,r))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var t,i}function ou(n){return n.isFoundDocument()?n.version:K.min()}class xs extends xr{constructor(e,t,i,s=[]){super(),this.key=e,this.value=t,this.precondition=i,this.fieldTransforms=s,this.type=0}}class on extends xr{constructor(e,t,i,s,r=[]){super(),this.key=e,this.data=t,this.fieldMask=i,this.precondition=s,this.fieldTransforms=r,this.type=1}}function au(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const i=n.data.field(t);e.set(t,i)}}),e}function cu(n,e,t){const i=new Map;z(n.length===t.length);for(let s=0;s<t.length;s++){const r=n[s],o=r.transform,l=e.data.field(r.field);i.set(r.field,Uf(o,l,t[s]))}return i}function lu(n,e,t){const i=new Map;for(const s of n){const r=s.transform,o=t.data.field(s.field);i.set(s.field,Ff(r,o,e))}return i}class Cs extends xr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}}class qo extends xr{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}}class zf{constructor(e){this.count=e}}var Te,Q;function uu(n){switch(n){default:return M();case T.CANCELLED:case T.UNKNOWN:case T.DEADLINE_EXCEEDED:case T.RESOURCE_EXHAUSTED:case T.INTERNAL:case T.UNAVAILABLE:case T.UNAUTHENTICATED:return!1;case T.INVALID_ARGUMENT:case T.NOT_FOUND:case T.ALREADY_EXISTS:case T.PERMISSION_DENIED:case T.FAILED_PRECONDITION:case T.ABORTED:case T.OUT_OF_RANGE:case T.UNIMPLEMENTED:case T.DATA_LOSS:return!0}}function hu(n){if(void 0===n)return ve("GRPC error has no .code"),T.UNKNOWN;switch(n){case Te.OK:return T.OK;case Te.CANCELLED:return T.CANCELLED;case Te.UNKNOWN:return T.UNKNOWN;case Te.DEADLINE_EXCEEDED:return T.DEADLINE_EXCEEDED;case Te.RESOURCE_EXHAUSTED:return T.RESOURCE_EXHAUSTED;case Te.INTERNAL:return T.INTERNAL;case Te.UNAVAILABLE:return T.UNAVAILABLE;case Te.UNAUTHENTICATED:return T.UNAUTHENTICATED;case Te.INVALID_ARGUMENT:return T.INVALID_ARGUMENT;case Te.NOT_FOUND:return T.NOT_FOUND;case Te.ALREADY_EXISTS:return T.ALREADY_EXISTS;case Te.PERMISSION_DENIED:return T.PERMISSION_DENIED;case Te.FAILED_PRECONDITION:return T.FAILED_PRECONDITION;case Te.ABORTED:return T.ABORTED;case Te.OUT_OF_RANGE:return T.OUT_OF_RANGE;case Te.UNIMPLEMENTED:return T.UNIMPLEMENTED;case Te.DATA_LOSS:return T.DATA_LOSS;default:return M()}}(Q=Te||(Te={}))[Q.OK=0]="OK",Q[Q.CANCELLED=1]="CANCELLED",Q[Q.UNKNOWN=2]="UNKNOWN",Q[Q.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Q[Q.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Q[Q.NOT_FOUND=5]="NOT_FOUND",Q[Q.ALREADY_EXISTS=6]="ALREADY_EXISTS",Q[Q.PERMISSION_DENIED=7]="PERMISSION_DENIED",Q[Q.UNAUTHENTICATED=16]="UNAUTHENTICATED",Q[Q.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Q[Q.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Q[Q.ABORTED=10]="ABORTED",Q[Q.OUT_OF_RANGE=11]="OUT_OF_RANGE",Q[Q.UNIMPLEMENTED=12]="UNIMPLEMENTED",Q[Q.INTERNAL=13]="INTERNAL",Q[Q.UNAVAILABLE=14]="UNAVAILABLE",Q[Q.DATA_LOSS=15]="DATA_LOSS";class Ie{constructor(e,t){this.comparator=e,this.root=t||Oe.EMPTY}insert(e,t){return new Ie(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Oe.BLACK,null,null))}remove(e){return new Ie(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Oe.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const i=this.comparator(e,t.key);if(0===i)return t.value;i<0?t=t.left:i>0&&(t=t.right)}return null}indexOf(e){let t=0,i=this.root;for(;!i.isEmpty();){const s=this.comparator(e,i.key);if(0===s)return t+i.left.size;s<0?i=i.left:(t+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,i)=>(e(t,i),!1))}toString(){const e=[];return this.inorderTraversal((t,i)=>(e.push(`${t}:${i}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Cr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Cr(this.root,e,this.comparator,!1)}getReverseIterator(){return new Cr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Cr(this.root,e,this.comparator,!0)}}class Cr{constructor(e,t,i,s){this.isReverse=s,this.nodeStack=[];let r=1;for(;!e.isEmpty();)if(r=t?i(e.key,t):1,s&&(r*=-1),r<0)e=this.isReverse?e.left:e.right;else{if(0===r){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Oe{constructor(e,t,i,s,r){this.key=e,this.value=t,this.color=null!=i?i:Oe.RED,this.left=null!=s?s:Oe.EMPTY,this.right=null!=r?r:Oe.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,i,s,r){return new Oe(null!=e?e:this.key,null!=t?t:this.value,null!=i?i:this.color,null!=s?s:this.left,null!=r?r:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,i){let s=this;const r=i(e,s.key);return s=r<0?s.copy(null,null,null,s.left.insert(e,t,i),null):0===r?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,i)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Oe.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let i,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),0===t(e,s.key)){if(s.right.isEmpty())return Oe.EMPTY;i=s.right.min(),s=s.copy(i.key,i.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Oe.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Oe.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw M();const e=this.left.check();if(e!==this.right.check())throw M();return e+(this.isRed()?0:1)}}Oe.EMPTY=null,Oe.RED=!0,Oe.BLACK=!1,Oe.EMPTY=new class{constructor(){this.size=0}get key(){throw M()}get value(){throw M()}get color(){throw M()}get left(){throw M()}get right(){throw M()}copy(n,e,t,i,s){return this}insert(n,e,t){return new Oe(n,e)}remove(n,e){return this}isEmpty(){return!0}inorderTraversal(n){return!1}reverseTraversal(n){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ue{constructor(e){this.comparator=e,this.data=new Ie(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,i)=>(e(t),!1))}forEachInRange(e,t){const i=this.data.getIteratorFrom(e[0]);for(;i.hasNext();){const s=i.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let i;for(i=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();i.hasNext();)if(!e(i.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new du(this.data.getIterator())}getIteratorFrom(e){return new du(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(i=>{t=t.add(i)}),t}isEqual(e){if(!(e instanceof ue)||this.size!==e.size)return!1;const t=this.data.getIterator(),i=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,r=i.getNext().key;if(0!==this.comparator(s,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new ue(this.comparator);return t.data=e,t}}class du{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}const jf=new Ie(O.comparator);function ct(){return jf}const Kf=new Ie(O.comparator);function Go(){return Kf}const Zf=new Ie(O.comparator);function fu(){return Zf}const $f=new ue(O.comparator);function ee(...n){let e=$f;for(const t of n)e=e.add(t);return e}const Hf=new ue(H);function Ar(){return Hf}class As{constructor(e,t,i,s,r){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=i,this.documentUpdates=s,this.resolvedLimboDocuments=r}static createSynthesizedRemoteEventForCurrentChange(e,t){const i=new Map;return i.set(e,Rs.createSynthesizedTargetChangeForCurrentChange(e,t)),new As(K.min(),i,Ar(),ct(),ee())}}class Rs{constructor(e,t,i,s,r){this.resumeToken=e,this.current=t,this.addedDocuments=i,this.modifiedDocuments=s,this.removedDocuments=r}static createSynthesizedTargetChangeForCurrentChange(e,t){return new Rs(Ae.EMPTY_BYTE_STRING,t,ee(),ee(),ee())}}class Rr{constructor(e,t,i,s){this.k=e,this.removedTargetIds=t,this.key=i,this.$=s}}class pu{constructor(e,t){this.targetId=e,this.O=t}}class gu{constructor(e,t,i=Ae.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=i,this.cause=s}}class mu{constructor(){this.F=0,this.M=_u(),this.L=Ae.EMPTY_BYTE_STRING,this.B=!1,this.U=!0}get current(){return this.B}get resumeToken(){return this.L}get q(){return 0!==this.F}get K(){return this.U}j(e){e.approximateByteSize()>0&&(this.U=!0,this.L=e)}W(){let e=ee(),t=ee(),i=ee();return this.M.forEach((s,r)=>{switch(r){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:i=i.add(s);break;default:M()}}),new Rs(this.L,this.B,e,t,i)}G(){this.U=!1,this.M=_u()}H(e,t){this.U=!0,this.M=this.M.insert(e,t)}J(e){this.U=!0,this.M=this.M.remove(e)}Y(){this.F+=1}X(){this.F-=1}Z(){this.U=!0,this.B=!0}}class Yf{constructor(e){this.tt=e,this.et=new Map,this.nt=ct(),this.st=yu(),this.it=new ue(H)}rt(e){for(const t of e.k)e.$&&e.$.isFoundDocument()?this.ot(t,e.$):this.at(t,e.key,e.$);for(const t of e.removedTargetIds)this.at(t,e.key,e.$)}ct(e){this.forEachTarget(e,t=>{const i=this.ut(t);switch(e.state){case 0:this.ht(t)&&i.j(e.resumeToken);break;case 1:i.X(),i.q||i.G(),i.j(e.resumeToken);break;case 2:i.X(),i.q||this.removeTarget(t);break;case 3:this.ht(t)&&(i.Z(),i.j(e.resumeToken));break;case 4:this.ht(t)&&(this.lt(t),i.j(e.resumeToken));break;default:M()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.et.forEach((i,s)=>{this.ht(s)&&t(s)})}ft(e){const t=e.targetId,i=e.O.count,s=this.dt(t);if(s){const r=s.target;if(br(r))if(0===i){const o=new O(r.path);this.at(t,o,ae.newNoDocument(o,K.min()))}else z(1===i);else this.wt(t)!==i&&(this.lt(t),this.it=this.it.add(t))}}_t(e){const t=new Map;this.et.forEach((r,o)=>{const l=this.dt(o);if(l){if(r.current&&br(l.target)){const u=new O(l.target.path);null!==this.nt.get(u)||this.gt(o,u)||this.at(o,u,ae.newNoDocument(u,e))}r.K&&(t.set(o,r.W()),r.G())}});let i=ee();this.st.forEach((r,o)=>{let l=!0;o.forEachWhile(u=>{const d=this.dt(u);return!d||2===d.purpose||(l=!1,!1)}),l&&(i=i.add(r))});const s=new As(e,t,this.it,this.nt,i);return this.nt=ct(),this.st=yu(),this.it=new ue(H),s}ot(e,t){if(!this.ht(e))return;const i=this.gt(e,t.key)?2:0;this.ut(e).H(t.key,i),this.nt=this.nt.insert(t.key,t),this.st=this.st.insert(t.key,this.yt(t.key).add(e))}at(e,t,i){if(!this.ht(e))return;const s=this.ut(e);this.gt(e,t)?s.H(t,1):s.J(t),this.st=this.st.insert(t,this.yt(t).delete(e)),i&&(this.nt=this.nt.insert(t,i))}removeTarget(e){this.et.delete(e)}wt(e){const t=this.ut(e).W();return this.tt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Y(e){this.ut(e).Y()}ut(e){let t=this.et.get(e);return t||(t=new mu,this.et.set(e,t)),t}yt(e){let t=this.st.get(e);return t||(t=new ue(H),this.st=this.st.insert(e,t)),t}ht(e){const t=null!==this.dt(e);return t||R("WatchChangeAggregator","Detected inactive target",e),t}dt(e){const t=this.et.get(e);return t&&t.q?null:this.tt.Tt(e)}lt(e){this.et.set(e,new mu),this.tt.getRemoteKeysForTarget(e).forEach(t=>{this.at(e,t,null)})}gt(e,t){return this.tt.getRemoteKeysForTarget(e).has(t)}}function yu(){return new Ie(O.comparator)}function _u(){return new Ie(O.comparator)}const Qf={asc:"ASCENDING",desc:"DESCENDING"},Wf={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class Xf{constructor(e,t){this.databaseId=e,this.D=t}}function Ps(n,e){return n.D?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function vu(n,e){return n.D?e.toBase64():e.toUint8Array()}function Jf(n,e){return Ps(n,e.toTimestamp())}function Re(n){return z(!!n),K.fromTimestamp(function(e){const t=rn(e);return new Ce(t.seconds,t.nanos)}(n))}function zo(n,e){return(t=n,new X(["projects",t.projectId,"databases",t.database])).child("documents").child(e).canonicalString();var t}function wu(n){const e=X.fromString(n);return z(Nu(e)),e}function Ns(n,e){return zo(n.databaseId,e.path)}function Et(n,e){const t=wu(e);if(t.get(1)!==n.databaseId.projectId)throw new A(T.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new A(T.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new O(Tu(t))}function jo(n,e){return zo(n.databaseId,e)}function bu(n){const e=wu(n);return 4===e.length?X.emptyPath():Tu(e)}function ks(n){return new X(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Tu(n){return z(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function Eu(n,e,t){return{name:Ns(n,e),fields:t.value.mapValue.fields}}function Iu(n,e,t){const i=Et(n,e.name),s=Re(e.updateTime),r=new Ue({mapValue:{fields:e.fields}}),o=ae.newFoundDocument(i,s,r);return t&&o.setHasCommittedMutations(),t?o.setHasCommittedMutations():o}function Pr(n,e){let t;if(e instanceof xs)t={update:Eu(n,e.key,e.value)};else if(e instanceof Cs)t={delete:Ns(n,e.key)};else if(e instanceof on)t={update:Eu(n,e.key,e.data),updateMask:cp(e.fieldMask)};else{if(!(e instanceof qo))return M();t={verify:Ns(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(i=>function(s,r){const o=r.transform;if(o instanceof Di)return{fieldPath:r.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(o instanceof zn)return{fieldPath:r.field.canonicalString(),appendMissingElements:{values:o.elements}};if(o instanceof jn)return{fieldPath:r.field.canonicalString(),removeAllFromArray:{values:o.elements}};if(o instanceof xi)return{fieldPath:r.field.canonicalString(),increment:o.C};throw M()}(0,i))),e.precondition.isNone||(t.currentDocument=void 0!==(s=e.precondition).updateTime?{updateTime:Jf(n,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:M()),t;var s}function Su(n,e){const t=e.currentDocument?void 0!==(s=e.currentDocument).updateTime?be.updateTime(Re(s.updateTime)):void 0!==s.exists?be.exists(s.exists):be.none():be.none(),i=e.updateTransforms?e.updateTransforms.map(s=>function(r,o){let l=null;"setToServerValue"in o?(z("REQUEST_TIME"===o.setToServerValue),l=new Di):"appendMissingElements"in o?l=new zn(o.appendMissingElements.values||[]):"removeAllFromArray"in o?l=new jn(o.removeAllFromArray.values||[]):"increment"in o?l=new xi(r,o.increment):M();const u=Le.fromServerFormat(o.fieldPath);return new Ds(u,l)}(n,s)):[];var s;if(e.update){const s=Et(n,e.update.name),r=new Ue({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=new wi((e.updateMask.fieldPaths||[]).map(d=>Le.fromServerFormat(d)));return new on(s,r,o,t,i)}return new xs(s,r,t,i)}if(e.delete){const s=Et(n,e.delete);return new Cs(s,t)}if(e.verify){const s=Et(n,e.verify);return new qo(s,t)}return M()}function Du(n,e){return{documents:[jo(n,e.path)]}}function xu(n,e){const t={structuredQuery:{}},i=e.path;null!==e.collectionGroup?(t.parent=jo(n,i),t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(t.parent=jo(n,i.popLast()),t.structuredQuery.from=[{collectionId:i.lastSegment()}]);const s=function(l){if(0===l.length)return;const u=l.map(d=>function(g){if("=="===g.op){if(ql(g.value))return{unaryFilter:{field:Ci(g.field),op:"IS_NAN"}};if(Bl(g.value))return{unaryFilter:{field:Ci(g.field),op:"IS_NULL"}}}else if("!="===g.op){if(ql(g.value))return{unaryFilter:{field:Ci(g.field),op:"IS_NOT_NAN"}};if(Bl(g.value))return{unaryFilter:{field:Ci(g.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ci(g.field),op:rp(g.op),value:g.value}}}(d));return 1===u.length?u[0]:{compositeFilter:{op:"AND",filters:u}}}(e.filters);s&&(t.structuredQuery.where=s);const r=function(l){if(0!==l.length)return l.map(u=>{return{field:Ci((d=u).field),direction:sp(d.dir)};var d})}(e.orderBy);r&&(t.structuredQuery.orderBy=r);const o=(u=e.limit,n.D||qn(u)?u:{value:u});var u;return null!==o&&(t.structuredQuery.limit=o),e.startAt&&(t.structuredQuery.startAt=Ru(e.startAt)),e.endAt&&(t.structuredQuery.endAt=Ru(e.endAt)),t}function Cu(n){let e=bu(n.parent);const t=n.structuredQuery,i=t.from?t.from.length:0;let s=null;if(i>0){z(1===i);const g=t.from[0];g.allDescendants?s=g.collectionId:e=e.child(g.collectionId)}let r=[];t.where&&(r=Au(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(g=>{return new Ei(Ai((_=g).field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(_.direction));var _}));let l=null;t.limit&&(l=function(g){let _;return _="object"==typeof g?g.value:g,qn(_)?null:_}(t.limit));let u=null;t.startAt&&(u=Pu(t.startAt));let d=null;return t.endAt&&(d=Pu(t.endAt)),$l(e,s,o,r,l,"F",u,d)}function Au(n){return n?void 0!==n.unaryFilter?[ap(n)]:void 0!==n.fieldFilter?[op(n)]:void 0!==n.compositeFilter?n.compositeFilter.filters.map(e=>Au(e)).reduce((e,t)=>e.concat(t)):M():[]}function Ru(n){return{before:n.before,values:n.position}}function Pu(n){return new Es(n.values||[],!!n.before)}function sp(n){return Qf[n]}function rp(n){return Wf[n]}function Ci(n){return{fieldPath:n.canonicalString()}}function Ai(n){return Le.fromServerFormat(n.fieldPath)}function op(n){return ze.create(Ai(n.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return M()}}(n.fieldFilter.op),n.fieldFilter.value)}function ap(n){switch(n.unaryFilter.op){case"IS_NAN":const e=Ai(n.unaryFilter.field);return ze.create(e,"==",{doubleValue:NaN});case"IS_NULL":const t=Ai(n.unaryFilter.field);return ze.create(t,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ai(n.unaryFilter.field);return ze.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=Ai(n.unaryFilter.field);return ze.create(s,"!=",{nullValue:"NULL_VALUE"});default:return M()}}function cp(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Nu(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}function ft(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=ku(e)),e=lp(n.get(t),e);return ku(e)}function lp(n,e){let t=e;const i=n.length;for(let s=0;s<i;s++){const r=n.charAt(s);switch(r){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=r}}return t}function ku(n){return n+"\x01\x01"}function Gt(n){const e=n.length;if(z(e>=2),2===e)return z("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),X.emptyPath();const t=e-2,i=[];let s="";for(let r=0;r<e;){const o=n.indexOf("\x01",r);switch((o<0||o>t)&&M(),n.charAt(o+1)){case"\x01":const l=n.substring(r,o);let u;0===s.length?u=l:(s+=l,u=s,s=""),i.push(u);break;case"\x10":s+=n.substring(r,o),s+="\0";break;case"\x11":s+=n.substring(r,o+1);break;default:M()}r=o+2}return new X(i)}class up{constructor(e,t){this.seconds=e,this.nanoseconds=t}}class nt{constructor(e,t,i){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=i}}nt.store="owner",nt.key="owner";class an{constructor(e,t,i){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=i}}an.store="mutationQueues",an.keyPath="userId";class ie{constructor(e,t,i,s,r){this.userId=e,this.batchId=t,this.localWriteTimeMs=i,this.baseMutations=s,this.mutations=r}}ie.store="mutations",ie.keyPath="batchId",ie.userMutationsIndex="userMutationsIndex",ie.userMutationsKeyPath=["userId","batchId"];class Ve{constructor(){}static prefixForUser(e){return[e]}static prefixForPath(e,t){return[e,ft(t)]}static key(e,t,i){return[e,ft(t),i]}}Ve.store="documentMutations",Ve.PLACEHOLDER=new Ve;class hp{constructor(e,t){this.path=e,this.readTime=t}}class dp{constructor(e,t){this.path=e,this.version=t}}class he{constructor(e,t,i,s,r,o){this.unknownDocument=e,this.noDocument=t,this.document=i,this.hasCommittedMutations=s,this.readTime=r,this.parentPath=o}}he.store="remoteDocuments",he.readTimeIndex="readTimeIndex",he.readTimeIndexPath="readTime",he.collectionReadTimeIndex="collectionReadTimeIndex",he.collectionReadTimeIndexPath=["parentPath","readTime"];class It{constructor(e){this.byteSize=e}}It.store="remoteDocumentGlobal",It.key="remoteDocumentGlobalKey";class Ye{constructor(e,t,i,s,r,o,l){this.targetId=e,this.canonicalId=t,this.readTime=i,this.resumeToken=s,this.lastListenSequenceNumber=r,this.lastLimboFreeSnapshotVersion=o,this.query=l}}Ye.store="targets",Ye.keyPath="targetId",Ye.queryTargetsIndexName="queryTargetsIndex",Ye.queryTargetsKeyPath=["canonicalId","targetId"];class Me{constructor(e,t,i){this.targetId=e,this.path=t,this.sequenceNumber=i}}Me.store="targetDocuments",Me.keyPath=["targetId","path"],Me.documentTargetsIndex="documentTargetsIndex",Me.documentTargetsKeyPath=["path","targetId"];class it{constructor(e,t,i,s){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=i,this.targetCount=s}}it.key="targetGlobalKey",it.store="targetGlobal";class Kn{constructor(e,t){this.collectionId=e,this.parent=t}}Kn.store="collectionParents",Kn.keyPath=["collectionId","parent"];class zt{constructor(e,t,i,s){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=i,this.inForeground=s}}zt.store="clientMetadata",zt.keyPath="clientId";class Ri{constructor(e,t,i){this.bundleId=e,this.createTime=t,this.version=i}}Ri.store="bundles",Ri.keyPath="bundleId";class Pi{constructor(e,t,i){this.name=e,this.readTime=t,this.bundledQuery=i}}Pi.store="namedQueries",Pi.keyPath="name";const fp=[an.store,ie.store,Ve.store,he.store,Ye.store,nt.store,it.store,Me.store,zt.store,It.store,Kn.store,Ri.store,Pi.store],Lu="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ou{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}class C{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&M(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new C((i,s)=>{this.nextCallback=r=>{this.wrapSuccess(e,r).next(i,s)},this.catchCallback=r=>{this.wrapFailure(t,r).next(i,s)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof C?t:C.resolve(t)}catch(t){return C.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):C.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):C.reject(t)}static resolve(e){return new C((t,i)=>{t(e)})}static reject(e){return new C((t,i)=>{i(e)})}static waitFor(e){return new C((t,i)=>{let s=0,r=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++r,o&&r===s&&t()},u=>i(u))}),o=!0,r===s&&t()})}static or(e){let t=C.resolve(!1);for(const i of e)t=t.next(s=>s?C.resolve(s):i());return t}static forEach(e,t){const i=[];return e.forEach((s,r)=>{i.push(t.call(this,s,r))}),this.waitFor(i)}}class Nr{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.Et=new xe,this.transaction.oncomplete=()=>{this.Et.resolve()},this.transaction.onabort=()=>{t.error?this.Et.reject(new Ls(e,t.error)):this.Et.resolve()},this.transaction.onerror=i=>{const s=Ko(i.target.error);this.Et.reject(new Ls(e,s))}}static open(e,t,i,s){try{return new Nr(t,e.transaction(s,i))}catch(r){throw new Ls(t,r)}}get It(){return this.Et.promise}abort(e){e&&this.Et.reject(e),this.aborted||(R("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}store(e){const t=this.transaction.objectStore(e);return new gp(t)}}class pt{constructor(e,t,i){this.name=e,this.version=t,this.At=i,12.2===pt.Rt((0,$.z$)())&&ve("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return R("SimpleDb","Removing database:",e),$n(window.indexedDB.deleteDatabase(e)).toPromise()}static bt(){if(!(0,$.hl)())return!1;if(pt.Pt())return!0;const e=(0,$.z$)(),t=pt.Rt(e),i=0<t&&t<10,s=pt.vt(e),r=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||r)}static Pt(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.Vt)}static St(e,t){return e.store(t)}static Rt(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(i)}static vt(e){const t=e.match(/Android ([\d.]+)/i),i=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(i)}Dt(e){var t=this;return(0,S.Z)(function*(){return t.db||(R("SimpleDb","Opening database:",t.name),t.db=yield new Promise((i,s)=>{const r=indexedDB.open(t.name,t.version);r.onsuccess=o=>{i(o.target.result)},r.onblocked=()=>{s(new Ls(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=o=>{const l=o.target.error;s("VersionError"===l.name?new A(T.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===l.name?new A(T.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l):new Ls(e,l))},r.onupgradeneeded=o=>{R("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',o.oldVersion),t.At.Ct(o.target.result,r.transaction,o.oldVersion,t.version).next(()=>{R("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.Nt&&(t.db.onversionchange=i=>t.Nt(i)),t.db})()}xt(e){this.Nt=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,i,s){var r=this;return(0,S.Z)(function*(){const o="readonly"===t;let l=0;for(;;){++l;try{r.db=yield r.Dt(e);const u=Nr.open(r.db,e,o?"readonly":"readwrite",i),d=s(u).catch(g=>(u.abort(g),C.reject(g))).toPromise();return d.catch(()=>{}),yield u.It,d}catch(u){const d="FirebaseError"!==u.name&&l<3;if(R("SimpleDb","Transaction failed with error:",u.message,"Retrying:",d),r.close(),!d)return Promise.reject(u)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class pp{constructor(e){this.kt=e,this.$t=!1,this.Ot=null}get isDone(){return this.$t}get Ft(){return this.Ot}set cursor(e){this.kt=e}done(){this.$t=!0}Mt(e){this.Ot=e}delete(){return $n(this.kt.delete())}}class Ls extends A{constructor(e,t){super(T.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Zn(n){return"IndexedDbTransactionError"===n.name}class gp{constructor(e){this.store=e}put(e,t){let i;return void 0!==t?(R("SimpleDb","PUT",this.store.name,e,t),i=this.store.put(t,e)):(R("SimpleDb","PUT",this.store.name,"<auto-key>",e),i=this.store.put(e)),$n(i)}add(e){return R("SimpleDb","ADD",this.store.name,e,e),$n(this.store.add(e))}get(e){return $n(this.store.get(e)).next(t=>(void 0===t&&(t=null),R("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return R("SimpleDb","DELETE",this.store.name,e),$n(this.store.delete(e))}count(){return R("SimpleDb","COUNT",this.store.name),$n(this.store.count())}Lt(e,t){const i=this.cursor(this.options(e,t)),s=[];return this.Bt(i,(r,o)=>{s.push(o)}).next(()=>s)}Ut(e,t){R("SimpleDb","DELETE ALL",this.store.name);const i=this.options(e,t);i.qt=!1;const s=this.cursor(i);return this.Bt(s,(r,o,l)=>l.delete())}Kt(e,t){let i;t?i=e:(i={},t=e);const s=this.cursor(i);return this.Bt(s,t)}jt(e){const t=this.cursor({});return new C((i,s)=>{t.onerror=r=>{const o=Ko(r.target.error);s(o)},t.onsuccess=r=>{const o=r.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():i()}):i()}})}Bt(e,t){const i=[];return new C((s,r)=>{e.onerror=o=>{r(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void s();const u=new pp(l),d=t(l.primaryKey,l.value,u);if(d instanceof C){const g=d.catch(_=>(u.done(),C.reject(_)));i.push(g)}u.isDone?s():null===u.Ft?l.continue():l.continue(u.Ft)}}).next(()=>C.waitFor(i))}options(e,t){let i;return void 0!==e&&("string"==typeof e?i=e:t=e),{index:i,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const i=this.store.index(e.index);return e.qt?i.openKeyCursor(e.range,t):i.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function $n(n){return new C((e,t)=>{n.onsuccess=i=>{e(i.target.result)},n.onerror=i=>{const s=Ko(i.target.error);t(s)}})}let Mu=!1;function Ko(n){const e=pt.Rt((0,$.z$)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const i=new A("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Mu||(Mu=!0,setTimeout(()=>{throw i},0)),i}}return n}class Fu extends Ou{constructor(e,t){super(),this.Qt=e,this.currentSequenceNumber=t}}function Qe(n,e){const t=N(n);return pt.St(t.Qt,e)}class Zo{constructor(e,t,i,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=i,this.mutations=s}applyToRemoteDocument(e,t){const i=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const r=this.mutations[s];r.key.isEqual(e.key)&&qf(r,e,i[s])}}applyToLocalView(e){for(const t of this.baseMutations)t.key.isEqual(e.key)&&Bo(t,e,this.localWriteTime);for(const t of this.mutations)t.key.isEqual(e.key)&&Bo(t,e,this.localWriteTime)}applyToLocalDocumentSet(e){this.mutations.forEach(t=>{const i=e.get(t.key),s=i;this.applyToLocalView(s),i.isValidDocument()||s.convertToNoDocument(K.min())})}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),ee())}isEqual(e){return this.batchId===e.batchId&&vi(this.mutations,e.mutations,(t,i)=>ru(t,i))&&vi(this.baseMutations,e.baseMutations,(t,i)=>ru(t,i))}}class $o{constructor(e,t,i,s){this.batch=e,this.commitVersion=t,this.mutationResults=i,this.docVersions=s}static from(e,t,i){z(e.mutations.length===i.length);let s=fu();const r=e.mutations;for(let o=0;o<r.length;o++)s=s.insert(r[o].key,i[o].version);return new $o(e,t,i,s)}}class cn{constructor(e,t,i,s,r=K.min(),o=K.min(),l=Ae.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=i,this.sequenceNumber=s,this.snapshotVersion=r,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l}withSequenceNumber(e){return new cn(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new cn(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new cn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class Uu{constructor(e){this.Wt=e}}function Ho(n,e){if(e.document)return Iu(n.Wt,e.document,!!e.hasCommittedMutations);if(e.noDocument){const t=O.fromSegments(e.noDocument.path),i=ki(e.noDocument.readTime),s=ae.newNoDocument(t,i);return e.hasCommittedMutations?s.setHasCommittedMutations():s}if(e.unknownDocument){const t=O.fromSegments(e.unknownDocument.path),i=ki(e.unknownDocument.version);return ae.newUnknownDocument(t,i)}return M()}function Vu(n,e,t){const i=Yo(t),s=e.key.path.popLast().toArray();if(e.isFoundDocument()){const r={name:Ns(l=n.Wt,(u=e).key),fields:u.data.value.mapValue.fields,updateTime:Ps(l,u.version.toTimestamp())};return new he(null,null,r,e.hasCommittedMutations,i,s)}var l,u;if(e.isNoDocument()){const r=e.key.path.toArray(),o=Ni(e.version),l=e.hasCommittedMutations;return new he(null,new hp(r,o),null,l,i,s)}if(e.isUnknownDocument()){const r=e.key.path.toArray(),o=Ni(e.version);return new he(new dp(r,o),null,null,!0,i,s)}return M()}function Yo(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function Bu(n){const e=new Ce(n[0],n[1]);return K.fromTimestamp(e)}function Ni(n){const e=n.toTimestamp();return new up(e.seconds,e.nanoseconds)}function ki(n){const e=new Ce(n.seconds,n.nanoseconds);return K.fromTimestamp(e)}function Li(n,e){const t=(e.baseMutations||[]).map(r=>Su(n.Wt,r));for(let r=0;r<e.mutations.length-1;++r){const o=e.mutations[r];r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform&&(o.updateTransforms=e.mutations[r+1].transform.fieldTransforms,e.mutations.splice(r+1,1),++r)}const i=e.mutations.map(r=>Su(n.Wt,r)),s=Ce.fromMillis(e.localWriteTimeMs);return new Zo(e.batchId,s,t,i)}function Os(n){const e=ki(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?ki(n.lastLimboFreeSnapshotVersion):K.min();let i;var s;return void 0!==n.query.documents?(z(1===(s=n.query).documents.length),i=at(Ii(bu(s.documents[0])))):i=at(Cu(n.query)),new cn(i,n.targetId,0,n.lastListenSequenceNumber,e,t,Ae.fromBase64String(n.resumeToken))}function qu(n,e){const t=Ni(e.snapshotVersion),i=Ni(e.lastLimboFreeSnapshotVersion);let s;s=br(e.target)?Du(n.Wt,e.target):xu(n.Wt,e.target);const r=e.resumeToken.toBase64();return new Ye(e.targetId,Ts(e.target),t,r,e.sequenceNumber,i,s)}function Qo(n){const e=Cu({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?Hl(e,e.limit,"L"):e}class mp{getBundleMetadata(e,t){return Gu(e).get(t).next(i=>{if(i)return{id:(s=i).bundleId,createTime:ki(s.createTime),version:s.version};var s})}saveBundleMetadata(e,t){return Gu(e).put({bundleId:(i=t).id,createTime:Ni(Re(i.createTime)),version:i.version});var i}getNamedQuery(e,t){return zu(e).get(t).next(i=>{if(i)return{name:(s=i).name,query:Qo(s.bundledQuery),readTime:ki(s.readTime)};var s})}saveNamedQuery(e,t){return zu(e).put({name:(i=t).name,readTime:Ni(Re(i.readTime)),bundledQuery:i.bundledQuery});var i}}function Gu(n){return Qe(n,Ri.store)}function zu(n){return Qe(n,Pi.store)}class yp{constructor(){this.Gt=new Wo}addToCollectionParentIndex(e,t){return this.Gt.add(t),C.resolve()}getCollectionParents(e,t){return C.resolve(this.Gt.getEntries(t))}}class Wo{constructor(){this.index={}}add(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t]||new ue(X.comparator),r=!s.has(i);return this.index[t]=s.add(i),r}has(e){const t=e.lastSegment(),i=e.popLast(),s=this.index[t];return s&&s.has(i)}getEntries(e){return(this.index[e]||new ue(X.comparator)).toArray()}}class _p{constructor(){this.zt=new Wo}addToCollectionParentIndex(e,t){if(!this.zt.has(t)){const i=t.lastSegment(),s=t.popLast();e.addOnCommittedListener(()=>{this.zt.add(t)});const r={collectionId:i,parent:ft(s)};return ju(e).put(r)}return C.resolve()}getCollectionParents(e,t){const i=[],s=IDBKeyRange.bound([t,""],[Ll(t),""],!1,!0);return ju(e).Lt(s).next(r=>{for(const o of r){if(o.collectionId!==t)break;i.push(Gt(o.parent))}return i})}}function ju(n){return Qe(n,Kn.store)}const Ku={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class We{constructor(e,t,i){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=i}static withCacheSize(e){return new We(e,We.DEFAULT_COLLECTION_PERCENTILE,We.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function Zu(n,e,t){const i=n.store(ie.store),s=n.store(Ve.store),r=[],o=IDBKeyRange.only(t.batchId);let l=0;const u=i.Kt({range:o},(g,_,E)=>(l++,E.delete()));r.push(u.next(()=>{z(1===l)}));const d=[];for(const g of t.mutations){const _=Ve.key(e,g.key.path,t.batchId);r.push(s.delete(_)),d.push(g.key)}return C.waitFor(r).next(()=>d)}function kr(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw M();e=n.noDocument}return JSON.stringify(e).length}We.DEFAULT_COLLECTION_PERCENTILE=10,We.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,We.DEFAULT=new We(41943040,We.DEFAULT_COLLECTION_PERCENTILE,We.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),We.DISABLED=new We(-1,0,0);class Xo{constructor(e,t,i,s){this.userId=e,this.N=t,this.Ht=i,this.referenceDelegate=s,this.Jt={}}static Yt(e,t,i,s){z(""!==e.uid);const r=e.isAuthenticated()?e.uid:"";return new Xo(r,t,i,s)}checkEmpty(e){let t=!0;const i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ln(e).Kt({index:ie.userMutationsIndex,range:i},(s,r,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,i,s){const r=Oi(e),o=ln(e);return o.add({}).next(l=>{z("number"==typeof l);const u=new Zo(l,t,i,s),d=function(E,x,P){const F=P.baseMutations.map(fe=>Pr(E.Wt,fe)),Z=P.mutations.map(fe=>Pr(E.Wt,fe));return new ie(x,P.batchId,P.localWriteTime.toMillis(),F,Z)}(this.N,this.userId,u),g=[];let _=new ue((E,x)=>H(E.canonicalString(),x.canonicalString()));for(const E of s){const x=Ve.key(this.userId,E.key.path,l);_=_.add(E.key.path.popLast()),g.push(o.put(d)),g.push(r.put(x,Ve.PLACEHOLDER))}return _.forEach(E=>{g.push(this.Ht.addToCollectionParentIndex(e,E))}),e.addOnCommittedListener(()=>{this.Jt[l]=u.keys()}),C.waitFor(g).next(()=>u)})}lookupMutationBatch(e,t){return ln(e).get(t).next(i=>i?(z(i.userId===this.userId),Li(this.N,i)):null)}Xt(e,t){return this.Jt[t]?C.resolve(this.Jt[t]):this.lookupMutationBatch(e,t).next(i=>{if(i){const s=i.keys();return this.Jt[t]=s,s}return null})}getNextMutationBatchAfterBatchId(e,t){const i=t+1,s=IDBKeyRange.lowerBound([this.userId,i]);let r=null;return ln(e).Kt({index:ie.userMutationsIndex,range:s},(o,l,u)=>{l.userId===this.userId&&(z(l.batchId>=i),r=Li(this.N,l)),u.done()}).next(()=>r)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let i=-1;return ln(e).Kt({index:ie.userMutationsIndex,range:t,reverse:!0},(s,r,o)=>{i=r.batchId,o.done()}).next(()=>i)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ln(e).Lt(ie.userMutationsIndex,t).next(i=>i.map(s=>Li(this.N,s)))}getAllMutationBatchesAffectingDocumentKey(e,t){const i=Ve.prefixForPath(this.userId,t.path),s=IDBKeyRange.lowerBound(i),r=[];return Oi(e).Kt({range:s},(o,l,u)=>{const[d,g,_]=o,E=Gt(g);if(d===this.userId&&t.path.isEqual(E))return ln(e).get(_).next(x=>{if(!x)throw M();z(x.userId===this.userId),r.push(Li(this.N,x))});u.done()}).next(()=>r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new ue(H);const s=[];return t.forEach(r=>{const o=Ve.prefixForPath(this.userId,r.path),l=IDBKeyRange.lowerBound(o),u=Oi(e).Kt({range:l},(d,g,_)=>{const[E,x,P]=d,F=Gt(x);E===this.userId&&r.path.isEqual(F)?i=i.add(P):_.done()});s.push(u)}),C.waitFor(s).next(()=>this.Zt(e,i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1,r=Ve.prefixForPath(this.userId,i),o=IDBKeyRange.lowerBound(r);let l=new ue(H);return Oi(e).Kt({range:o},(u,d,g)=>{const[_,E,x]=u,P=Gt(E);_===this.userId&&i.isPrefixOf(P)?P.length===s&&(l=l.add(x)):g.done()}).next(()=>this.Zt(e,l))}Zt(e,t){const i=[],s=[];return t.forEach(r=>{s.push(ln(e).get(r).next(o=>{if(null===o)throw M();z(o.userId===this.userId),i.push(Li(this.N,o))}))}),C.waitFor(s).next(()=>i)}removeMutationBatch(e,t){return Zu(e.Qt,this.userId,t).next(i=>(e.addOnCommittedListener(()=>{this.te(t.batchId)}),C.forEach(i,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}te(e){delete this.Jt[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return C.resolve();const i=IDBKeyRange.lowerBound(Ve.prefixForUser(this.userId)),s=[];return Oi(e).Kt({range:i},(r,o,l)=>{if(r[0]===this.userId){const u=Gt(r[1]);s.push(u)}else l.done()}).next(()=>{z(0===s.length)})})}containsKey(e,t){return $u(e,this.userId,t)}ee(e){return Hu(e).get(this.userId).next(t=>t||new an(this.userId,-1,""))}}function $u(n,e,t){const i=Ve.prefixForPath(e,t.path),s=i[1],r=IDBKeyRange.lowerBound(i);let o=!1;return Oi(n).Kt({range:r,qt:!0},(l,u,d)=>{const[g,_,E]=l;g===e&&_===s&&(o=!0),d.done()}).next(()=>o)}function ln(n){return Qe(n,ie.store)}function Oi(n){return Qe(n,Ve.store)}function Hu(n){return Qe(n,an.store)}class Hn{constructor(e){this.ne=e}next(){return this.ne+=2,this.ne}static se(){return new Hn(0)}static ie(){return new Hn(-1)}}class vp{constructor(e,t){this.referenceDelegate=e,this.N=t}allocateTargetId(e){return this.re(e).next(t=>{const i=new Hn(t.highestTargetId);return t.highestTargetId=i.next(),this.oe(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.re(e).next(t=>K.fromTimestamp(new Ce(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.re(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,i){return this.re(e).next(s=>(s.highestListenSequenceNumber=t,i&&(s.lastRemoteSnapshotVersion=i.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.oe(e,s)))}addTargetData(e,t){return this.ae(e,t).next(()=>this.re(e).next(i=>(i.targetCount+=1,this.ce(t,i),this.oe(e,i))))}updateTargetData(e,t){return this.ae(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Mi(e).delete(t.targetId)).next(()=>this.re(e)).next(i=>(z(i.targetCount>0),i.targetCount-=1,this.oe(e,i)))}removeTargets(e,t,i){let s=0;const r=[];return Mi(e).Kt((o,l)=>{const u=Os(l);u.sequenceNumber<=t&&null===i.get(u.targetId)&&(s++,r.push(this.removeTargetData(e,u)))}).next(()=>C.waitFor(r)).next(()=>s)}forEachTarget(e,t){return Mi(e).Kt((i,s)=>{const r=Os(s);t(r)})}re(e){return Yu(e).get(it.key).next(t=>(z(null!==t),t))}oe(e,t){return Yu(e).put(it.key,t)}ae(e,t){return Mi(e).put(qu(this.N,t))}ce(e,t){let i=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,i=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,i=!0),i}getTargetCount(e){return this.re(e).next(t=>t.targetCount)}getTargetData(e,t){const i=Ts(t),s=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]);let r=null;return Mi(e).Kt({range:s,index:Ye.queryTargetsIndexName},(o,l,u)=>{const d=Os(l);wr(t,d.target)&&(r=d,u.done())}).next(()=>r)}addMatchingKeys(e,t,i){const s=[],r=un(e);return t.forEach(o=>{const l=ft(o.path);s.push(r.put(new Me(i,l))),s.push(this.referenceDelegate.addReference(e,i,o))}),C.waitFor(s)}removeMatchingKeys(e,t,i){const s=un(e);return C.forEach(t,r=>{const o=ft(r.path);return C.waitFor([s.delete([i,o]),this.referenceDelegate.removeReference(e,i,r)])})}removeMatchingKeysForTargetId(e,t){const i=un(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return i.delete(s)}getMatchingKeysForTargetId(e,t){const i=IDBKeyRange.bound([t],[t+1],!1,!0),s=un(e);let r=ee();return s.Kt({range:i,qt:!0},(o,l,u)=>{const d=Gt(o[1]),g=new O(d);r=r.add(g)}).next(()=>r)}containsKey(e,t){const i=ft(t.path),s=IDBKeyRange.bound([i],[Ll(i)],!1,!0);let r=0;return un(e).Kt({index:Me.documentTargetsIndex,qt:!0,range:s},([o,l],u,d)=>{0!==o&&(r++,d.done())}).next(()=>r>0)}Tt(e,t){return Mi(e).get(t).next(i=>i?Os(i):null)}}function Mi(n){return Qe(n,Ye.store)}function Yu(n){return Qe(n,it.store)}function un(n){return Qe(n,Me.store)}function Yn(n){return Jo.apply(this,arguments)}function Jo(){return(Jo=(0,S.Z)(function*(n){if(n.code!==T.FAILED_PRECONDITION||n.message!==Lu)throw n;R("LocalStore","Unexpectedly lost primary lease")})).apply(this,arguments)}function Qu([n,e],[t,i]){const s=H(n,t);return 0===s?H(e,i):s}class wp{constructor(e){this.ue=e,this.buffer=new ue(Qu),this.he=0}le(){return++this.he}fe(e){const t=[e,this.le()];if(this.buffer.size<this.ue)this.buffer=this.buffer.add(t);else{const i=this.buffer.last();Qu(t,i)<0&&(this.buffer=this.buffer.delete(i).add(t))}}get maxValue(){return this.buffer.last()[0]}}class bp{constructor(e,t){this.garbageCollector=e,this.asyncQueue=t,this.de=!1,this.we=null}start(e){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this._e(e)}stop(){this.we&&(this.we.cancel(),this.we=null)}get started(){return null!==this.we}_e(e){var t=this;const i=this.de?3e5:6e4;R("LruGarbageCollector",`Garbage collection scheduled in ${i}ms`),this.we=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",i,(0,S.Z)(function*(){t.we=null,t.de=!0;try{yield e.collectGarbage(t.garbageCollector)}catch(s){Zn(s)?R("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",s):yield Yn(s)}yield t._e(e)}))}}class Tp{constructor(e,t){this.me=e,this.params=t}calculateTargetCount(e,t){return this.me.ge(e).next(i=>Math.floor(t/100*i))}nthSequenceNumber(e,t){if(0===t)return C.resolve(tt.T);const i=new wp(t);return this.me.forEachTarget(e,s=>i.fe(s.sequenceNumber)).next(()=>this.me.ye(e,s=>i.fe(s))).next(()=>i.maxValue)}removeTargets(e,t,i){return this.me.removeTargets(e,t,i)}removeOrphanedDocuments(e,t){return this.me.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(R("LruGarbageCollector","Garbage collection skipped; disabled"),C.resolve(Ku)):this.getCacheSize(e).next(i=>i<this.params.cacheSizeCollectionThreshold?(R("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ku):this.pe(e,t))}getCacheSize(e){return this.me.getCacheSize(e)}pe(e,t){let i,s,r,o,l,u,d;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(_=>(_>this.params.maximumSequenceNumbersToCollect?(R("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),s=this.params.maximumSequenceNumbersToCollect):s=_,o=Date.now(),this.nthSequenceNumber(e,s))).next(_=>(i=_,l=Date.now(),this.removeTargets(e,i,t))).next(_=>(r=_,u=Date.now(),this.removeOrphanedDocuments(e,i))).next(_=>(d=Date.now(),Ao()<=De.in.DEBUG&&R("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-g}ms\n\tDetermined least recently used ${s} in `+(l-o)+`ms\n\tRemoved ${r} targets in `+(u-l)+`ms\n\tRemoved ${_} documents in `+(d-u)+`ms\nTotal Duration: ${d-g}ms`),C.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:r,documentsRemoved:_})))}}class Ep{constructor(e,t){this.db=e,this.garbageCollector=new Tp(this,t)}ge(e){const t=this.Te(e);return this.db.getTargetCache().getTargetCount(e).next(i=>t.next(s=>i+s))}Te(e){let t=0;return this.ye(e,i=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}ye(e,t){return this.Ee(e,(i,s)=>t(s))}addReference(e,t,i){return Lr(e,i)}removeReference(e,t,i){return Lr(e,i)}removeTargets(e,t,i){return this.db.getTargetCache().removeTargets(e,t,i)}markPotentiallyOrphaned(e,t){return Lr(e,t)}Ie(e,t){return function(i,s){let r=!1;return Hu(i).jt(o=>$u(i,o,s).next(l=>(l&&(r=!0),C.resolve(!l)))).next(()=>r)}(e,t)}removeOrphanedDocuments(e,t){const i=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let r=0;return this.Ee(e,(o,l)=>{if(l<=t){const u=this.Ie(e,o).next(d=>{if(!d)return r++,i.getEntry(e,o).next(()=>(i.removeEntry(o),un(e).delete([0,ft(o.path)])))});s.push(u)}}).next(()=>C.waitFor(s)).next(()=>i.apply(e)).next(()=>r)}removeTarget(e,t){const i=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,i)}updateLimboDocument(e,t){return Lr(e,t)}Ee(e,t){const i=un(e);let s,r=tt.T;return i.Kt({index:Me.documentTargetsIndex},([o,l],{path:u,sequenceNumber:d})=>{0===o?(r!==tt.T&&t(new O(Gt(s)),r),r=d,s=u):r=tt.T}).next(()=>{r!==tt.T&&t(new O(Gt(s)),r)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Lr(n,e){return un(n).put((i=n.currentSequenceNumber,new Me(0,ft(e.path),i)));var i}class Fi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={}}get(e){const t=this.mapKeyFn(e),i=this.inner[t];if(void 0!==i)for(const[s,r]of i)if(this.equalsFn(s,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const i=this.mapKeyFn(e),s=this.inner[i];if(void 0!==s){for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return void(s[r]=[e,t]);s.push([e,t])}else this.inner[i]=[[e,t]]}delete(e){const t=this.mapKeyFn(e),i=this.inner[t];if(void 0===i)return!1;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return 1===i.length?delete this.inner[t]:i.splice(s,1),!0;return!1}forEach(e){Bn(this.inner,(t,i)=>{for(const[s,r]of i)e(s,r)})}isEmpty(){return Ml(this.inner)}}class Wu{constructor(){this.changes=new Fi(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}getReadTime(e){const t=this.changes.get(e);return t?t.readTime:K.min()}addEntry(e,t){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:t})}removeEntry(e,t=null){this.assertNotApplied(),this.changes.set(e,{document:ae.newInvalidDocument(e),readTime:t})}getEntry(e,t){this.assertNotApplied();const i=this.changes.get(t);return void 0!==i?C.resolve(i.document):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Ip{constructor(e,t){this.N=e,this.Ht=t}addEntry(e,t,i){return hn(e).put(Or(t),i)}removeEntry(e,t){const i=hn(e),s=Or(t);return i.delete(s)}updateMetadata(e,t){return this.getMetadata(e).next(i=>(i.byteSize+=t,this.Ae(e,i)))}getEntry(e,t){return hn(e).get(Or(t)).next(i=>this.Re(t,i))}be(e,t){return hn(e).get(Or(t)).next(i=>({document:this.Re(t,i),size:kr(i)}))}getEntries(e,t){let i=ct();return this.Pe(e,t,(s,r)=>{const o=this.Re(s,r);i=i.insert(s,o)}).next(()=>i)}ve(e,t){let i=ct(),s=new Ie(O.comparator);return this.Pe(e,t,(r,o)=>{const l=this.Re(r,o);i=i.insert(r,l),s=s.insert(r,kr(o))}).next(()=>({documents:i,Ve:s}))}Pe(e,t,i){if(t.isEmpty())return C.resolve();const s=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),r=t.getIterator();let o=r.getNext();return hn(e).Kt({range:s},(l,u,d)=>{const g=O.fromSegments(l);for(;o&&O.comparator(o,g)<0;)i(o,null),o=r.getNext();o&&o.isEqual(g)&&(i(o,u),o=r.hasNext()?r.getNext():null),o?d.Mt(o.path.toArray()):d.done()}).next(()=>{for(;o;)i(o,null),o=r.hasNext()?r.getNext():null})}getDocumentsMatchingQuery(e,t,i){let s=ct();const r=t.path.length+1,o={};if(i.isEqual(K.min())){const l=t.path.toArray();o.range=IDBKeyRange.lowerBound(l)}else{const l=t.path.toArray(),u=Yo(i);o.range=IDBKeyRange.lowerBound([l,u],!0),o.index=he.collectionReadTimeIndex}return hn(e).Kt(o,(l,u,d)=>{if(l.length!==r)return;const g=Ho(this.N,u);t.path.isPrefixOf(g.key.path)?Ss(t,g)&&(s=s.insert(g.key,g)):d.done()}).next(()=>s)}newChangeBuffer(e){return new Sp(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return Xu(e).get(It.key).next(t=>(z(!!t),t))}Ae(e,t){return Xu(e).put(It.key,t)}Re(e,t){if(t){const i=Ho(this.N,t);if(!i.isNoDocument()||!i.version.isEqual(K.min()))return i}return ae.newInvalidDocument(e)}}class Sp extends Wu{constructor(e,t){super(),this.Se=e,this.trackRemovals=t,this.De=new Fi(i=>i.toString(),(i,s)=>i.isEqual(s))}applyChanges(e){const t=[];let i=0,s=new ue((r,o)=>H(r.canonicalString(),o.canonicalString()));return this.changes.forEach((r,o)=>{const l=this.De.get(r);if(o.document.isValidDocument()){const u=Vu(this.Se.N,o.document,this.getReadTime(r));s=s.add(r.path.popLast()),i+=kr(u)-l,t.push(this.Se.addEntry(e,r,u))}else if(i-=l,this.trackRemovals){const u=Vu(this.Se.N,ae.newNoDocument(r,K.min()),this.getReadTime(r));t.push(this.Se.addEntry(e,r,u))}else t.push(this.Se.removeEntry(e,r))}),s.forEach(r=>{t.push(this.Se.Ht.addToCollectionParentIndex(e,r))}),t.push(this.Se.updateMetadata(e,i)),C.waitFor(t)}getFromCache(e,t){return this.Se.be(e,t).next(i=>(this.De.set(t,i.size),i.document))}getAllFromCache(e,t){return this.Se.ve(e,t).next(({documents:i,Ve:s})=>(s.forEach((r,o)=>{this.De.set(r,o)}),i))}}function Xu(n){return Qe(n,It.store)}function hn(n){return Qe(n,he.store)}function Or(n){return n.path.toArray()}class Dp{constructor(e){this.N=e}Ct(e,t,i,s){z(i<s&&i>=0&&s<=11);const r=new Nr("createOrUpgrade",t);var l;i<1&&s>=1&&(e.createObjectStore(nt.store),(l=e).createObjectStore(an.store,{keyPath:an.keyPath}),l.createObjectStore(ie.store,{keyPath:ie.keyPath,autoIncrement:!0}).createIndex(ie.userMutationsIndex,ie.userMutationsKeyPath,{unique:!0}),l.createObjectStore(Ve.store),Ju(e),function(l){l.createObjectStore(he.store)}(e));let o=C.resolve();return i<3&&s>=3&&(0!==i&&(function(l){l.deleteObjectStore(Me.store),l.deleteObjectStore(Ye.store),l.deleteObjectStore(it.store)}(e),Ju(e)),o=o.next(()=>function(l){const u=l.store(it.store),d=new it(0,0,K.min().toTimestamp(),0);return u.put(it.key,d)}(r))),i<4&&s>=4&&(0!==i&&(o=o.next(()=>function(l,u){return u.store(ie.store).Lt().next(d=>{l.deleteObjectStore(ie.store),l.createObjectStore(ie.store,{keyPath:ie.keyPath,autoIncrement:!0}).createIndex(ie.userMutationsIndex,ie.userMutationsKeyPath,{unique:!0});const g=u.store(ie.store),_=d.map(E=>g.put(E));return C.waitFor(_)})}(e,r))),o=o.next(()=>{!function(l){l.createObjectStore(zt.store,{keyPath:zt.keyPath})}(e)})),i<5&&s>=5&&(o=o.next(()=>this.Ce(r))),i<6&&s>=6&&(o=o.next(()=>(function(l){l.createObjectStore(It.store)}(e),this.Ne(r)))),i<7&&s>=7&&(o=o.next(()=>this.xe(r))),i<8&&s>=8&&(o=o.next(()=>this.ke(e,r))),i<9&&s>=9&&(o=o.next(()=>{(function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")})(e),function(l){const u=l.objectStore(he.store);u.createIndex(he.readTimeIndex,he.readTimeIndexPath,{unique:!1}),u.createIndex(he.collectionReadTimeIndex,he.collectionReadTimeIndexPath,{unique:!1})}(t)})),i<10&&s>=10&&(o=o.next(()=>this.$e(r))),i<11&&s>=11&&(o=o.next(()=>{(function(l){l.createObjectStore(Ri.store,{keyPath:Ri.keyPath})})(e),function(l){l.createObjectStore(Pi.store,{keyPath:Pi.keyPath})}(e)})),o}Ne(e){let t=0;return e.store(he.store).Kt((i,s)=>{t+=kr(s)}).next(()=>{const i=new It(t);return e.store(It.store).put(It.key,i)})}Ce(e){const t=e.store(an.store),i=e.store(ie.store);return t.Lt().next(s=>C.forEach(s,r=>{const o=IDBKeyRange.bound([r.userId,-1],[r.userId,r.lastAcknowledgedBatchId]);return i.Lt(ie.userMutationsIndex,o).next(l=>C.forEach(l,u=>{z(u.userId===r.userId);const d=Li(this.N,u);return Zu(e,r.userId,d).next(()=>{})}))}))}xe(e){const t=e.store(Me.store),i=e.store(he.store);return e.store(it.store).get(it.key).next(s=>{const r=[];return i.Kt((o,l)=>{const u=new X(o),d=[0,ft(u)];r.push(t.get(d).next(g=>g?C.resolve():t.put(new Me(0,ft(u),s.highestListenSequenceNumber))))}).next(()=>C.waitFor(r))})}ke(e,t){e.createObjectStore(Kn.store,{keyPath:Kn.keyPath});const i=t.store(Kn.store),s=new Wo,r=o=>{if(s.add(o)){const l=o.lastSegment(),u=o.popLast();return i.put({collectionId:l,parent:ft(u)})}};return t.store(he.store).Kt({qt:!0},(o,l)=>{const u=new X(o);return r(u.popLast())}).next(()=>t.store(Ve.store).Kt({qt:!0},([o,l,u],d)=>{const g=Gt(l);return r(g.popLast())}))}$e(e){const t=e.store(Ye.store);return t.Kt((i,s)=>{const r=Os(s),o=qu(this.N,r);return t.put(o)})}}function Ju(n){n.createObjectStore(Me.store,{keyPath:Me.keyPath}).createIndex(Me.documentTargetsIndex,Me.documentTargetsKeyPath,{unique:!0}),n.createObjectStore(Ye.store,{keyPath:Ye.keyPath}).createIndex(Ye.queryTargetsIndexName,Ye.queryTargetsKeyPath,{unique:!0}),n.createObjectStore(it.store)}const ea="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class ta{constructor(e,t,i,s,r,o,l,u,d,g){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=i,this.Oe=r,this.window=o,this.document=l,this.Fe=d,this.Me=g,this.Le=null,this.Be=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ue=null,this.inForeground=!1,this.qe=null,this.Ke=null,this.je=Number.NEGATIVE_INFINITY,this.Qe=_=>Promise.resolve(),!ta.bt())throw new A(T.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Ep(this,s),this.We=t+"main",this.N=new Uu(u),this.Ge=new pt(this.We,11,new Dp(this.N)),this.ze=new vp(this.referenceDelegate,this.N),this.Ht=new _p,this.He=new Ip(this.N,this.Ht),this.Je=new mp,this.window&&this.window.localStorage?this.Ye=this.window.localStorage:(this.Ye=null,!1===g&&ve("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Xe().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new A(T.FAILED_PRECONDITION,ea);return this.Ze(),this.tn(),this.en(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.ze.getHighestSequenceNumber(e))}).then(e=>{this.Le=new tt(e,this.Fe)}).then(()=>{this.Be=!0}).catch(e=>(this.Ge&&this.Ge.close(),Promise.reject(e)))}nn(e){var t=this;return this.Qe=function(){var i=(0,S.Z)(function*(s){if(t.started)return e(s)});return function(s){return i.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ge.xt(function(){var t=(0,S.Z)(function*(i){null===i.newVersion&&(yield e())});return function(i){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Oe.enqueueAndForget((0,S.Z)(function*(){t.started&&(yield t.Xe())})))}Xe(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Mr(e).put(new zt(this.clientId,Date.now(),this.networkEnabled,this.inForeground)).next(()=>{if(this.isPrimary)return this.sn(e).next(t=>{t||(this.isPrimary=!1,this.Oe.enqueueRetryable(()=>this.Qe(!1)))})}).next(()=>this.rn(e)).next(t=>this.isPrimary&&!t?this.on(e).next(()=>!1):!!t&&this.an(e).next(()=>!0))).catch(e=>{if(Zn(e))return R("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return R("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.Oe.enqueueRetryable(()=>this.Qe(e)),this.isPrimary=e})}sn(e){return Ms(e).get(nt.key).next(t=>C.resolve(this.cn(t)))}un(e){return Mr(e).delete(this.clientId)}hn(){var e=this;return(0,S.Z)(function*(){if(e.isPrimary&&!e.ln(e.je,18e5)){e.je=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",i=>{const s=Qe(i,zt.store);return s.Lt().next(r=>{const o=e.fn(r,18e5),l=r.filter(u=>-1===o.indexOf(u));return C.forEach(l,u=>s.delete(u.clientId)).next(()=>l)})}).catch(()=>[]);if(e.Ye)for(const i of t)e.Ye.removeItem(e.dn(i.clientId))}})()}en(){this.Ke=this.Oe.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Xe().then(()=>this.hn()).then(()=>this.en()))}cn(e){return!!e&&e.ownerId===this.clientId}rn(e){return this.Me?C.resolve(!0):Ms(e).get(nt.key).next(t=>{if(null!==t&&this.ln(t.leaseTimestampMs,5e3)&&!this.wn(t.ownerId)){if(this.cn(t)&&this.networkEnabled)return!0;if(!this.cn(t)){if(!t.allowTabSynchronization)throw new A(T.FAILED_PRECONDITION,ea);return!1}}return!(!this.networkEnabled||!this.inForeground)||Mr(e).Lt().next(i=>void 0===this.fn(i,5e3).find(s=>{if(this.clientId!==s.clientId){const o=!this.inForeground&&s.inForeground,l=this.networkEnabled===s.networkEnabled;if(!this.networkEnabled&&s.networkEnabled||o&&l)return!0}return!1}))}).next(t=>(this.isPrimary!==t&&R("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,S.Z)(function*(){e.Be=!1,e._n(),e.Ke&&(e.Ke.cancel(),e.Ke=null),e.mn(),e.gn(),yield e.Ge.runTransaction("shutdown","readwrite",[nt.store,zt.store],t=>{const i=new Fu(t,tt.T);return e.on(i).next(()=>e.un(i))}),e.Ge.close(),e.yn()})()}fn(e,t){return e.filter(i=>this.ln(i.updateTimeMs,t)&&!this.wn(i.clientId))}pn(){return this.runTransaction("getActiveClients","readonly",e=>Mr(e).Lt().next(t=>this.fn(t,18e5).map(i=>i.clientId)))}get started(){return this.Be}getMutationQueue(e){return Xo.Yt(e,this.N,this.Ht,this.referenceDelegate)}getTargetCache(){return this.ze}getRemoteDocumentCache(){return this.He}getIndexManager(){return this.Ht}getBundleCache(){return this.Je}runTransaction(e,t,i){let r;return R("IndexedDbPersistence","Starting transaction:",e),this.Ge.runTransaction(e,"readonly"===t?"readonly":"readwrite",fp,o=>(r=new Fu(o,this.Le?this.Le.next():tt.T),"readwrite-primary"===t?this.sn(r).next(l=>!!l||this.rn(r)).next(l=>{if(!l)throw ve(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Oe.enqueueRetryable(()=>this.Qe(!1)),new A(T.FAILED_PRECONDITION,Lu);return i(r)}).next(l=>this.an(r).next(()=>l)):this.Tn(r).next(()=>i(r)))).then(o=>(r.raiseOnCommittedEvent(),o))}Tn(e){return Ms(e).get(nt.key).next(t=>{if(null!==t&&this.ln(t.leaseTimestampMs,5e3)&&!this.wn(t.ownerId)&&!this.cn(t)&&!(this.Me||this.allowTabSynchronization&&t.allowTabSynchronization))throw new A(T.FAILED_PRECONDITION,ea)})}an(e){const t=new nt(this.clientId,this.allowTabSynchronization,Date.now());return Ms(e).put(nt.key,t)}static bt(){return pt.bt()}on(e){const t=Ms(e);return t.get(nt.key).next(i=>this.cn(i)?(R("IndexedDbPersistence","Releasing primary lease."),t.delete(nt.key)):C.resolve())}ln(e,t){const i=Date.now();return!(e<i-t||e>i&&(ve(`Detected an update time that is in the future: ${e} > ${i}`),1))}Ze(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.qe=()=>{this.Oe.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.Xe()))},this.document.addEventListener("visibilitychange",this.qe),this.inForeground="visible"===this.document.visibilityState)}mn(){this.qe&&(this.document.removeEventListener("visibilitychange",this.qe),this.qe=null)}tn(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Ue=()=>{this._n(),(0,$.G6)()&&navigator.appVersion.match("Version/14")&&this.Oe.enterRestrictedMode(!0),this.Oe.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ue))}gn(){this.Ue&&(this.window.removeEventListener("pagehide",this.Ue),this.Ue=null)}wn(e){var t;try{const i=null!==(null===(t=this.Ye)||void 0===t?void 0:t.getItem(this.dn(e)));return R("IndexedDbPersistence",`Client '${e}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return ve("IndexedDbPersistence","Failed to get zombied client id.",i),!1}}_n(){if(this.Ye)try{this.Ye.setItem(this.dn(this.clientId),String(Date.now()))}catch(e){ve("Failed to set zombie client id.",e)}}yn(){if(this.Ye)try{this.Ye.removeItem(this.dn(this.clientId))}catch(e){}}dn(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Ms(n){return Qe(n,nt.store)}function Mr(n){return Qe(n,zt.store)}function na(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class xp{constructor(e,t){this.progress=e,this.En=t}}class eh{constructor(e,t,i){this.He=e,this.In=t,this.Ht=i}An(e,t){return this.In.getAllMutationBatchesAffectingDocumentKey(e,t).next(i=>this.Rn(e,t,i))}Rn(e,t,i){return this.He.getEntry(e,t).next(s=>{for(const r of i)r.applyToLocalView(s);return s})}bn(e,t){e.forEach((i,s)=>{for(const r of t)r.applyToLocalView(s)})}Pn(e,t){return this.He.getEntries(e,t).next(i=>this.vn(e,i).next(()=>i))}vn(e,t){return this.In.getAllMutationBatchesAffectingDocumentKeys(e,t).next(i=>this.bn(t,i))}getDocumentsMatchingQuery(e,t,i){return O.isDocumentKey((s=t).path)&&null===s.collectionGroup&&0===s.filters.length?this.Vn(e,t.path):Uo(t)?this.Sn(e,t,i):this.Dn(e,t,i);var s}Vn(e,t){return this.An(e,new O(t)).next(i=>{let s=Go();return i.isFoundDocument()&&(s=s.insert(i.key,i)),s})}Sn(e,t,i){const s=t.collectionGroup;let r=Go();return this.Ht.getCollectionParents(e,s).next(o=>C.forEach(o,l=>{const u=(d=t,g=l.child(s),new qt(g,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt));var d,g;return this.Dn(e,u,i).next(d=>{d.forEach((g,_)=>{r=r.insert(g,_)})})}).next(()=>r))}Dn(e,t,i){let s,r;return this.He.getDocumentsMatchingQuery(e,t,i).next(o=>(s=o,this.In.getAllMutationBatchesAffectingQuery(e,t))).next(o=>(r=o,this.Cn(e,r,s).next(l=>{s=l;for(const u of r)for(const d of u.mutations){const g=d.key;let _=s.get(g);null==_&&(_=ae.newInvalidDocument(g),s=s.insert(g,_)),Bo(d,_,u.localWriteTime),_.isFoundDocument()||(s=s.remove(g))}}))).next(()=>(s.forEach((o,l)=>{Ss(t,l)||(s=s.remove(o))}),s))}Cn(e,t,i){let s=ee();for(const o of t)for(const l of o.mutations)l instanceof on&&null===i.get(l.key)&&(s=s.add(l.key));let r=i;return this.He.getEntries(e,s).next(o=>(o.forEach((l,u)=>{u.isFoundDocument()&&(r=r.insert(l,u))}),r))}}class ia{constructor(e,t,i,s){this.targetId=e,this.fromCache=t,this.Nn=i,this.xn=s}static kn(e,t){let i=ee(),s=ee();for(const r of t.docChanges)switch(r.type){case 0:i=i.add(r.doc.key);break;case 1:s=s.add(r.doc.key)}return new ia(e,t.fromCache,i,s)}}class th{$n(e){this.On=e}getDocumentsMatchingQuery(e,t,i,s){return 0===(r=t).filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.explicitOrderBy.length||1===r.explicitOrderBy.length&&r.explicitOrderBy[0].field.isKeyField())||i.isEqual(K.min())?this.Fn(e,t):this.On.Pn(e,s).next(r=>{const o=this.Mn(t,r);return(Er(t)||Ir(t))&&this.Ln(t.limitType,o,s,i)?this.Fn(e,t):(Ao()<=De.in.DEBUG&&R("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Vo(t)),this.On.getDocumentsMatchingQuery(e,t,i).next(l=>(o.forEach(u=>{l=l.insert(u.key,u)}),l)))});var r}Mn(e,t){let i=new ue(Ql(e));return t.forEach((s,r)=>{Ss(e,r)&&(i=i.add(r))}),i}Ln(e,t,i,s){if(i.size!==t.size)return!0;const r="F"===e?t.last():t.first();return!!r&&(r.hasPendingWrites||r.version.compareTo(s)>0)}Fn(e,t){return Ao()<=De.in.DEBUG&&R("QueryEngine","Using full collection scan to execute query:",Vo(t)),this.On.getDocumentsMatchingQuery(e,t,K.min())}}class Cp{constructor(e,t,i,s){this.persistence=e,this.Bn=t,this.N=s,this.Un=new Ie(H),this.qn=new Fi(r=>Ts(r),wr),this.Kn=K.min(),this.In=e.getMutationQueue(i),this.jn=e.getRemoteDocumentCache(),this.ze=e.getTargetCache(),this.Qn=new eh(this.jn,this.In,this.persistence.getIndexManager()),this.Je=e.getBundleCache(),this.Bn.$n(this.Qn)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Un))}}function nh(n,e,t,i){return new Cp(n,e,t,i)}function ih(n,e){return sa.apply(this,arguments)}function sa(){return(sa=(0,S.Z)(function*(n,e){const t=N(n);let i=t.In,s=t.Qn;const r=yield t.persistence.runTransaction("Handle user change","readonly",o=>{let l;return t.In.getAllMutationBatches(o).next(u=>(l=u,i=t.persistence.getMutationQueue(e),s=new eh(t.jn,i,t.persistence.getIndexManager()),i.getAllMutationBatches(o))).next(u=>{const d=[],g=[];let _=ee();for(const E of l){d.push(E.batchId);for(const x of E.mutations)_=_.add(x.key)}for(const E of u){g.push(E.batchId);for(const x of E.mutations)_=_.add(x.key)}return s.Pn(o,_).next(E=>({Wn:E,removedBatchIds:d,addedBatchIds:g}))})});return t.In=i,t.Qn=s,t.Bn.$n(t.Qn),r})).apply(this,arguments)}function Ap(n,e){const t=N(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{const s=e.batch.keys(),r=t.jn.newChangeBuffer({trackRemovals:!0});return function(o,l,u,d){const g=u.batch,_=g.keys();let E=C.resolve();return _.forEach(x=>{E=E.next(()=>d.getEntry(l,x)).next(P=>{const F=u.docVersions.get(x);z(null!==F),P.version.compareTo(F)<0&&(g.applyToRemoteDocument(P,u),P.isValidDocument()&&d.addEntry(P,u.commitVersion))})}),E.next(()=>o.In.removeMutationBatch(l,g))}(t,i,e,r).next(()=>r.apply(i)).next(()=>t.In.performConsistencyCheck(i)).next(()=>t.Qn.Pn(i,s))})}function sh(n){const e=N(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.ze.getLastRemoteSnapshotVersion(t))}function Rp(n,e){const t=N(n),i=e.snapshotVersion;let s=t.Un;return t.persistence.runTransaction("Apply remote event","readwrite-primary",r=>{const o=t.jn.newChangeBuffer({trackRemovals:!0});s=t.Un;const l=[];e.targetChanges.forEach((d,g)=>{const _=s.get(g);if(!_)return;l.push(t.ze.removeMatchingKeys(r,d.removedDocuments,g).next(()=>t.ze.addMatchingKeys(r,d.addedDocuments,g)));const E=d.resumeToken;if(E.approximateByteSize()>0){const x=_.withResumeToken(E,i).withSequenceNumber(r.currentSequenceNumber);s=s.insert(g,x),P=_,Z=d,z((F=x).resumeToken.approximateByteSize()>0),(0===P.resumeToken.approximateByteSize()||F.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=3e8||Z.addedDocuments.size+Z.modifiedDocuments.size+Z.removedDocuments.size>0)&&l.push(t.ze.updateTargetData(r,x))}var P,F,Z});let u=ct();if(e.documentUpdates.forEach((d,g)=>{e.resolvedLimboDocuments.has(d)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(r,d))}),l.push(rh(r,o,e.documentUpdates,i,void 0).next(d=>{u=d})),!i.isEqual(K.min())){const d=t.ze.getLastRemoteSnapshotVersion(r).next(g=>t.ze.setTargetsMetadata(r,r.currentSequenceNumber,i));l.push(d)}return C.waitFor(l).next(()=>o.apply(r)).next(()=>t.Qn.vn(r,u)).next(()=>u)}).then(r=>(t.Un=s,r))}function rh(n,e,t,i,s){let r=ee();return t.forEach(o=>r=r.add(o)),e.getEntries(n,r).next(o=>{let l=ct();return t.forEach((u,d)=>{const g=o.get(u),_=(null==s?void 0:s.get(u))||i;d.isNoDocument()&&d.version.isEqual(K.min())?(e.removeEntry(u,_),l=l.insert(u,d)):!g.isValidDocument()||d.version.compareTo(g.version)>0||0===d.version.compareTo(g.version)&&g.hasPendingWrites?(e.addEntry(d,_),l=l.insert(u,d)):R("LocalStore","Ignoring outdated watch update for ",u,". Current version:",g.version," Watch version:",d.version)}),l})}function Pp(n,e){const t=N(n);return t.persistence.runTransaction("Get next mutation batch","readonly",i=>(void 0===e&&(e=-1),t.In.getNextMutationBatchAfterBatchId(i,e)))}function Ui(n,e){const t=N(n);return t.persistence.runTransaction("Allocate target","readwrite",i=>{let s;return t.ze.getTargetData(i,e).next(r=>r?(s=r,C.resolve(s)):t.ze.allocateTargetId(i).next(o=>(s=new cn(e,o,0,i.currentSequenceNumber),t.ze.addTargetData(i,s).next(()=>s))))}).then(i=>{const s=t.Un.get(i.targetId);return(null===s||i.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Un=t.Un.insert(i.targetId,i),t.qn.set(e,i.targetId)),i})}function Vi(n,e,t){return ra.apply(this,arguments)}function ra(){return(ra=(0,S.Z)(function*(n,e,t){const i=N(n),s=i.Un.get(e),r=t?"readwrite":"readwrite-primary";try{t||(yield i.persistence.runTransaction("Release target",r,o=>i.persistence.referenceDelegate.removeTarget(o,s)))}catch(o){if(!Zn(o))throw o;R("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}i.Un=i.Un.remove(e),i.qn.delete(s.target)})).apply(this,arguments)}function Fr(n,e,t){const i=N(n);let s=K.min(),r=ee();return i.persistence.runTransaction("Execute query","readonly",o=>function(l,u,d){const g=N(l),_=g.qn.get(d);return void 0!==_?C.resolve(g.Un.get(_)):g.ze.getTargetData(u,d)}(i,o,at(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,i.ze.getMatchingKeysForTargetId(o,l.targetId).next(u=>{r=u})}).next(()=>i.Bn.getDocumentsMatchingQuery(o,e,t?s:K.min(),t?r:ee())).next(l=>({documents:l,Gn:r})))}function oh(n,e){const t=N(n),i=N(t.ze),s=t.Un.get(e);return s?Promise.resolve(s.target):t.persistence.runTransaction("Get target data","readonly",r=>i.Tt(r,e).next(o=>o?o.target:null))}function ah(n){const e=N(n);return e.persistence.runTransaction("Get new document changes","readonly",t=>function(i,s,r){const o=N(i);let l=ct(),u=Yo(r);const d=hn(s),g=IDBKeyRange.lowerBound(u,!0);return d.Kt({index:he.readTimeIndex,range:g},(_,E)=>{const x=Ho(o.N,E);l=l.insert(x.key,x),u=E.readTime}).next(()=>({En:l,readTime:Bu(u)}))}(e.jn,t,e.Kn)).then(({En:t,readTime:i})=>(e.Kn=i,t))}function oa(){return(oa=(0,S.Z)(function*(n){const e=N(n);return e.persistence.runTransaction("Synchronize last document change read time","readonly",t=>function(i){const s=hn(i);let r=K.min();return s.Kt({index:he.readTimeIndex,reverse:!0},(o,l,u)=>{l.readTime&&(r=Bu(l.readTime)),u.done()}).next(()=>r)}(t)).then(t=>{e.Kn=t})})).apply(this,arguments)}function aa(){return(aa=(0,S.Z)(function*(n,e,t,i){const s=N(n);let r=ee(),o=ct(),l=fu();for(const g of t){const _=e.zn(g.metadata.name);g.document&&(r=r.add(_)),o=o.insert(_,e.Hn(g)),l=l.insert(_,e.Jn(g.metadata.readTime))}const u=s.jn.newChangeBuffer({trackRemovals:!0}),d=yield Ui(s,(g=i,at(Ii(X.fromString(`__bundle__/docs/${g}`)))));var g;return s.persistence.runTransaction("Apply bundle documents","readwrite",g=>rh(g,u,o,K.min(),l).next(_=>(u.apply(g),_)).next(_=>s.ze.removeMatchingKeysForTargetId(g,d.targetId).next(()=>s.ze.addMatchingKeys(g,r,d.targetId)).next(()=>s.Qn.vn(g,_)).next(()=>_)))})).apply(this,arguments)}function Lp(n,e){return ca.apply(this,arguments)}function ca(){return(ca=(0,S.Z)(function*(n,e,t=ee()){const i=yield Ui(n,at(Qo(e.bundledQuery))),s=N(n);return s.persistence.runTransaction("Save named query","readwrite",r=>{const o=Re(e.readTime);if(i.snapshotVersion.compareTo(o)>=0)return s.Je.saveNamedQuery(r,e);const l=i.withResumeToken(Ae.EMPTY_BYTE_STRING,o);return s.Un=s.Un.insert(l.targetId,l),s.ze.updateTargetData(r,l).next(()=>s.ze.removeMatchingKeysForTargetId(r,i.targetId)).next(()=>s.ze.addMatchingKeys(r,t,i.targetId)).next(()=>s.Je.saveNamedQuery(r,e))})})).apply(this,arguments)}class Op{constructor(e){this.N=e,this.Yn=new Map,this.Xn=new Map}getBundleMetadata(e,t){return C.resolve(this.Yn.get(t))}saveBundleMetadata(e,t){var i;return this.Yn.set(t.id,{id:(i=t).id,version:i.version,createTime:Re(i.createTime)}),C.resolve()}getNamedQuery(e,t){return C.resolve(this.Xn.get(t))}saveNamedQuery(e,t){return this.Xn.set(t.name,{name:(i=t).name,query:Qo(i.bundledQuery),readTime:Re(i.readTime)}),C.resolve();var i}}class la{constructor(){this.Zn=new ue(Pe.ts),this.es=new ue(Pe.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,t){const i=new Pe(e,t);this.Zn=this.Zn.add(i),this.es=this.es.add(i)}ss(e,t){e.forEach(i=>this.addReference(i,t))}removeReference(e,t){this.rs(new Pe(e,t))}os(e,t){e.forEach(i=>this.removeReference(i,t))}cs(e){const t=new O(new X([])),i=new Pe(t,e),s=new Pe(t,e+1),r=[];return this.es.forEachInRange([i,s],o=>{this.rs(o),r.push(o.key)}),r}us(){this.Zn.forEach(e=>this.rs(e))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const t=new O(new X([])),i=new Pe(t,e),s=new Pe(t,e+1);let r=ee();return this.es.forEachInRange([i,s],o=>{r=r.add(o.key)}),r}containsKey(e){const t=new Pe(e,0),i=this.Zn.firstAfterOrEqual(t);return null!==i&&e.isEqual(i.key)}}class Pe{constructor(e,t){this.key=e,this.ls=t}static ts(e,t){return O.comparator(e.key,t.key)||H(e.ls,t.ls)}static ns(e,t){return H(e.ls,t.ls)||O.comparator(e.key,t.key)}}class Mp{constructor(e,t){this.Ht=e,this.referenceDelegate=t,this.In=[],this.fs=1,this.ds=new ue(Pe.ts)}checkEmpty(e){return C.resolve(0===this.In.length)}addMutationBatch(e,t,i,s){const r=this.fs;this.fs++;const o=new Zo(r,t,i,s);this.In.push(o);for(const l of s)this.ds=this.ds.add(new Pe(l.key,r)),this.Ht.addToCollectionParentIndex(e,l.key.path.popLast());return C.resolve(o)}lookupMutationBatch(e,t){return C.resolve(this.ws(t))}getNextMutationBatchAfterBatchId(e,t){const s=this._s(t+1),r=s<0?0:s;return C.resolve(this.In.length>r?this.In[r]:null)}getHighestUnacknowledgedBatchId(){return C.resolve(0===this.In.length?-1:this.fs-1)}getAllMutationBatches(e){return C.resolve(this.In.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const i=new Pe(t,0),s=new Pe(t,Number.POSITIVE_INFINITY),r=[];return this.ds.forEachInRange([i,s],o=>{const l=this.ws(o.ls);r.push(l)}),C.resolve(r)}getAllMutationBatchesAffectingDocumentKeys(e,t){let i=new ue(H);return t.forEach(s=>{const r=new Pe(s,0),o=new Pe(s,Number.POSITIVE_INFINITY);this.ds.forEachInRange([r,o],l=>{i=i.add(l.ls)})}),C.resolve(this.gs(i))}getAllMutationBatchesAffectingQuery(e,t){const i=t.path,s=i.length+1;let r=i;O.isDocumentKey(r)||(r=r.child(""));const o=new Pe(new O(r),0);let l=new ue(H);return this.ds.forEachWhile(u=>{const d=u.key.path;return!!i.isPrefixOf(d)&&(d.length===s&&(l=l.add(u.ls)),!0)},o),C.resolve(this.gs(l))}gs(e){const t=[];return e.forEach(i=>{const s=this.ws(i);null!==s&&t.push(s)}),t}removeMutationBatch(e,t){z(0===this.ys(t.batchId,"removed")),this.In.shift();let i=this.ds;return C.forEach(t.mutations,s=>{const r=new Pe(s.key,t.batchId);return i=i.delete(r),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.ds=i})}te(e){}containsKey(e,t){const i=new Pe(t,0),s=this.ds.firstAfterOrEqual(i);return C.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return C.resolve()}ys(e,t){return this._s(e)}_s(e){return 0===this.In.length?0:e-this.In[0].batchId}ws(e){const t=this._s(e);return t<0||t>=this.In.length?null:this.In[t]}}class Fp{constructor(e,t){this.Ht=e,this.ps=t,this.docs=new Ie(O.comparator),this.size=0}addEntry(e,t,i){const s=t.key,r=this.docs.get(s),o=r?r.size:0,l=this.ps(t);return this.docs=this.docs.insert(s,{document:t.clone(),size:l,readTime:i}),this.size+=l-o,this.Ht.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const i=this.docs.get(t);return C.resolve(i?i.document.clone():ae.newInvalidDocument(t))}getEntries(e,t){let i=ct();return t.forEach(s=>{const r=this.docs.get(s);i=i.insert(s,r?r.document.clone():ae.newInvalidDocument(s))}),C.resolve(i)}getDocumentsMatchingQuery(e,t,i){let s=ct();const r=new O(t.path.child("")),o=this.docs.getIteratorFrom(r);for(;o.hasNext();){const{key:l,value:{document:u,readTime:d}}=o.getNext();if(!t.path.isPrefixOf(l.path))break;d.compareTo(i)<=0||Ss(t,u)&&(s=s.insert(u.key,u.clone()))}return C.resolve(s)}Ts(e,t){return C.forEach(this.docs,i=>t(i))}newChangeBuffer(e){return new Up(this)}getSize(e){return C.resolve(this.size)}}class Up extends Wu{constructor(e){super(),this.Se=e}applyChanges(e){const t=[];return this.changes.forEach((i,s)=>{s.document.isValidDocument()?t.push(this.Se.addEntry(e,s.document,this.getReadTime(i))):this.Se.removeEntry(i)}),C.waitFor(t)}getFromCache(e,t){return this.Se.getEntry(e,t)}getAllFromCache(e,t){return this.Se.getEntries(e,t)}}class Vp{constructor(e){this.persistence=e,this.Es=new Fi(t=>Ts(t),wr),this.lastRemoteSnapshotVersion=K.min(),this.highestTargetId=0,this.Is=0,this.As=new la,this.targetCount=0,this.Rs=Hn.se()}forEachTarget(e,t){return this.Es.forEach((i,s)=>t(s)),C.resolve()}getLastRemoteSnapshotVersion(e){return C.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return C.resolve(this.Is)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),C.resolve(this.highestTargetId)}setTargetsMetadata(e,t,i){return i&&(this.lastRemoteSnapshotVersion=i),t>this.Is&&(this.Is=t),C.resolve()}ae(e){this.Es.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Rs=new Hn(t),this.highestTargetId=t),e.sequenceNumber>this.Is&&(this.Is=e.sequenceNumber)}addTargetData(e,t){return this.ae(t),this.targetCount+=1,C.resolve()}updateTargetData(e,t){return this.ae(t),C.resolve()}removeTargetData(e,t){return this.Es.delete(t.target),this.As.cs(t.targetId),this.targetCount-=1,C.resolve()}removeTargets(e,t,i){let s=0;const r=[];return this.Es.forEach((o,l)=>{l.sequenceNumber<=t&&null===i.get(l.targetId)&&(this.Es.delete(o),r.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),C.waitFor(r).next(()=>s)}getTargetCount(e){return C.resolve(this.targetCount)}getTargetData(e,t){const i=this.Es.get(t)||null;return C.resolve(i)}addMatchingKeys(e,t,i){return this.As.ss(t,i),C.resolve()}removeMatchingKeys(e,t,i){this.As.os(t,i);const s=this.persistence.referenceDelegate,r=[];return s&&t.forEach(o=>{r.push(s.markPotentiallyOrphaned(e,o))}),C.waitFor(r)}removeMatchingKeysForTargetId(e,t){return this.As.cs(t),C.resolve()}getMatchingKeysForTargetId(e,t){const i=this.As.hs(t);return C.resolve(i)}containsKey(e,t){return C.resolve(this.As.containsKey(t))}}class Bp{constructor(e,t){this.bs={},this.Le=new tt(0),this.Be=!1,this.Be=!0,this.referenceDelegate=e(this),this.ze=new Vp(this),this.Ht=new yp,this.He=new Fp(this.Ht,i=>this.referenceDelegate.Ps(i)),this.N=new Uu(t),this.Je=new Op(this.N)}start(){return Promise.resolve()}shutdown(){return this.Be=!1,Promise.resolve()}get started(){return this.Be}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.Ht}getMutationQueue(e){let t=this.bs[e.toKey()];return t||(t=new Mp(this.Ht,this.referenceDelegate),this.bs[e.toKey()]=t),t}getTargetCache(){return this.ze}getRemoteDocumentCache(){return this.He}getBundleCache(){return this.Je}runTransaction(e,t,i){R("MemoryPersistence","Starting transaction:",e);const s=new qp(this.Le.next());return this.referenceDelegate.vs(),i(s).next(r=>this.referenceDelegate.Vs(s).next(()=>r)).toPromise().then(r=>(s.raiseOnCommittedEvent(),r))}Ss(e,t){return C.or(Object.values(this.bs).map(i=>()=>i.containsKey(e,t)))}}class qp extends Ou{constructor(e){super(),this.currentSequenceNumber=e}}class ua{constructor(e){this.persistence=e,this.Ds=new la,this.Cs=null}static Ns(e){return new ua(e)}get xs(){if(this.Cs)return this.Cs;throw M()}addReference(e,t,i){return this.Ds.addReference(i,t),this.xs.delete(i.toString()),C.resolve()}removeReference(e,t,i){return this.Ds.removeReference(i,t),this.xs.add(i.toString()),C.resolve()}markPotentiallyOrphaned(e,t){return this.xs.add(t.toString()),C.resolve()}removeTarget(e,t){this.Ds.cs(t.targetId).forEach(s=>this.xs.add(s.toString()));const i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(e,t.targetId).next(s=>{s.forEach(r=>this.xs.add(r.toString()))}).next(()=>i.removeTargetData(e,t))}vs(){this.Cs=new Set}Vs(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return C.forEach(this.xs,i=>{const s=O.fromPath(i);return this.ks(e,s).next(r=>{r||t.removeEntry(s)})}).next(()=>(this.Cs=null,t.apply(e)))}updateLimboDocument(e,t){return this.ks(e,t).next(i=>{i?this.xs.delete(t.toString()):this.xs.add(t.toString())})}Ps(e){return 0}ks(e,t){return C.or([()=>C.resolve(this.Ds.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ss(e,t)])}}function ch(n,e){return`firestore_clients_${n}_${e}`}function lh(n,e,t){let i=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(i+=`_${e.uid}`),i}function ha(n,e){return`firestore_targets_${n}_${e}`}class Ur{constructor(e,t,i,s){this.user=e,this.batchId=t,this.state=i,this.error=s}static $s(e,t,i){const s=JSON.parse(i);let r,o="object"==typeof s&&-1!==["pending","acknowledged","rejected"].indexOf(s.state)&&(void 0===s.error||"object"==typeof s.error);return o&&s.error&&(o="string"==typeof s.error.message&&"string"==typeof s.error.code,o&&(r=new A(s.error.code,s.error.message))),o?new Ur(e,t,s.state,r):(ve("SharedClientState",`Failed to parse mutation state for ID '${t}': ${i}`),null)}Os(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Fs{constructor(e,t,i){this.targetId=e,this.state=t,this.error=i}static $s(e,t){const i=JSON.parse(t);let s,r="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return r&&i.error&&(r="string"==typeof i.error.message&&"string"==typeof i.error.code,r&&(s=new A(i.error.code,i.error.message))),r?new Fs(e,i.state,s):(ve("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Os(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Vr{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const i=JSON.parse(t);let s="object"==typeof i&&i.activeTargetIds instanceof Array,r=Ar();for(let o=0;s&&o<i.activeTargetIds.length;++o)s=Ul(i.activeTargetIds[o]),r=r.add(i.activeTargetIds[o]);return s?new Vr(e,r):(ve("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class da{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new da(t.clientId,t.onlineState):(ve("SharedClientState",`Failed to parse online state: ${e}`),null)}}class fa{constructor(){this.activeTargetIds=Ar()}Fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Ms(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Os(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class pa{constructor(e,t,i,s,r){this.window=e,this.Oe=t,this.persistenceKey=i,this.Ls=s,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Bs=this.Us.bind(this),this.qs=new Ie(H),this.started=!1,this.Ks=[];const o=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=r,this.js=ch(this.persistenceKey,this.Ls),this.Qs=`firestore_sequence_number_${this.persistenceKey}`,this.qs=this.qs.insert(this.Ls,new fa),this.Ws=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Gs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.zs=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.Hs=`firestore_online_state_${this.persistenceKey}`,this.Js=function(l){return`firestore_bundle_loaded_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.Bs)}static bt(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,S.Z)(function*(){const t=yield e.syncEngine.pn();for(const s of t){if(s===e.Ls)continue;const r=e.getItem(ch(e.persistenceKey,s));if(r){const o=Vr.$s(s,r);o&&(e.qs=e.qs.insert(o.clientId,o))}}e.Ys();const i=e.storage.getItem(e.Hs);if(i){const s=e.Xs(i);s&&e.Zs(s)}for(const s of e.Ks)e.Us(s);e.Ks=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.Qs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ti(this.qs)}isActiveQueryTarget(e){let t=!1;return this.qs.forEach((i,s)=>{s.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.ei(e,"pending")}updateMutationState(e,t,i){this.ei(e,t,i),this.ni(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(ha(this.persistenceKey,e));if(i){const s=Fs.$s(e,i);s&&(t=s.state)}}return this.si.Fs(e),this.Ys(),t}removeLocalQueryTarget(e){this.si.Ms(e),this.Ys()}isLocalQueryTarget(e){return this.si.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(ha(this.persistenceKey,e))}updateQueryState(e,t,i){this.ii(e,t,i)}handleUserChange(e,t,i){t.forEach(s=>{this.ni(s)}),this.currentUser=e,i.forEach(s=>{this.addPendingMutation(s)})}setOnlineState(e){this.ri(e)}notifyBundleLoaded(){this.oi()}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Bs),this.removeItem(this.js),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return R("SharedClientState","READ",e,t),t}setItem(e,t){R("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){R("SharedClientState","REMOVE",e),this.storage.removeItem(e)}Us(e){var t=this;const i=e;if(i.storageArea===this.storage){if(R("SharedClientState","EVENT",i.key,i.newValue),i.key===this.js)return void ve("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Oe.enqueueRetryable((0,S.Z)(function*(){if(t.started){if(null!==i.key)if(t.Ws.test(i.key)){if(null==i.newValue){const s=t.ai(i.key);return t.ci(s,null)}{const s=t.ui(i.key,i.newValue);if(s)return t.ci(s.clientId,s)}}else if(t.Gs.test(i.key)){if(null!==i.newValue){const s=t.hi(i.key,i.newValue);if(s)return t.li(s)}}else if(t.zs.test(i.key)){if(null!==i.newValue){const s=t.fi(i.key,i.newValue);if(s)return t.di(s)}}else if(i.key===t.Hs){if(null!==i.newValue){const s=t.Xs(i.newValue);if(s)return t.Zs(s)}}else if(i.key===t.Qs){const s=function(r){let o=tt.T;if(null!=r)try{const l=JSON.parse(r);z("number"==typeof l),o=l}catch(l){ve("SharedClientState","Failed to read sequence number from WebStorage",l)}return o}(i.newValue);s!==tt.T&&t.sequenceNumberHandler(s)}else if(i.key===t.Js)return t.syncEngine.wi()}else t.Ks.push(i)}))}}get si(){return this.qs.get(this.Ls)}Ys(){this.setItem(this.js,this.si.Os())}ei(e,t,i){const s=new Ur(this.currentUser,e,t,i),r=lh(this.persistenceKey,this.currentUser,e);this.setItem(r,s.Os())}ni(e){const t=lh(this.persistenceKey,this.currentUser,e);this.removeItem(t)}ri(e){this.storage.setItem(this.Hs,JSON.stringify({clientId:this.Ls,onlineState:e}))}ii(e,t,i){const s=ha(this.persistenceKey,e),r=new Fs(e,t,i);this.setItem(s,r.Os())}oi(){this.setItem(this.Js,"value-not-used")}ai(e){const t=this.Ws.exec(e);return t?t[1]:null}ui(e,t){const i=this.ai(e);return Vr.$s(i,t)}hi(e,t){const i=this.Gs.exec(e),s=Number(i[1]);return Ur.$s(new ke(void 0!==i[2]?i[2]:null),s,t)}fi(e,t){const i=this.zs.exec(e),s=Number(i[1]);return Fs.$s(s,t)}Xs(e){return da.$s(e)}li(e){var t=this;return(0,S.Z)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine._i(e.batchId,e.state,e.error);R("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}di(e){return this.syncEngine.mi(e.targetId,e.state,e.error)}ci(e,t){const i=t?this.qs.insert(e,t):this.qs.remove(e),s=this.ti(this.qs),r=this.ti(i),o=[],l=[];return r.forEach(u=>{s.has(u)||o.push(u)}),s.forEach(u=>{r.has(u)||l.push(u)}),this.syncEngine.gi(o,l).then(()=>{this.qs=i})}Zs(e){this.qs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ti(e){let t=Ar();return e.forEach((i,s)=>{t=t.unionWith(s.activeTargetIds)}),t}}class uh{constructor(){this.yi=new fa,this.pi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,i){}addLocalQueryTarget(e){return this.yi.Fs(e),this.pi[e]||"not-current"}updateQueryState(e,t,i){this.pi[e]=t}removeLocalQueryTarget(e){this.yi.Ms(e)}isLocalQueryTarget(e){return this.yi.activeTargetIds.has(e)}clearQueryState(e){delete this.pi[e]}getAllActiveQueryTargets(){return this.yi.activeTargetIds}isActiveQueryTarget(e){return this.yi.activeTargetIds.has(e)}start(){return this.yi=new fa,Promise.resolve()}handleUserChange(e,t,i){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(){}}class Gp{Ti(e){}shutdown(){}}class hh{constructor(){this.Ei=()=>this.Ii(),this.Ai=()=>this.Ri(),this.bi=[],this.Pi()}Ti(e){this.bi.push(e)}shutdown(){window.removeEventListener("online",this.Ei),window.removeEventListener("offline",this.Ai)}Pi(){window.addEventListener("online",this.Ei),window.addEventListener("offline",this.Ai)}Ii(){R("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.bi)e(0)}Ri(){R("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.bi)e(1)}static bt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const zp={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class jp{constructor(e){this.vi=e.vi,this.Vi=e.Vi}Si(e){this.Di=e}Ci(e){this.Ni=e}onMessage(e){this.xi=e}close(){this.Vi()}send(e){this.vi(e)}ki(){this.Di()}$i(e){this.Ni(e)}Oi(e){this.xi(e)}}class Kp extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId,this.Fi=(e.ssl?"https":"http")+"://"+e.host,this.Mi="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Li(e,t,i,s){const r=this.Bi(e,t);R("RestConnection","Sending: ",r,i);const o={};return this.Ui(o,s),this.qi(e,r,o,i).then(l=>(R("RestConnection","Received: ",l),l),l=>{throw ys("RestConnection",`${e} failed with error: `,l,"url: ",r,"request:",i),l})}Ki(e,t,i,s){return this.Li(e,t,i,s)}Ui(e,t){if(e["X-Goog-Api-Client"]="gl-js/ fire/"+_i,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t)for(const i in t.authHeaders)t.authHeaders.hasOwnProperty(i)&&(e[i]=t.authHeaders[i])}Bi(e,t){return`${this.Fi}/v1/${t}:${zp[e]}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}qi(e,t,i,s){return new Promise((r,o)=>{const l=new ff;l.listenOnce(uf.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case Co.NO_ERROR:const d=l.getResponseJson();R("Connection","XHR received:",JSON.stringify(d)),r(d);break;case Co.TIMEOUT:R("Connection",'RPC "'+e+'" timed out'),o(new A(T.DEADLINE_EXCEEDED,"Request time out"));break;case Co.HTTP_ERROR:const g=l.getStatus();if(R("Connection",'RPC "'+e+'" failed with status:',g,"response text:",l.getResponseText()),g>0){const _=l.getResponseJson().error;if(_&&_.status&&_.message){const E=function(x){const P=x.toLowerCase().replace(/_/g,"-");return Object.values(T).indexOf(P)>=0?P:T.UNKNOWN}(_.status);o(new A(E,_.message))}else o(new A(T.UNKNOWN,"Server responded with status "+l.getStatus()))}else o(new A(T.UNAVAILABLE,"Connection failed."));break;default:M()}}finally{R("Connection",'RPC "'+e+'" completed.')}});const u=JSON.stringify(s);l.send(t,"POST",u,i,15)})}ji(e,t){const i=[this.Fi,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=cf(),r=lf(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(o.xmlHttpFactory=new df({})),this.Ui(o.initMessageHeaders,t),(0,$.uI)()||(0,$.b$)()||(0,$.d)()||(0,$.w1)()||(0,$.Mn)()||(0,$.ru)()||(o.httpHeadersOverwriteParam="$httpHeaders");const l=i.join("");R("Connection","Creating WebChannel: "+l,o);const u=s.createWebChannel(l,o);let d=!1,g=!1;const _=new jp({vi:x=>{g?R("Connection","Not sending because WebChannel is closed:",x):(d||(R("Connection","Opening WebChannel transport."),u.open(),d=!0),R("Connection","WebChannel sending:",x),u.send(x))},Vi:()=>u.close()}),E=(x,P,F)=>{x.listen(P,Z=>{try{F(Z)}catch(fe){setTimeout(()=>{throw fe},0)}})};return E(u,mr.EventType.OPEN,()=>{g||R("Connection","WebChannel transport opened.")}),E(u,mr.EventType.CLOSE,()=>{g||(g=!0,R("Connection","WebChannel transport closed"),_.$i())}),E(u,mr.EventType.ERROR,x=>{g||(g=!0,ys("Connection","WebChannel transport errored:",x),_.$i(new A(T.UNAVAILABLE,"The operation could not be completed")))}),E(u,mr.EventType.MESSAGE,x=>{var P;if(!g){const F=x.data[0];z(!!F);const Z=F,fe=Z.error||(null===(P=Z[0])||void 0===P?void 0:P.error);if(fe){R("Connection","WebChannel received error:",fe);const gt=fe.status;let xt=function(Ht){const to=Te[Ht];if(void 0!==to)return hu(to)}(gt),$t=fe.message;void 0===xt&&(xt=T.INTERNAL,$t="Unknown error status: "+gt+" with message "+fe.message),g=!0,_.$i(new A(xt,$t)),u.close()}else R("Connection","WebChannel received:",F),_.Oi(F)}}),E(r,hf.STAT_EVENT,x=>{x.stat===Rl.PROXY?R("Connection","Detected buffering proxy"):x.stat===Rl.NOPROXY&&R("Connection","Detected no buffering proxy")}),setTimeout(()=>{_.ki()},0),_}}function dh(){return"undefined"!=typeof window?window:null}function Br(){return"undefined"!=typeof document?document:null}function Us(n){return new Xf(n,!0)}class ga{constructor(e,t,i=1e3,s=1.5,r=6e4){this.Oe=e,this.timerId=t,this.Qi=i,this.Wi=s,this.Gi=r,this.zi=0,this.Hi=null,this.Ji=Date.now(),this.reset()}reset(){this.zi=0}Yi(){this.zi=this.Gi}Xi(e){this.cancel();const t=Math.floor(this.zi+this.Zi()),i=Math.max(0,Date.now()-this.Ji),s=Math.max(0,t-i);s>0&&R("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.zi} ms, delay with jitter: ${t} ms, last attempt: ${i} ms ago)`),this.Hi=this.Oe.enqueueAfterDelay(this.timerId,s,()=>(this.Ji=Date.now(),e())),this.zi*=this.Wi,this.zi<this.Qi&&(this.zi=this.Qi),this.zi>this.Gi&&(this.zi=this.Gi)}tr(){null!==this.Hi&&(this.Hi.skipDelay(),this.Hi=null)}cancel(){null!==this.Hi&&(this.Hi.cancel(),this.Hi=null)}Zi(){return(Math.random()-.5)*this.zi}}class fh{constructor(e,t,i,s,r,o){this.Oe=e,this.er=i,this.nr=s,this.credentialsProvider=r,this.listener=o,this.state=0,this.sr=0,this.ir=null,this.stream=null,this.rr=new ga(e,t)}ar(){return 1===this.state||2===this.state||4===this.state}cr(){return 2===this.state}start(){3!==this.state?this.auth():this.ur()}stop(){var e=this;return(0,S.Z)(function*(){e.ar()&&(yield e.close(0))})()}hr(){this.state=0,this.rr.reset()}lr(){this.cr()&&null===this.ir&&(this.ir=this.Oe.enqueueAfterDelay(this.er,6e4,()=>this.dr()))}wr(e){this._r(),this.stream.send(e)}dr(){var e=this;return(0,S.Z)(function*(){if(e.cr())return e.close(0)})()}_r(){this.ir&&(this.ir.cancel(),this.ir=null)}close(e,t){var i=this;return(0,S.Z)(function*(){i._r(),i.rr.cancel(),i.sr++,3!==e?i.rr.reset():t&&t.code===T.RESOURCE_EXHAUSTED?(ve(t.toString()),ve("Using maximum backoff delay to prevent overloading the backend."),i.rr.Yi()):t&&t.code===T.UNAUTHENTICATED&&i.credentialsProvider.invalidateToken(),null!==i.stream&&(i.mr(),i.stream.close(),i.stream=null),i.state=e,yield i.listener.Ci(t)})()}mr(){}auth(){this.state=1;const e=this.gr(this.sr),t=this.sr;this.credentialsProvider.getToken().then(i=>{this.sr===t&&this.yr(i)},i=>{e(()=>{const s=new A(T.UNKNOWN,"Fetching auth token failed: "+i.message);return this.pr(s)})})}yr(e){const t=this.gr(this.sr);this.stream=this.Tr(e),this.stream.Si(()=>{t(()=>(this.state=2,this.listener.Si()))}),this.stream.Ci(i=>{t(()=>this.pr(i))}),this.stream.onMessage(i=>{t(()=>this.onMessage(i))})}ur(){var e=this;this.state=4,this.rr.Xi((0,S.Z)(function*(){e.state=0,e.start()}))}pr(e){return R("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(3,e)}gr(e){return t=>{this.Oe.enqueueAndForget(()=>this.sr===e?t():(R("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Zp extends fh{constructor(e,t,i,s,r){super(e,"listen_stream_connection_backoff","listen_stream_idle",t,i,r),this.N=s}Tr(e){return this.nr.ji("Listen",e)}onMessage(e){this.rr.reset();const t=function(n,e){let t;if("targetChange"in e){const i="NO_CHANGE"===(u=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===u?1:"REMOVE"===u?2:"CURRENT"===u?3:"RESET"===u?4:M(),s=e.targetChange.targetIds||[],r=function(u,d){return u.D?(z(void 0===d||"string"==typeof d),Ae.fromBase64String(d||"")):(z(void 0===d||d instanceof Uint8Array),Ae.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=void 0===u.code?T.UNKNOWN:hu(u.code);return new A(d,u.message||"")}(o);t=new gu(i,s,r,l||null)}else if("documentChange"in e){const i=e.documentChange,s=Et(n,i.document.name),r=Re(i.document.updateTime),o=new Ue({mapValue:{fields:i.document.fields}}),l=ae.newFoundDocument(s,r,o);t=new Rr(i.targetIds||[],i.removedTargetIds||[],l.key,l)}else if("documentDelete"in e){const i=e.documentDelete,s=Et(n,i.document),r=i.readTime?Re(i.readTime):K.min(),o=ae.newNoDocument(s,r);t=new Rr([],i.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const i=e.documentRemove,s=Et(n,i.document);t=new Rr([],i.removedTargetIds||[],s,null)}else{if(!("filter"in e))return M();{const i=e.filter,r=new zf(i.count||0);t=new pu(i.targetId,r)}}var u;return t}(this.N,e),i=function(s){if(!("targetChange"in s))return K.min();const r=s.targetChange;return r.targetIds&&r.targetIds.length?K.min():r.readTime?Re(r.readTime):K.min()}(e);return this.listener.Er(t,i)}Ir(e){const t={};t.database=ks(this.N),t.addTarget=function(s,r){let o;const l=r.target;return o=br(l)?{documents:Du(s,l)}:{query:xu(s,l)},o.targetId=r.targetId,r.resumeToken.approximateByteSize()>0?o.resumeToken=vu(s,r.resumeToken):r.snapshotVersion.compareTo(K.min())>0&&(o.readTime=Ps(s,r.snapshotVersion.toTimestamp())),o}(this.N,e);const i=function(n,e){const t=function(i,s){switch(s){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return M()}}(0,e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);i&&(t.labels=i),this.wr(t)}Ar(e){const t={};t.database=ks(this.N),t.removeTarget=e,this.wr(t)}}class $p extends fh{constructor(e,t,i,s,r){super(e,"write_stream_connection_backoff","write_stream_idle",t,i,r),this.N=s,this.Rr=!1}get br(){return this.Rr}start(){this.Rr=!1,this.lastStreamToken=void 0,super.start()}mr(){this.Rr&&this.Pr([])}Tr(e){return this.nr.ji("Write",e)}onMessage(e){if(z(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Rr){this.rr.reset();const t=function(n,e){return n&&n.length>0?(z(void 0!==e),n.map(t=>function(i,s){let r=Re(i.updateTime?i.updateTime:s);return r.isEqual(K.min())&&(r=Re(s)),new Bf(r,i.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),i=Re(e.commitTime);return this.listener.vr(i,t)}return z(!e.writeResults||0===e.writeResults.length),this.Rr=!0,this.listener.Vr()}Sr(){const e={};e.database=ks(this.N),this.wr(e)}Pr(e){const t={streamToken:this.lastStreamToken,writes:e.map(i=>Pr(this.N,i))};this.wr(t)}}class Hp extends class{}{constructor(e,t,i){super(),this.credentials=e,this.nr=t,this.N=i,this.Dr=!1}Cr(){if(this.Dr)throw new A(T.FAILED_PRECONDITION,"The client has already been terminated.")}Li(e,t,i){return this.Cr(),this.credentials.getToken().then(s=>this.nr.Li(e,t,i,s)).catch(s=>{throw"FirebaseError"===s.name?(s.code===T.UNAUTHENTICATED&&this.credentials.invalidateToken(),s):new A(T.UNKNOWN,s.toString())})}Ki(e,t,i){return this.Cr(),this.credentials.getToken().then(s=>this.nr.Ki(e,t,i,s)).catch(s=>{throw"FirebaseError"===s.name?(s.code===T.UNAUTHENTICATED&&this.credentials.invalidateToken(),s):new A(T.UNKNOWN,s.toString())})}terminate(){this.Dr=!0}}class Yp{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.Nr=0,this.kr=null,this.$r=!0}Or(){0===this.Nr&&(this.Fr("Unknown"),this.kr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.kr=null,this.Mr("Backend didn't respond within 10 seconds."),this.Fr("Offline"),Promise.resolve())))}Lr(e){"Online"===this.state?this.Fr("Unknown"):(this.Nr++,this.Nr>=1&&(this.Br(),this.Mr(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.Fr("Offline")))}set(e){this.Br(),this.Nr=0,"Online"===e&&(this.$r=!1),this.Fr(e)}Fr(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}Mr(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.$r?(ve(t),this.$r=!1):R("OnlineStateTracker",t)}Br(){null!==this.kr&&(this.kr.cancel(),this.kr=null)}}class Qp{constructor(e,t,i,s,r){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=i,this.remoteSyncer={},this.Ur=[],this.qr=new Map,this.Kr=new Set,this.jr=[],this.Qr=r,this.Qr.Ti(l=>{i.enqueueAndForget((0,S.Z)(function*(){var u;dn(o)&&(R("RemoteStore","Restarting streams for network reachability change."),yield(u=(0,S.Z)(function*(d){const g=N(d);g.Kr.add(4),yield Bi(g),g.Wr.set("Unknown"),g.Kr.delete(4),yield Vs(g)}),function(d){return u.apply(this,arguments)})(o))}))}),this.Wr=new Yp(i,s)}}function Vs(n){return ma.apply(this,arguments)}function ma(){return(ma=(0,S.Z)(function*(n){if(dn(n))for(const e of n.jr)yield e(!0)})).apply(this,arguments)}function Bi(n){return ya.apply(this,arguments)}function ya(){return(ya=(0,S.Z)(function*(n){for(const e of n.jr)yield e(!1)})).apply(this,arguments)}function qr(n,e){const t=N(n);t.qr.has(e.targetId)||(t.qr.set(e.targetId,e),wa(t)?va(t):Gi(t).cr()&&_a(t,e))}function Bs(n,e){const t=N(n),i=Gi(t);t.qr.delete(e),i.cr()&&ph(t,e),0===t.qr.size&&(i.cr()?i.lr():dn(t)&&t.Wr.set("Unknown"))}function _a(n,e){n.Gr.Y(e.targetId),Gi(n).Ir(e)}function ph(n,e){n.Gr.Y(e),Gi(n).Ar(e)}function va(n){n.Gr=new Yf({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Tt:e=>n.qr.get(e)||null}),Gi(n).start(),n.Wr.Or()}function wa(n){return dn(n)&&!Gi(n).ar()&&n.qr.size>0}function dn(n){return 0===N(n).Kr.size}function gh(n){n.Gr=void 0}function Wp(n){return ba.apply(this,arguments)}function ba(){return(ba=(0,S.Z)(function*(n){n.qr.forEach((e,t)=>{_a(n,e)})})).apply(this,arguments)}function Xp(n,e){return Ta.apply(this,arguments)}function Ta(){return(Ta=(0,S.Z)(function*(n,e){gh(n),wa(n)?(n.Wr.Lr(e),va(n)):n.Wr.set("Unknown")})).apply(this,arguments)}function Jp(n,e,t){return Ea.apply(this,arguments)}function Ea(){return(Ea=(0,S.Z)(function*(n,e,t){if(n.Wr.set("Online"),e instanceof gu&&2===e.state&&e.cause)try{yield(i=(0,S.Z)(function*(s,r){const o=r.cause;for(const l of r.targetIds)s.qr.has(l)&&(yield s.remoteSyncer.rejectListen(l,o),s.qr.delete(l),s.Gr.removeTarget(l))}),function(s,r){return i.apply(this,arguments)})(n,e)}catch(i){R("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),i),yield Gr(n,i)}else if(e instanceof Rr?n.Gr.rt(e):e instanceof pu?n.Gr.ft(e):n.Gr.ct(e),!t.isEqual(K.min()))try{const i=yield sh(n.localStore);t.compareTo(i)>=0&&(yield function(s,r){const o=s.Gr._t(r);return o.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.qr.get(u);d&&s.qr.set(u,d.withResumeToken(l.resumeToken,r))}}),o.targetMismatches.forEach(l=>{const u=s.qr.get(l);if(!u)return;s.qr.set(l,u.withResumeToken(Ae.EMPTY_BYTE_STRING,u.snapshotVersion)),ph(s,l);const d=new cn(u.target,l,1,u.sequenceNumber);_a(s,d)}),s.remoteSyncer.applyRemoteEvent(o)}(n,t))}catch(i){R("RemoteStore","Failed to raise snapshot:",i),yield Gr(n,i)}var i})).apply(this,arguments)}function Gr(n,e,t){return Ia.apply(this,arguments)}function Ia(){return(Ia=(0,S.Z)(function*(n,e,t){if(!Zn(e))throw e;n.Kr.add(1),yield Bi(n),n.Wr.set("Offline"),t||(t=()=>sh(n.localStore)),n.asyncQueue.enqueueRetryable((0,S.Z)(function*(){R("RemoteStore","Retrying IndexedDB access"),yield t(),n.Kr.delete(1),yield Vs(n)}))})).apply(this,arguments)}function mh(n,e){return e().catch(t=>Gr(n,t,e))}function qi(n){return Sa.apply(this,arguments)}function Sa(){return(Sa=(0,S.Z)(function*(n){const e=N(n),t=fn(e);let i=e.Ur.length>0?e.Ur[e.Ur.length-1].batchId:-1;for(;eg(e);)try{const s=yield Pp(e.localStore,i);if(null===s){0===e.Ur.length&&t.lr();break}i=s.batchId,tg(e,s)}catch(s){yield Gr(e,s)}yh(e)&&_h(e)})).apply(this,arguments)}function eg(n){return dn(n)&&n.Ur.length<10}function tg(n,e){n.Ur.push(e);const t=fn(n);t.cr()&&t.br&&t.Pr(e.mutations)}function yh(n){return dn(n)&&!fn(n).ar()&&n.Ur.length>0}function _h(n){fn(n).start()}function ng(n){return Da.apply(this,arguments)}function Da(){return(Da=(0,S.Z)(function*(n){fn(n).Sr()})).apply(this,arguments)}function ig(n){return xa.apply(this,arguments)}function xa(){return(xa=(0,S.Z)(function*(n){const e=fn(n);for(const t of n.Ur)e.Pr(t.mutations)})).apply(this,arguments)}function sg(n,e,t){return Ca.apply(this,arguments)}function Ca(){return(Ca=(0,S.Z)(function*(n,e,t){const i=n.Ur.shift(),s=$o.from(i,e,t);yield mh(n,()=>n.remoteSyncer.applySuccessfulWrite(s)),yield qi(n)})).apply(this,arguments)}function rg(n,e){return Aa.apply(this,arguments)}function Aa(){return(Aa=(0,S.Z)(function*(n,e){var t;e&&fn(n).br&&(yield(t=(0,S.Z)(function*(i,s){if(uu(r=s.code)&&r!==T.ABORTED){const o=i.Ur.shift();fn(i).hr(),yield mh(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield qi(i)}var r}),function(i,s){return t.apply(this,arguments)})(n,e)),yh(n)&&_h(n)})).apply(this,arguments)}function Ra(n,e){return Pa.apply(this,arguments)}function Pa(){return(Pa=(0,S.Z)(function*(n,e){const t=N(n);e?(t.Kr.delete(2),yield Vs(t)):e||(t.Kr.add(2),yield Bi(t),t.Wr.set("Unknown"))})).apply(this,arguments)}function Gi(n){return n.zr||(n.zr=function(e,t,i){const s=N(e);return s.Cr(),new Zp(t,s.nr,s.credentials,s.N,i)}(n.datastore,n.asyncQueue,{Si:Wp.bind(null,n),Ci:Xp.bind(null,n),Er:Jp.bind(null,n)}),n.jr.push(function(){var e=(0,S.Z)(function*(t){t?(n.zr.hr(),wa(n)?va(n):n.Wr.set("Unknown")):(yield n.zr.stop(),gh(n))});return function(t){return e.apply(this,arguments)}}())),n.zr}function fn(n){return n.Hr||(n.Hr=function(e,t,i){const s=N(e);return s.Cr(),new $p(t,s.nr,s.credentials,s.N,i)}(n.datastore,n.asyncQueue,{Si:ng.bind(null,n),Ci:rg.bind(null,n),Vr:ig.bind(null,n),vr:sg.bind(null,n)}),n.jr.push(function(){var e=(0,S.Z)(function*(t){t?(n.Hr.hr(),yield qi(n)):(yield n.Hr.stop(),n.Ur.length>0&&(R("RemoteStore",`Stopping write stream with ${n.Ur.length} pending writes`),n.Ur=[]))});return function(t){return e.apply(this,arguments)}}())),n.Hr}class Na{constructor(e,t,i,s,r){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=i,this.op=s,this.removalCallback=r,this.deferred=new xe,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}static createAndSchedule(e,t,i,s,r){const o=Date.now()+i,l=new Na(e,t,o,s,r);return l.start(i),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new A(T.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function zi(n,e){if(ve("AsyncQueue",`${e}: ${n}`),Zn(n))return new A(T.UNAVAILABLE,`${e}: ${n}`);throw n}class ji{constructor(e){this.comparator=e?(t,i)=>e(t,i)||O.comparator(t.key,i.key):(t,i)=>O.comparator(t.key,i.key),this.keyedMap=Go(),this.sortedSet=new Ie(this.comparator)}static emptySet(e){return new ji(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,i)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ji)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),i=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,r=i.getNext().key;if(!s.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const i=new ji;return i.comparator=this.comparator,i.keyedMap=e,i.sortedSet=t,i}}class vh{constructor(){this.Jr=new Ie(O.comparator)}track(e){const t=e.doc.key,i=this.Jr.get(t);i?0!==e.type&&3===i.type?this.Jr=this.Jr.insert(t,e):3===e.type&&1!==i.type?this.Jr=this.Jr.insert(t,{type:i.type,doc:e.doc}):2===e.type&&2===i.type?this.Jr=this.Jr.insert(t,{type:2,doc:e.doc}):2===e.type&&0===i.type?this.Jr=this.Jr.insert(t,{type:0,doc:e.doc}):1===e.type&&0===i.type?this.Jr=this.Jr.remove(t):1===e.type&&2===i.type?this.Jr=this.Jr.insert(t,{type:1,doc:i.doc}):0===e.type&&1===i.type?this.Jr=this.Jr.insert(t,{type:2,doc:e.doc}):M():this.Jr=this.Jr.insert(t,e)}Yr(){const e=[];return this.Jr.inorderTraversal((t,i)=>{e.push(i)}),e}}class Ki{constructor(e,t,i,s,r,o,l,u){this.query=e,this.docs=t,this.oldDocs=i,this.docChanges=s,this.mutatedKeys=r,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u}static fromInitialDocuments(e,t,i,s){const r=[];return t.forEach(o=>{r.push({type:0,doc:o})}),new Ki(e,t,ji.emptySet(t),r,i,s,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Is(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,i=e.docChanges;if(t.length!==i.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==i[s].type||!t[s].doc.isEqual(i[s].doc))return!1;return!0}}class og{constructor(){this.Xr=void 0,this.listeners=[]}}class ag{constructor(){this.queries=new Fi(e=>Yl(e),Is),this.onlineState="Unknown",this.Zr=new Set}}function ka(n,e){return La.apply(this,arguments)}function La(){return(La=(0,S.Z)(function*(n,e){const t=N(n),i=e.query;let s=!1,r=t.queries.get(i);if(r||(s=!0,r=new og),s)try{r.Xr=yield t.onListen(i)}catch(o){const l=zi(o,`Initialization of query '${Vo(e.query)}' failed`);return void e.onError(l)}t.queries.set(i,r),r.listeners.push(e),e.eo(t.onlineState),r.Xr&&e.no(r.Xr)&&Fa(t)})).apply(this,arguments)}function Oa(n,e){return Ma.apply(this,arguments)}function Ma(){return(Ma=(0,S.Z)(function*(n,e){const t=N(n),i=e.query;let s=!1;const r=t.queries.get(i);if(r){const o=r.listeners.indexOf(e);o>=0&&(r.listeners.splice(o,1),s=0===r.listeners.length)}if(s)return t.queries.delete(i),t.onUnlisten(i)})).apply(this,arguments)}function cg(n,e){const t=N(n);let i=!1;for(const s of e){const o=t.queries.get(s.query);if(o){for(const l of o.listeners)l.no(s)&&(i=!0);o.Xr=s}}i&&Fa(t)}function lg(n,e,t){const i=N(n),s=i.queries.get(e);if(s)for(const r of s.listeners)r.onError(t);i.queries.delete(e)}function Fa(n){n.Zr.forEach(e=>{e.next()})}class Ua{constructor(e,t,i){this.query=e,this.so=t,this.io=!1,this.ro=null,this.onlineState="Unknown",this.options=i||{}}no(e){if(!this.options.includeMetadataChanges){const i=[];for(const s of e.docChanges)3!==s.type&&i.push(s);e=new Ki(e.query,e.docs,e.oldDocs,i,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.io?this.oo(e)&&(this.so.next(e),t=!0):this.ao(e,this.onlineState)&&(this.co(e),t=!0),this.ro=e,t}onError(e){this.so.error(e)}eo(e){this.onlineState=e;let t=!1;return this.ro&&!this.io&&this.ao(this.ro,e)&&(this.co(this.ro),t=!0),t}ao(e,t){return!e.fromCache||!(this.options.uo&&"Offline"!==t||e.docs.isEmpty()&&"Offline"!==t)}oo(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.ro&&this.ro.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}co(e){e=Ki.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.io=!0,this.so.next(e)}}class ug{constructor(e,t){this.payload=e,this.byteLength=t}ho(){return"metadata"in this.payload}}class wh{constructor(e){this.N=e}zn(e){return Et(this.N,e)}Hn(e){return e.metadata.exists?Iu(this.N,e.document,!1):ae.newNoDocument(this.zn(e.metadata.name),this.Jn(e.metadata.readTime))}Jn(e){return Re(e)}}class hg{constructor(e,t,i){this.lo=e,this.localStore=t,this.N=i,this.queries=[],this.documents=[],this.progress=bh(e)}fo(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;return e.payload.namedQuery?this.queries.push(e.payload.namedQuery):e.payload.documentMetadata?(this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t):e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t),t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}wo(e){const t=new Map,i=new wh(this.N);for(const s of e)if(s.metadata.queries){const r=i.zn(s.metadata.name);for(const o of s.metadata.queries){const l=(t.get(o)||ee()).add(r);t.set(o,l)}}return t}complete(){var e=this;return(0,S.Z)(function*(){const t=yield function(n,e,t,i){return aa.apply(this,arguments)}(e.localStore,new wh(e.N),e.documents,e.lo.id),i=e.wo(e.documents);for(const s of e.queries)yield Lp(e.localStore,s,i.get(s.name));return e.progress.taskState="Success",new xp(Object.assign({},e.progress),t)})()}}function bh(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class Th{constructor(e){this.key=e}}class Eh{constructor(e){this.key=e}}class Ih{constructor(e,t){this.query=e,this._o=t,this.mo=null,this.current=!1,this.yo=ee(),this.mutatedKeys=ee(),this.po=Ql(e),this.To=new ji(this.po)}get Eo(){return this._o}Io(e,t){const i=t?t.Ao:new vh,s=t?t.To:this.To;let r=t?t.mutatedKeys:this.mutatedKeys,o=s,l=!1;const u=Er(this.query)&&s.size===this.query.limit?s.last():null,d=Ir(this.query)&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((g,_)=>{const E=s.get(g),x=Ss(this.query,_)?_:null,P=!!E&&this.mutatedKeys.has(E.key),F=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let Z=!1;E&&x?E.data.isEqual(x.data)?P!==F&&(i.track({type:3,doc:x}),Z=!0):this.Ro(E,x)||(i.track({type:2,doc:x}),Z=!0,(u&&this.po(x,u)>0||d&&this.po(x,d)<0)&&(l=!0)):!E&&x?(i.track({type:0,doc:x}),Z=!0):E&&!x&&(i.track({type:1,doc:E}),Z=!0,(u||d)&&(l=!0)),Z&&(x?(o=o.add(x),r=F?r.add(g):r.delete(g)):(o=o.delete(g),r=r.delete(g)))}),Er(this.query)||Ir(this.query))for(;o.size>this.query.limit;){const g=Er(this.query)?o.last():o.first();o=o.delete(g.key),r=r.delete(g.key),i.track({type:1,doc:g})}return{To:o,Ao:i,Ln:l,mutatedKeys:r}}Ro(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,i){const s=this.To;this.To=e.To,this.mutatedKeys=e.mutatedKeys;const r=e.Ao.Yr();r.sort((d,g)=>function(_,E){const x=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return M()}};return x(_)-x(E)}(d.type,g.type)||this.po(d.doc,g.doc)),this.bo(i);const o=t?this.Po():[],l=0===this.yo.size&&this.current?1:0,u=l!==this.mo;return this.mo=l,0!==r.length||u?{snapshot:new Ki(this.query,e.To,s,r,e.mutatedKeys,0===l,u,!1),vo:o}:{vo:o}}eo(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({To:this.To,Ao:new vh,mutatedKeys:this.mutatedKeys,Ln:!1},!1)):{vo:[]}}Vo(e){return!this._o.has(e)&&!!this.To.has(e)&&!this.To.get(e).hasLocalMutations}bo(e){e&&(e.addedDocuments.forEach(t=>this._o=this._o.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this._o=this._o.delete(t)),this.current=e.current)}Po(){if(!this.current)return[];const e=this.yo;this.yo=ee(),this.To.forEach(i=>{this.Vo(i.key)&&(this.yo=this.yo.add(i.key))});const t=[];return e.forEach(i=>{this.yo.has(i)||t.push(new Eh(i))}),this.yo.forEach(i=>{e.has(i)||t.push(new Th(i))}),t}So(e){this._o=e.Gn,this.yo=ee();const t=this.Io(e.documents);return this.applyChanges(t,!0)}Do(){return Ki.fromInitialDocuments(this.query,this.To,this.mutatedKeys,0===this.mo)}}class dg{constructor(e,t,i){this.query=e,this.targetId=t,this.view=i}}class fg{constructor(e){this.key=e,this.Co=!1}}class pg{constructor(e,t,i,s,r,o){this.localStore=e,this.remoteStore=t,this.eventManager=i,this.sharedClientState=s,this.currentUser=r,this.maxConcurrentLimboResolutions=o,this.No={},this.xo=new Fi(l=>Yl(l),Is),this.ko=new Map,this.$o=new Set,this.Oo=new Ie(O.comparator),this.Fo=new Map,this.Mo=new la,this.Lo={},this.Bo=new Map,this.Uo=Hn.ie(),this.onlineState="Unknown",this.qo=void 0}get isPrimaryClient(){return!0===this.qo}}function gg(n,e){return Va.apply(this,arguments)}function Va(){return(Va=(0,S.Z)(function*(n,e){const t=cc(n);let i,s;const r=t.xo.get(e);if(r)i=r.targetId,t.sharedClientState.addLocalQueryTarget(i),s=r.view.Do();else{const o=yield Ui(t.localStore,at(e)),l=t.sharedClientState.addLocalQueryTarget(o.targetId);i=o.targetId,s=yield Ba(t,e,i,"current"===l),t.isPrimaryClient&&qr(t.remoteStore,o)}return s})).apply(this,arguments)}function Ba(n,e,t,i){return qa.apply(this,arguments)}function qa(){return(qa=(0,S.Z)(function*(n,e,t,i){n.Ko=(g,_,E)=>{return(x=(0,S.Z)(function*(P,F,Z,fe){let gt=F.view.Io(Z);gt.Ln&&(gt=yield Fr(P.localStore,F.query,!1).then(({documents:Ht})=>F.view.Io(Ht,gt)));const xt=fe&&fe.targetChanges.get(F.targetId),$t=F.view.applyChanges(gt,P.isPrimaryClient,xt);return Wa(P,F.targetId,$t.vo),$t.snapshot}),function(P,F,Z,fe){return x.apply(this,arguments)})(n,g,_,E);var x};const s=yield Fr(n.localStore,e,!0),r=new Ih(e,s.Gn),o=r.Io(s.documents),l=Rs.createSynthesizedTargetChangeForCurrentChange(t,i&&"Offline"!==n.onlineState),u=r.applyChanges(o,n.isPrimaryClient,l);Wa(n,t,u.vo);const d=new dg(e,t,r);return n.xo.set(e,d),n.ko.has(t)?n.ko.get(t).push(e):n.ko.set(t,[e]),u.snapshot})).apply(this,arguments)}function mg(n,e){return Ga.apply(this,arguments)}function Ga(){return(Ga=(0,S.Z)(function*(n,e){const t=N(n),i=t.xo.get(e),s=t.ko.get(i.targetId);if(s.length>1)return t.ko.set(i.targetId,s.filter(r=>!Is(r,e))),void t.xo.delete(e);t.isPrimaryClient?(t.sharedClientState.removeLocalQueryTarget(i.targetId),t.sharedClientState.isActiveQueryTarget(i.targetId)||(yield Vi(t.localStore,i.targetId,!1).then(()=>{t.sharedClientState.clearQueryState(i.targetId),Bs(t.remoteStore,i.targetId),Zi(t,i.targetId)}).catch(Yn))):(Zi(t,i.targetId),yield Vi(t.localStore,i.targetId,!0))})).apply(this,arguments)}function za(){return(za=(0,S.Z)(function*(n,e,t){const i=lc(n);try{const s=yield function(r,o){const l=N(r),u=Ce.now(),d=o.reduce((_,E)=>_.add(E.key),ee());let g;return l.persistence.runTransaction("Locally write mutations","readwrite",_=>l.Qn.Pn(_,d).next(E=>{g=E;const x=[];for(const P of o){const F=Gf(P,g.get(P.key));null!=F&&x.push(new on(P.key,F,Gl(F.value.mapValue),be.exists(!0)))}return l.In.addMutationBatch(_,u,x,o)})).then(_=>(_.applyToLocalDocumentSet(g),{batchId:_.batchId,changes:g}))}(i.localStore,e);i.sharedClientState.addPendingMutation(s.batchId),function(r,o,l){let u=r.Lo[r.currentUser.toKey()];u||(u=new Ie(H)),u=u.insert(o,l),r.Lo[r.currentUser.toKey()]=u}(i,s.batchId,t),yield jt(i,s.changes),yield qi(i.remoteStore)}catch(s){const r=zi(s,"Failed to persist write");t.reject(r)}})).apply(this,arguments)}function Sh(n,e){return ja.apply(this,arguments)}function ja(){return(ja=(0,S.Z)(function*(n,e){const t=N(n);try{const i=yield Rp(t.localStore,e);e.targetChanges.forEach((s,r)=>{const o=t.Fo.get(r);o&&(z(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.Co=!0:s.modifiedDocuments.size>0?z(o.Co):s.removedDocuments.size>0&&(z(o.Co),o.Co=!1))}),yield jt(t,i,e)}catch(i){yield Yn(i)}})).apply(this,arguments)}function Dh(n,e,t){const i=N(n);if(i.isPrimaryClient&&0===t||!i.isPrimaryClient&&1===t){const s=[];i.xo.forEach((r,o)=>{const l=o.view.eo(e);l.snapshot&&s.push(l.snapshot)}),function(r,o){const l=N(r);l.onlineState=o;let u=!1;l.queries.forEach((d,g)=>{for(const _ of g.listeners)_.eo(o)&&(u=!0)}),u&&Fa(l)}(i.eventManager,e),s.length&&i.No.Er(s),i.onlineState=e,i.isPrimaryClient&&i.sharedClientState.setOnlineState(e)}}function _g(n,e,t){return Ka.apply(this,arguments)}function Ka(){return(Ka=(0,S.Z)(function*(n,e,t){const i=N(n);i.sharedClientState.updateQueryState(e,"rejected",t);const s=i.Fo.get(e),r=s&&s.key;if(r){let o=new Ie(O.comparator);o=o.insert(r,ae.newNoDocument(r,K.min()));const l=ee().add(r),u=new As(K.min(),new Map,new ue(H),o,l);yield Sh(i,u),i.Oo=i.Oo.remove(r),i.Fo.delete(e),Xa(i)}else yield Vi(i.localStore,e,!1).then(()=>Zi(i,e,t)).catch(Yn)})).apply(this,arguments)}function vg(n,e){return Za.apply(this,arguments)}function Za(){return(Za=(0,S.Z)(function*(n,e){const t=N(n),i=e.batch.batchId;try{const s=yield Ap(t.localStore,e);Qa(t,i,null),Ya(t,i),t.sharedClientState.updateMutationState(i,"acknowledged"),yield jt(t,s)}catch(s){yield Yn(s)}})).apply(this,arguments)}function wg(n,e,t){return $a.apply(this,arguments)}function $a(){return($a=(0,S.Z)(function*(n,e,t){const i=N(n);try{const s=yield function(r,o){const l=N(r);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return l.In.lookupMutationBatch(u,o).next(g=>(z(null!==g),d=g.keys(),l.In.removeMutationBatch(u,g))).next(()=>l.In.performConsistencyCheck(u)).next(()=>l.Qn.Pn(u,d))})}(i.localStore,e);Qa(i,e,t),Ya(i,e),i.sharedClientState.updateMutationState(e,"rejected",t),yield jt(i,s)}catch(s){yield Yn(s)}})).apply(this,arguments)}function Ha(){return(Ha=(0,S.Z)(function*(n,e){const t=N(n);dn(t.remoteStore)||R("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const i=yield function(r){const o=N(r);return o.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>o.In.getHighestUnacknowledgedBatchId(l))}(t.localStore);if(-1===i)return void e.resolve();const s=t.Bo.get(i)||[];s.push(e),t.Bo.set(i,s)}catch(i){const s=zi(i,"Initialization of waitForPendingWrites() operation failed");e.reject(s)}})).apply(this,arguments)}function Ya(n,e){(n.Bo.get(e)||[]).forEach(t=>{t.resolve()}),n.Bo.delete(e)}function Qa(n,e,t){const i=N(n);let s=i.Lo[i.currentUser.toKey()];if(s){const r=s.get(e);r&&(t?r.reject(t):r.resolve(),s=s.remove(e)),i.Lo[i.currentUser.toKey()]=s}}function Zi(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const i of n.ko.get(e))n.xo.delete(i),t&&n.No.jo(i,t);n.ko.delete(e),n.isPrimaryClient&&n.Mo.cs(e).forEach(i=>{n.Mo.containsKey(i)||xh(n,i)})}function xh(n,e){n.$o.delete(e.path.canonicalString());const t=n.Oo.get(e);null!==t&&(Bs(n.remoteStore,t),n.Oo=n.Oo.remove(e),n.Fo.delete(t),Xa(n))}function Wa(n,e,t){for(const i of t)i instanceof Th?(n.Mo.addReference(i.key,e),Tg(n,i)):i instanceof Eh?(R("SyncEngine","Document no longer in limbo: "+i.key),n.Mo.removeReference(i.key,e),n.Mo.containsKey(i.key)||xh(n,i.key)):M()}function Tg(n,e){const t=e.key,i=t.path.canonicalString();n.Oo.get(t)||n.$o.has(i)||(R("SyncEngine","New document in limbo: "+t),n.$o.add(i),Xa(n))}function Xa(n){for(;n.$o.size>0&&n.Oo.size<n.maxConcurrentLimboResolutions;){const e=n.$o.values().next().value;n.$o.delete(e);const t=new O(X.fromString(e)),i=n.Uo.next();n.Fo.set(i,new fg(t)),n.Oo=n.Oo.insert(t,i),qr(n.remoteStore,new cn(at(Ii(t.path)),i,2,tt.T))}}function jt(n,e,t){return Ja.apply(this,arguments)}function Ja(){return(Ja=(0,S.Z)(function*(n,e,t){const i=N(n),s=[],r=[],o=[];var l;i.xo.isEmpty()||(i.xo.forEach((l,u)=>{o.push(i.Ko(u,e,t).then(d=>{if(d){i.isPrimaryClient&&i.sharedClientState.updateQueryState(u.targetId,d.fromCache?"not-current":"current"),s.push(d);const g=ia.kn(u.targetId,d);r.push(g)}}))}),yield Promise.all(o),i.No.Er(s),yield(l=(0,S.Z)(function*(u,d){const g=N(u);try{yield g.persistence.runTransaction("notifyLocalViewChanges","readwrite",_=>C.forEach(d,E=>C.forEach(E.Nn,x=>g.persistence.referenceDelegate.addReference(_,E.targetId,x)).next(()=>C.forEach(E.xn,x=>g.persistence.referenceDelegate.removeReference(_,E.targetId,x)))))}catch(_){if(!Zn(_))throw _;R("LocalStore","Failed to update sequence numbers: "+_)}for(const _ of d){const E=_.targetId;if(!_.fromCache){const x=g.Un.get(E),F=x.withLastLimboFreeSnapshotVersion(x.snapshotVersion);g.Un=g.Un.insert(E,F)}}}),function(u,d){return l.apply(this,arguments)})(i.localStore,r))})).apply(this,arguments)}function Eg(n,e){return ec.apply(this,arguments)}function ec(){return(ec=(0,S.Z)(function*(n,e){const t=N(n);if(!t.currentUser.isEqual(e)){R("SyncEngine","User change. New user:",e.toKey());const i=yield ih(t.localStore,e);t.currentUser=e,(s=t).Bo.forEach(o=>{o.forEach(l=>{l.reject(new A(T.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.Bo.clear(),t.sharedClientState.handleUserChange(e,i.removedBatchIds,i.addedBatchIds),yield jt(t,i.Wn)}var s})).apply(this,arguments)}function Ig(n,e){const t=N(n),i=t.Fo.get(e);if(i&&i.Co)return ee().add(i.key);{let s=ee();const r=t.ko.get(e);if(!r)return s;for(const o of r){const l=t.xo.get(o);s=s.unionWith(l.view.Eo)}return s}}function Sg(n,e){return tc.apply(this,arguments)}function tc(){return(tc=(0,S.Z)(function*(n,e){const t=N(n),i=yield Fr(t.localStore,e.query,!0),s=e.view.So(i);return t.isPrimaryClient&&Wa(t,e.targetId,s.vo),s})).apply(this,arguments)}function Dg(n){return nc.apply(this,arguments)}function nc(){return(nc=(0,S.Z)(function*(n){const e=N(n);return ah(e.localStore).then(t=>jt(e,t))})).apply(this,arguments)}function xg(n,e,t,i){return ic.apply(this,arguments)}function ic(){return(ic=(0,S.Z)(function*(n,e,t,i){const s=N(n),r=yield function(o,l){const u=N(o),d=N(u.In);return u.persistence.runTransaction("Lookup mutation documents","readonly",g=>d.Xt(g,l).next(_=>_?u.Qn.Pn(g,_):C.resolve(null)))}(s.localStore,e);var l;null!==r?("pending"===t?yield qi(s.remoteStore):"acknowledged"===t||"rejected"===t?(Qa(s,e,i||null),Ya(s,e),l=e,N(N(s.localStore).In).te(l)):M(),yield jt(s,r)):R("SyncEngine","Cannot apply mutation batch with id: "+e)})).apply(this,arguments)}function sc(){return(sc=(0,S.Z)(function*(n,e){const t=N(n);if(cc(t),lc(t),!0===e&&!0!==t.qo){const i=t.sharedClientState.getAllActiveQueryTargets(),s=yield Ch(t,i.toArray());t.qo=!0,yield Ra(t.remoteStore,!0);for(const r of s)qr(t.remoteStore,r)}else if(!1===e&&!1!==t.qo){const i=[];let s=Promise.resolve();t.ko.forEach((r,o)=>{t.sharedClientState.isLocalQueryTarget(o)?i.push(o):s=s.then(()=>(Zi(t,o),Vi(t.localStore,o,!0))),Bs(t.remoteStore,o)}),yield s,yield Ch(t,i),function(r){const o=N(r);o.Fo.forEach((l,u)=>{Bs(o.remoteStore,u)}),o.Mo.us(),o.Fo=new Map,o.Oo=new Ie(O.comparator)}(t),t.qo=!1,yield Ra(t.remoteStore,!1)}})).apply(this,arguments)}function Ch(n,e,t){return rc.apply(this,arguments)}function rc(){return(rc=(0,S.Z)(function*(n,e,t){const i=N(n),s=[],r=[];for(const o of e){let l;const u=i.ko.get(o);if(u&&0!==u.length){l=yield Ui(i.localStore,at(u[0]));for(const d of u){const g=i.xo.get(d),_=yield Sg(i,g);_.snapshot&&r.push(_.snapshot)}}else{const d=yield oh(i.localStore,o);l=yield Ui(i.localStore,d),yield Ba(i,Ah(d),o,!1)}s.push(l)}return i.No.Er(r),s})).apply(this,arguments)}function Ah(n){return $l(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function Ag(n){const e=N(n);return N(N(e.localStore).persistence).pn()}function Rg(n,e,t,i){return oc.apply(this,arguments)}function oc(){return(oc=(0,S.Z)(function*(n,e,t,i){const s=N(n);if(s.qo)R("SyncEngine","Ignoring unexpected query state notification.");else if(s.ko.has(e))switch(t){case"current":case"not-current":{const r=yield ah(s.localStore),o=As.createSynthesizedRemoteEventForCurrentChange(e,"current"===t);yield jt(s,r,o);break}case"rejected":yield Vi(s.localStore,e,!0),Zi(s,e,i);break;default:M()}})).apply(this,arguments)}function Pg(n,e,t){return ac.apply(this,arguments)}function ac(){return(ac=(0,S.Z)(function*(n,e,t){const i=cc(n);if(i.qo){for(const s of e){if(i.ko.has(s)){R("SyncEngine","Adding an already active target "+s);continue}const r=yield oh(i.localStore,s),o=yield Ui(i.localStore,r);yield Ba(i,Ah(r),o.targetId,!1),qr(i.remoteStore,o)}for(const s of t)i.ko.has(s)&&(yield Vi(i.localStore,s,!1).then(()=>{Bs(i.remoteStore,s),Zi(i,s)}).catch(Yn))}})).apply(this,arguments)}function cc(n){const e=N(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Sh.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ig.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=_g.bind(null,e),e.No.Er=cg.bind(null,e.eventManager),e.No.jo=lg.bind(null,e.eventManager),e}function lc(n){const e=N(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=vg.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=wg.bind(null,e),e}class Rh{constructor(){this.synchronizeTabs=!1}initialize(e){var t=this;return(0,S.Z)(function*(){t.N=Us(e.databaseInfo.databaseId),t.sharedClientState=t.Wo(e),t.persistence=t.Go(e),yield t.persistence.start(),t.gcScheduler=t.zo(e),t.localStore=t.Ho(e)})()}zo(e){return null}Ho(e){return nh(this.persistence,new th,e.initialUser,this.N)}Go(e){return new Bp(ua.Ns,this.N)}Wo(e){return new uh}terminate(){var e=this;return(0,S.Z)(function*(){e.gcScheduler&&e.gcScheduler.stop(),yield e.sharedClientState.shutdown(),yield e.persistence.shutdown()})()}}class Ph extends Rh{constructor(e,t,i){super(),this.Jo=e,this.cacheSizeBytes=t,this.forceOwnership=i,this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,i=this;return(0,S.Z)(function*(){yield t().call(i,e),yield function(n){return oa.apply(this,arguments)}(i.localStore),yield i.Jo.initialize(i,e),yield lc(i.Jo.syncEngine),yield qi(i.Jo.remoteStore),yield i.persistence.nn(()=>(i.gcScheduler&&!i.gcScheduler.started&&i.gcScheduler.start(i.localStore),Promise.resolve()))})()}Ho(e){return nh(this.persistence,new th,e.initialUser,this.N)}zo(e){return new bp(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue)}Go(e){const t=na(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),i=void 0!==this.cacheSizeBytes?We.withCacheSize(this.cacheSizeBytes):We.DEFAULT;return new ta(this.synchronizeTabs,t,e.clientId,i,e.asyncQueue,dh(),Br(),this.N,this.sharedClientState,!!this.forceOwnership)}Wo(e){return new uh}}class kg extends Ph{constructor(e,t){super(e,t,!1),this.Jo=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,i=this;return(0,S.Z)(function*(){yield t().call(i,e);const s=i.Jo.syncEngine;i.sharedClientState instanceof pa&&(i.sharedClientState.syncEngine={_i:xg.bind(null,s),mi:Rg.bind(null,s),gi:Pg.bind(null,s),pn:Ag.bind(null,s),wi:Dg.bind(null,s)},yield i.sharedClientState.start()),yield i.persistence.nn(function(){var r=(0,S.Z)(function*(o){yield function(n,e){return sc.apply(this,arguments)}(i.Jo.syncEngine,o),i.gcScheduler&&(o&&!i.gcScheduler.started?i.gcScheduler.start(i.localStore):o||i.gcScheduler.stop())});return function(o){return r.apply(this,arguments)}}())})()}Wo(e){const t=dh();if(!pa.bt(t))throw new A(T.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const i=na(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new pa(t,e.asyncQueue,i,e.clientId,e.initialUser)}}class uc{initialize(e,t){var i=this;return(0,S.Z)(function*(){i.localStore||(i.localStore=e.localStore,i.sharedClientState=e.sharedClientState,i.datastore=i.createDatastore(t),i.remoteStore=i.createRemoteStore(t),i.eventManager=i.createEventManager(t),i.syncEngine=i.createSyncEngine(t,!e.synchronizeTabs),i.sharedClientState.onlineStateHandler=s=>Dh(i.syncEngine,s,1),i.remoteStore.remoteSyncer.handleCredentialChange=Eg.bind(null,i.syncEngine),yield Ra(i.remoteStore,i.syncEngine.isPrimaryClient))})()}createEventManager(e){return new ag}createDatastore(e){const t=Us(e.databaseInfo.databaseId),i=new Kp(e.databaseInfo);return new Hp(e.credentials,i,t)}createRemoteStore(e){return t=this.localStore,i=this.datastore,s=e.asyncQueue,r=l=>Dh(this.syncEngine,l,0),o=hh.bt()?new hh:new Gp,new Qp(t,i,s,r,o);var t,i,s,r,o}createSyncEngine(e,t){return function(i,s,r,o,l,u,d){const g=new pg(i,s,r,o,l,u);return d&&(g.qo=!0),g}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return(e=(0,S.Z)(function*(t){const i=N(t);R("RemoteStore","RemoteStore shutting down."),i.Kr.add(5),yield Bi(i),i.Qr.shutdown(),i.Wr.set("Unknown")}),function(t){return e.apply(this,arguments)})(this.remoteStore);var e}}function Nh(n,e=10240){let t=0;return{read:()=>(0,S.Z)(function*(){if(t<n.byteLength){const i={value:n.slice(t,t+e),done:!1};return t+=e,i}return{done:!0}})(),cancel:()=>(0,S.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class zr{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Yo(this.observer.next,e)}error(e){this.observer.error?this.Yo(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Xo(){this.muted=!0}Yo(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}class Lg{constructor(e,t){this.Zo=e,this.N=t,this.metadata=new xe,this.buffer=new Uint8Array,this.ta=new TextDecoder("utf-8"),this.ea().then(i=>{i&&i.ho()?this.metadata.resolve(i.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==i?void 0:i.payload)}`))},i=>this.metadata.reject(i))}close(){return this.Zo.cancel()}getMetadata(){var e=this;return(0,S.Z)(function*(){return e.metadata.promise})()}Qo(){var e=this;return(0,S.Z)(function*(){return yield e.getMetadata(),e.ea()})()}ea(){var e=this;return(0,S.Z)(function*(){const t=yield e.na();if(null===t)return null;const i=e.ta.decode(t),s=Number(i);isNaN(s)&&e.sa(`length string (${i}) is not valid number`);const r=yield e.ia(s);return new ug(JSON.parse(r),t.length+s)})()}ra(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}na(){var e=this;return(0,S.Z)(function*(){for(;e.ra()<0&&!(yield e.oa()););if(0===e.buffer.length)return null;const t=e.ra();t<0&&e.sa("Reached the end of bundle when a length string is expected.");const i=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),i})()}ia(e){var t=this;return(0,S.Z)(function*(){for(;t.buffer.length<e;)(yield t.oa())&&t.sa("Reached the end of bundle when more is expected.");const i=t.ta.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),i})()}sa(e){throw this.Zo.cancel(),new Error(`Invalid bundle format: ${e}`)}oa(){var e=this;return(0,S.Z)(function*(){const t=yield e.Zo.read();if(!t.done){const i=new Uint8Array(e.buffer.length+t.value.length);i.set(e.buffer),i.set(t.value,e.buffer.length),e.buffer=i}return t.done})()}}class Og{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,S.Z)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw new A(T.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const i=yield(s=(0,S.Z)(function*(r,o){const l=N(r),u=ks(l.N)+"/documents",d={documents:o.map(x=>Ns(l.N,x))},g=yield l.Ki("BatchGetDocuments",u,d),_=new Map;g.forEach(x=>{const P=function(n,e){return"found"in e?function(t,i){z(!!i.found);const s=Et(t,i.found.name),r=Re(i.found.updateTime),o=new Ue({mapValue:{fields:i.found.fields}});return ae.newFoundDocument(s,r,o)}(n,e):"missing"in e?function(t,i){z(!!i.missing),z(!!i.readTime);const s=Et(t,i.missing),r=Re(i.readTime);return ae.newNoDocument(s,r)}(n,e):M()}(l.N,x);_.set(P.key.toString(),P)});const E=[];return o.forEach(x=>{const P=_.get(x.toString());z(!!P),E.push(P)}),E}),function(r,o){return s.apply(this,arguments)})(t.datastore,e);var s;return i.forEach(s=>t.recordVersion(s)),i})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(i){this.lastWriteError=i}this.writtenDocs.add(e.toString())}delete(e){this.write(new Cs(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,S.Z)(function*(){if(e.ensureCommitNotCalled(),e.lastWriteError)throw e.lastWriteError;const t=e.readVersions;var i;e.mutations.forEach(i=>{t.delete(i.key.toString())}),t.forEach((i,s)=>{const r=O.fromPath(s);e.mutations.push(new qo(r,e.precondition(r)))}),yield(i=(0,S.Z)(function*(s,r){const o=N(s),l=ks(o.N)+"/documents",u={writes:r.map(d=>Pr(o.N,d))};yield o.Li("Commit",l,u)}),function(s,r){return i.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw M();t=K.min()}const i=this.readVersions.get(e.key.toString());if(i){if(!t.isEqual(i))throw new A(T.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?be.updateTime(t):be.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(K.min()))throw new A(T.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return be.updateTime(t)}return be.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Mg{constructor(e,t,i,s){this.asyncQueue=e,this.datastore=t,this.updateFunction=i,this.deferred=s,this.aa=5,this.rr=new ga(this.asyncQueue,"transaction_retry")}run(){this.aa-=1,this.ca()}ca(){var e=this;this.rr.Xi((0,S.Z)(function*(){const t=new Og(e.datastore),i=e.ua(t);i&&i.then(s=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(s)}).catch(r=>{e.ha(r)}))}).catch(s=>{e.ha(s)})}))}ua(e){try{const t=this.updateFunction(e);return!qn(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ha(e){this.aa>0&&this.la(e)?(this.aa-=1,this.asyncQueue.enqueueAndForget(()=>(this.ca(),Promise.resolve()))):this.deferred.reject(e)}la(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||!uu(t)}return!1}}class Fg{constructor(e,t,i){var s=this;this.credentials=e,this.asyncQueue=t,this.databaseInfo=i,this.user=ke.UNAUTHENTICATED,this.clientId=kl.I(),this.credentialListener=()=>Promise.resolve(),this.credentials.start(t,function(){var r=(0,S.Z)(function*(o){R("FirestoreClient","Received user=",o.uid),yield s.credentialListener(o),s.user=o});return function(o){return r.apply(this,arguments)}}())}getConfiguration(){var e=this;return(0,S.Z)(function*(){return{asyncQueue:e.asyncQueue,databaseInfo:e.databaseInfo,clientId:e.clientId,credentials:e.credentials,initialUser:e.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(e){this.credentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new A(T.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new xe;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,S.Z)(function*(){try{e.onlineComponents&&(yield e.onlineComponents.terminate()),e.offlineComponents&&(yield e.offlineComponents.terminate()),e.credentials.shutdown(),t.resolve()}catch(i){const s=zi(i,"Failed to shutdown persistence");t.reject(s)}})),t.promise}}function kh(n,e){return hc.apply(this,arguments)}function hc(){return(hc=(0,S.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),R("FirestoreClient","Initializing OfflineComponentProvider");const t=yield n.getConfiguration();yield e.initialize(t);let i=t.initialUser;n.setCredentialChangeListener(function(){var s=(0,S.Z)(function*(r){i.isEqual(r)||(yield ih(e.localStore,r),i=r)});return function(r){return s.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n.offlineComponents=e})).apply(this,arguments)}function Lh(n,e){return dc.apply(this,arguments)}function dc(){return(dc=(0,S.Z)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield fc(n);R("FirestoreClient","Initializing OnlineComponentProvider");const i=yield n.getConfiguration();yield e.initialize(t,i),n.setCredentialChangeListener(s=>{return(r=(0,S.Z)(function*(o,l){const u=N(o);u.asyncQueue.verifyOperationInProgress(),R("RemoteStore","RemoteStore received new credentials");const d=dn(u);u.Kr.add(3),yield Bi(u),d&&u.Wr.set("Unknown"),yield u.remoteSyncer.handleCredentialChange(l),u.Kr.delete(3),yield Vs(u)}),function(o,l){return r.apply(this,arguments)})(e.remoteStore,s);var r}),n.onlineComponents=e})).apply(this,arguments)}function fc(n){return pc.apply(this,arguments)}function pc(){return(pc=(0,S.Z)(function*(n){return n.offlineComponents||(R("FirestoreClient","Using default OfflineComponentProvider"),yield kh(n,new Rh)),n.offlineComponents})).apply(this,arguments)}function jr(n){return gc.apply(this,arguments)}function gc(){return(gc=(0,S.Z)(function*(n){return n.onlineComponents||(R("FirestoreClient","Using default OnlineComponentProvider"),yield Lh(n,new uc)),n.onlineComponents})).apply(this,arguments)}function Oh(n){return fc(n).then(e=>e.persistence)}function mc(n){return fc(n).then(e=>e.localStore)}function Mh(n){return jr(n).then(e=>e.remoteStore)}function yc(n){return jr(n).then(e=>e.syncEngine)}function $i(n){return _c.apply(this,arguments)}function _c(){return(_c=(0,S.Z)(function*(n){const e=yield jr(n),t=e.eventManager;return t.onListen=gg.bind(null,e.syncEngine),t.onUnlisten=mg.bind(null,e.syncEngine),t})).apply(this,arguments)}function Fh(n,e,t={}){const i=new xe;return n.asyncQueue.enqueueAndForget((0,S.Z)(function*(){return function(s,r,o,l,u){const d=new zr({next:_=>{r.enqueueAndForget(()=>Oa(s,g));const E=_.docs.has(o);!E&&_.fromCache?u.reject(new A(T.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&_.fromCache&&l&&"server"===l.source?u.reject(new A(T.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(_)},error:_=>u.reject(_)}),g=new Ua(Ii(o.path),d,{includeMetadataChanges:!0,uo:!0});return ka(s,g)}(yield $i(n),n.asyncQueue,e,t,i)})),i.promise}function Uh(n,e,t={}){const i=new xe;return n.asyncQueue.enqueueAndForget((0,S.Z)(function*(){return function(s,r,o,l,u){const d=new zr({next:_=>{r.enqueueAndForget(()=>Oa(s,g)),_.fromCache&&"server"===l.source?u.reject(new A(T.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(_)},error:_=>u.reject(_)}),g=new Ua(o,d,{includeMetadataChanges:!0,uo:!0});return ka(s,g)}(yield $i(n),n.asyncQueue,e,t,i)})),i.promise}class Zg{constructor(e,t,i,s,r,o,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=i,this.host=s,this.ssl=r,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.useFetchStreams=u}}class Hi{constructor(e,t){this.projectId=e,this.database=t||"(default)"}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Hi&&e.projectId===this.projectId&&e.database===this.database}}const Vh=new Map;function vc(n,e,t){if(!t)throw new A(T.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function Bh(n,e,t,i){if(!0===e&&!0===i)throw new A(T.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function qh(n){if(!O.isDocumentKey(n))throw new A(T.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Gh(n){if(O.isDocumentKey(n))throw new A(T.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Kr(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(t=n).constructor?t.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var t;return"function"==typeof n?"a function":M()}function W(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new A(T.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Kr(n);throw new A(T.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function zh(n,e){if(e<=0)throw new A(T.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class jh{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new A(T.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new A(T.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,Bh("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class qs{constructor(e,t){this._credentials=t,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new jh({}),this._settingsFrozen=!1,e instanceof Hi?this._databaseId=e:(this._app=e,this._databaseId=function(i){if(!Object.prototype.hasOwnProperty.apply(i.options,["projectId"]))throw new A(T.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Hi(i.options.projectId)}(e))}get app(){if(!this._app)throw new A(T.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new A(T.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new jh(e),void 0!==e.credentials&&(this._credentials=function(t){if(!t)return new mf;switch(t.type){case"gapi":const i=t.client;return z(!("object"!=typeof i||null===i||!i.auth||!i.auth.getAuthHeaderValueForFirstParty)),new wf(i,t.sessionIndex||"0",t.iamToken||null);case"provider":return t.client;default:throw new A(T.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Vh.get(e);t&&(R("ComponentProvider","Removing Datastore"),Vh.delete(e),t.terminate())}(this),Promise.resolve()}}class se{constructor(e,t,i){this.converter=t,this._key=i,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new St(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new se(this.firestore,e,this._key)}}class Be{constructor(e,t,i){this.converter=t,this._query=i,this.type="query",this.firestore=e}withConverter(e){return new Be(this.firestore,e,this._query)}}class St extends Be{constructor(e,t,i){super(e,t,Ii(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new se(this.firestore,null,new O(e))}withConverter(e){return new St(this.firestore,e,this._path)}}function Kh(n,e,...t){if(n=(0,$.m9)(n),vc("collection","path",e),n instanceof qs){const i=X.fromString(e,...t);return Gh(i),new St(n,null,i)}{if(!(n instanceof se||n instanceof St))throw new A(T.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(X.fromString(e,...t));return Gh(i),new St(n.firestore,null,i)}}function Zr(n,e,...t){if(n=(0,$.m9)(n),1===arguments.length&&(e=kl.I()),vc("doc","path",e),n instanceof qs){const i=X.fromString(e,...t);return qh(i),new se(n,null,new O(i))}{if(!(n instanceof se||n instanceof St))throw new A(T.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const i=n._path.child(X.fromString(e,...t));return qh(i),new se(n.firestore,n instanceof St?n.converter:null,new O(i))}}function Zh(n,e){return n=(0,$.m9)(n),e=(0,$.m9)(e),(n instanceof se||n instanceof St)&&(e instanceof se||e instanceof St)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function $h(n,e){return n=(0,$.m9)(n),e=(0,$.m9)(e),n instanceof Be&&e instanceof Be&&n.firestore===e.firestore&&Is(n._query,e._query)&&n.converter===e.converter}class Yg{constructor(){this.fa=Promise.resolve(),this.da=[],this.wa=!1,this._a=[],this.ma=null,this.ga=!1,this.ya=!1,this.pa=[],this.rr=new ga(this,"async_queue_retry"),this.Ta=()=>{const t=Br();t&&R("AsyncQueue","Visibility state changed to "+t.visibilityState),this.rr.tr()};const e=Br();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ta)}get isShuttingDown(){return this.wa}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Ea(),this.Ia(e)}enterRestrictedMode(e){if(!this.wa){this.wa=!0,this.ya=e||!1;const t=Br();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ta)}}enqueue(e){if(this.Ea(),this.wa)return new Promise(()=>{});const t=new xe;return this.Ia(()=>this.wa&&this.ya?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.da.push(e),this.Aa()))}Aa(){var e=this;return(0,S.Z)(function*(){if(0!==e.da.length){try{yield e.da[0](),e.da.shift(),e.rr.reset()}catch(t){if(!Zn(t))throw t;R("AsyncQueue","Operation failed with retryable error: "+t)}e.da.length>0&&e.rr.Xi(()=>e.Aa())}})()}Ia(e){const t=this.fa.then(()=>(this.ga=!0,e().catch(i=>{throw this.ma=i,this.ga=!1,ve("INTERNAL UNHANDLED ERROR: ",function(r){let o=r.message||"";return r.stack&&(o=r.stack.includes(r.message)?r.stack:r.message+"\n"+r.stack),o}(i)),i}).then(i=>(this.ga=!1,i))));return this.fa=t,t}enqueueAfterDelay(e,t,i){this.Ea(),this.pa.indexOf(e)>-1&&(t=0);const s=Na.createAndSchedule(this,e,t,i,r=>this.Ra(r));return this._a.push(s),s}Ea(){this.ma&&M()}verifyOperationInProgress(){}ba(){var e=this;return(0,S.Z)(function*(){let t;do{t=e.fa,yield t}while(t!==e.fa)})()}Pa(e){for(const t of this._a)if(t.timerId===e)return!0;return!1}va(e){return this.ba().then(()=>{this._a.sort((t,i)=>t.targetTimeMs-i.targetTimeMs);for(const t of this._a)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.ba()})}Va(e){this.pa.push(e)}Ra(e){const t=this._a.indexOf(e);this._a.splice(t,1)}}function wc(n){return function(e,t){if("object"!=typeof e||null===e)return!1;const i=e;for(const s of["next","error","complete"])if(s in i&&"function"==typeof i[s])return!0;return!1}(n)}class Qg{constructor(){this._progressObserver={},this._taskCompletionResolver=new xe,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,i){this._progressObserver={next:e,error:t,complete:i}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class de extends qs{constructor(e,t){super(e,t),this.type="firestore",this._queue=new Yg,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||Hh(this),this._firestoreClient.terminate()}}function Se(n){return n._firestoreClient||Hh(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function Hh(n){var e;const t=n._freezeSettings(),i=(r=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new Zg(n._databaseId,r,n._persistenceKey,(l=t).host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,l.useFetchStreams));var r,l;n._firestoreClient=new Fg(n._credentials,n._queue,i)}function Yh(n,e,t){const i=new xe;return n.asyncQueue.enqueue((0,S.Z)(function*(){try{yield kh(n,t),yield Lh(n,e),i.resolve()}catch(s){if(!("FirebaseError"===(r=s).name?r.code===T.FAILED_PRECONDITION||r.code===T.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&r instanceof DOMException)||22===r.code||20===r.code||11===r.code))throw s;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+s),i.reject(s)}var r})).then(()=>i.promise)}function Qh(n){if(n._initialized||n._terminated)throw new A(T.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Kt{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new A(T.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Le(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Dt{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Dt(Ae.fromBase64String(e))}catch(t){throw new A(T.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Dt(Ae.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Qn{constructor(e){this._methodName=e}}class $r{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new A(T.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new A(T.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return H(this._lat,e._lat)||H(this._long,e._long)}}const om=/^__.*__$/;class am{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return null!==this.fieldMask?new on(e,this.data,this.fieldMask,t,this.fieldTransforms):new xs(e,this.data,t,this.fieldTransforms)}}class Wh{constructor(e,t,i){this.data=e,this.fieldMask=t,this.fieldTransforms=i}toMutation(e,t){return new on(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Xh(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw M()}}class Hr{constructor(e,t,i,s,r,o){this.settings=e,this.databaseId=t,this.N=i,this.ignoreUndefinedProperties=s,void 0===r&&this.Sa(),this.fieldTransforms=r||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Da(){return this.settings.Da}Ca(e){return new Hr(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.N,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Na(e){var t;const i=null===(t=this.path)||void 0===t?void 0:t.child(e),s=this.Ca({path:i,xa:!1});return s.ka(e),s}$a(e){var t;const i=null===(t=this.path)||void 0===t?void 0:t.child(e),s=this.Ca({path:i,xa:!1});return s.Sa(),s}Oa(e){return this.Ca({path:void 0,xa:!0})}Fa(e){return Qr(e,this.settings.methodName,this.settings.Ma||!1,this.path,this.settings.La)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Sa(){if(this.path)for(let e=0;e<this.path.length;e++)this.ka(this.path.get(e))}ka(e){if(0===e.length)throw this.Fa("Document fields must not be empty");if(Xh(this.Da)&&om.test(e))throw this.Fa('Document fields cannot begin and end with "__"')}}class cm{constructor(e,t,i){this.databaseId=e,this.ignoreUndefinedProperties=t,this.N=i||Us(e)}Ba(e,t,i,s=!1){return new Hr({Da:e,methodName:t,La:i,path:Le.emptyPath(),xa:!1,Ma:s},this.databaseId,this.N,this.ignoreUndefinedProperties)}}function Wn(n){const e=n._freezeSettings(),t=Us(n._databaseId);return new cm(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Yr(n,e,t,i,s,r={}){const o=n.Ba(r.merge||r.mergeFields?2:0,e,t,s);Ic("Data must be an object, but it was:",o,i);const l=td(i,o);let u,d;if(r.merge)u=new wi(o.fieldMask),d=o.fieldTransforms;else if(r.mergeFields){const g=[];for(const _ of r.mergeFields){const E=Sc(e,_,t);if(!o.contains(E))throw new A(T.INVALID_ARGUMENT,`Field '${E}' is specified in your field mask but missing from your input data.`);id(g,E)||g.push(E)}u=new wi(g),d=o.fieldTransforms.filter(_=>u.covers(_.field))}else u=null,d=o.fieldTransforms;return new am(new Ue(l),u,d)}class Gs extends Qn{_toFieldTransform(e){if(2!==e.Da)throw e.Fa(1===e.Da?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Gs}}function Jh(n,e,t){return new Hr({Da:3,La:e.settings.La,methodName:n._methodName,xa:t},e.databaseId,e.N,e.ignoreUndefinedProperties)}class bc extends Qn{_toFieldTransform(e){return new Ds(e.path,new Di)}isEqual(e){return e instanceof bc}}class lm extends Qn{constructor(e,t){super(e),this.Ua=t}_toFieldTransform(e){const t=Jh(this,e,!0),i=this.Ua.map(r=>Xn(r,t)),s=new zn(i);return new Ds(e.path,s)}isEqual(e){return this===e}}class um extends Qn{constructor(e,t){super(e),this.Ua=t}_toFieldTransform(e){const t=Jh(this,e,!0),i=this.Ua.map(r=>Xn(r,t)),s=new jn(i);return new Ds(e.path,s)}isEqual(e){return this===e}}class hm extends Qn{constructor(e,t){super(e),this.qa=t}_toFieldTransform(e){const t=new xi(e.N,Jl(e.N,this.qa));return new Ds(e.path,t)}isEqual(e){return this===e}}function Tc(n,e,t,i){const s=n.Ba(1,e,t);Ic("Data must be an object, but it was:",s,i);const r=[],o=Ue.empty();Bn(i,(u,d)=>{const g=Dc(e,u,t);d=(0,$.m9)(d);const _=s.$a(g);if(d instanceof Gs)r.push(g);else{const E=Xn(d,_);null!=E&&(r.push(g),o.set(g,E))}});const l=new wi(r);return new Wh(o,l,s.fieldTransforms)}function Ec(n,e,t,i,s,r){const o=n.Ba(1,e,t),l=[Sc(e,i,t)],u=[s];if(r.length%2!=0)throw new A(T.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let E=0;E<r.length;E+=2)l.push(Sc(e,r[E])),u.push(r[E+1]);const d=[],g=Ue.empty();for(let E=l.length-1;E>=0;--E)if(!id(d,l[E])){const x=l[E];let P=u[E];P=(0,$.m9)(P);const F=o.$a(x);if(P instanceof Gs)d.push(x);else{const Z=Xn(P,F);null!=Z&&(d.push(x),g.set(x,Z))}}const _=new wi(d);return new Wh(g,_,o.fieldTransforms)}function ed(n,e,t,i=!1){return Xn(t,n.Ba(i?4:3,e))}function Xn(n,e){if(nd(n=(0,$.m9)(n)))return Ic("Unsupported field value:",e,n),td(n,e);if(n instanceof Qn)return function(t,i){if(!Xh(i.Da))throw i.Fa(`${t._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Fa(`${t._methodName}() is not currently supported inside arrays`);const s=t._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xa&&4!==e.Da)throw e.Fa("Nested arrays are not supported");return function(t,i){const s=[];let r=0;for(const o of t){let l=Xn(o,i.Oa(r));null==l&&(l={nullValue:"NULL_VALUE"}),s.push(l),r++}return{arrayValue:{values:s}}}(n,e)}return function(t,i){if(null===(t=(0,$.m9)(t)))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return Jl(i.N,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){const s=Ce.fromDate(t);return{timestampValue:Ps(i.N,s)}}if(t instanceof Ce){const s=new Ce(t.seconds,1e3*Math.floor(t.nanoseconds/1e3));return{timestampValue:Ps(i.N,s)}}if(t instanceof $r)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Dt)return{bytesValue:vu(i.N,t._byteString)};if(t instanceof se){const s=i.databaseId,r=t.firestore._databaseId;if(!r.isEqual(s))throw i.Fa(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:zo(t.firestore._databaseId||i.databaseId,t._key.path)}}throw i.Fa(`Unsupported field value: ${Kr(t)}`)}(n,e)}function td(n,e){const t={};return Ml(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Bn(n,(i,s)=>{const r=Xn(s,e.Na(i));null!=r&&(t[i]=r)}),{mapValue:{fields:t}}}function nd(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Ce||n instanceof $r||n instanceof Dt||n instanceof se||n instanceof Qn)}function Ic(n,e,t){if(!nd(t)||"object"!=typeof(i=t)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const i=Kr(t);throw e.Fa("an object"===i?n+" a custom object":n+" "+i)}var i}function Sc(n,e,t){if((e=(0,$.m9)(e))instanceof Kt)return e._internalPath;if("string"==typeof e)return Dc(n,e);throw Qr("Field path arguments must be of type string or FieldPath.",n,!1,void 0,t)}const dm=new RegExp("[~\\*/\\[\\]]");function Dc(n,e,t){if(e.search(dm)>=0)throw Qr(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Kt(...e.split("."))._internalPath}catch(i){throw Qr(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Qr(n,e,t,i,s){const r=i&&!i.isEmpty(),o=void 0!==s;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(r||o)&&(u+=" (found",r&&(u+=` in field ${i}`),o&&(u+=` in document ${s}`),u+=")"),new A(T.INVALID_ARGUMENT,l+n+u)}function id(n,e){return n.some(t=>t.isEqual(e))}class zs{constructor(e,t,i,s,r){this._firestore=e,this._userDataWriter=t,this._key=i,this._document=s,this._converter=r}get id(){return this._key.path.lastSegment()}get ref(){return new se(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new fm(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Wr("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class fm extends zs{data(){return super.data()}}function Wr(n,e){return"string"==typeof e?Dc(n,e):e instanceof Kt?e._internalPath:e._delegate._internalPath}class Jn{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Zt extends zs{constructor(e,t,i,s,r,o){super(e,t,i,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=r}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new js(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const i=this._document.data.field(Wr("DocumentSnapshot.get",e));if(null!==i)return this._userDataWriter.convertValue(i,t.serverTimestamps)}}}class js extends Zt{data(e={}){return super.data(e)}}class pn{constructor(e,t,i,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new Jn(s.hasPendingWrites,s.fromCache),this.query=i}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(i=>{e.call(t,new js(this._firestore,this._userDataWriter,i.key,i,new Jn(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new A(T.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let r=0;return i._snapshot.docChanges.map(o=>({type:"added",doc:new js(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Jn(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:r++}))}{let r=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(o=>s||3!==o.type).map(o=>{const l=new js(i._firestore,i._userDataWriter,o.doc.key,o.doc,new Jn(i._snapshot.mutatedKeys.has(o.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,d=-1;return 0!==o.type&&(u=r.indexOf(o.doc.key),r=r.delete(o.doc.key)),1!==o.type&&(r=r.add(o.doc),d=r.indexOf(o.doc.key)),{type:pm(o.type),doc:l,oldIndex:u,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function pm(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return M()}}function sd(n,e){return n instanceof Zt&&e instanceof Zt?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof pn&&e instanceof pn&&n._firestore===e._firestore&&$h(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}function rd(n){if(Ir(n)&&0===n.explicitOrderBy.length)throw new A(T.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Ks{}function gn(n,...e){for(const t of e)n=t._apply(n);return n}class gm extends Ks{constructor(e,t,i){super(),this.Ka=e,this.ja=t,this.Qa=i,this.type="where"}_apply(e){const t=Wn(e.firestore),i=function(s,r,o,l,u,d,g){let _;if(u.isKeyField()){if("array-contains"===d||"array-contains-any"===d)throw new A(T.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on FieldPath.documentId().`);if("in"===d||"not-in"===d){hd(g,d);const x=[];for(const P of g)x.push(ud(l,s,P));_={arrayValue:{values:x}}}else _=ud(l,s,g)}else"in"!==d&&"not-in"!==d&&"array-contains-any"!==d||hd(g,d),_=ed(o,"where",g,"in"===d||"not-in"===d);const E=ze.create(u,d,_);return function(x,P){if(P.v()){const Z=Fo(x);if(null!==Z&&!Z.isEqual(P.field))throw new A(T.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${Z.toString()}' and '${P.field.toString()}'`);const fe=Mo(x);null!==fe&&dd(0,P.field,fe)}const F=function(Z,fe){for(const gt of Z.filters)if(fe.indexOf(gt.op)>=0)return gt.op;return null}(x,function(Z){switch(Z){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(P.op));if(null!==F)throw new A(T.INVALID_ARGUMENT,F===P.op?`Invalid query. You cannot use more than one '${P.op.toString()}' filter.`:`Invalid query. You cannot use '${P.op.toString()}' filters with '${F.toString()}' filters.`)}(s,E),E}(e._query,0,t,e.firestore._databaseId,this.Ka,this.ja,this.Qa);return new Be(e.firestore,e.converter,function(s,r){const o=s.filters.concat([r]);return new qt(s.path,s.collectionGroup,s.explicitOrderBy.slice(),o,s.limit,s.limitType,s.startAt,s.endAt)}(e._query,i))}}class ym extends Ks{constructor(e,t){super(),this.Ka=e,this.Wa=t,this.type="orderBy"}_apply(e){const t=function(i,s,r){if(null!==i.startAt)throw new A(T.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new A(T.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const o=new Ei(s,r);return function(l,u){if(null===Mo(l)){const d=Fo(l);null!==d&&dd(0,d,u.field)}}(i,o),o}(e._query,this.Ka,this.Wa);return new Be(e.firestore,e.converter,function(i,s){const r=i.explicitOrderBy.concat([s]);return new qt(i.path,i.collectionGroup,r,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}class od extends Ks{constructor(e,t,i){super(),this.type=e,this.Ga=t,this.za=i}_apply(e){return new Be(e.firestore,e.converter,Hl(e._query,this.Ga,this.za))}}class ad extends Ks{constructor(e,t,i){super(),this.type=e,this.Ha=t,this.Ja=i}_apply(e){const t=ld(e,this.type,this.Ha,this.Ja);return new Be(e.firestore,e.converter,(s=t,new qt((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)));var i,s}}class cd extends Ks{constructor(e,t,i){super(),this.type=e,this.Ha=t,this.Ja=i}_apply(e){const t=ld(e,this.type,this.Ha,this.Ja);return new Be(e.firestore,e.converter,(s=t,new qt((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)));var i,s}}function ld(n,e,t,i){if(t[0]=(0,$.m9)(t[0]),t[0]instanceof zs)return function(s,r,o,l,u){if(!l)throw new A(T.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${o}().`);const d=[];for(const g of Si(s))if(g.field.isKeyField())d.push(_r(r,l.key));else{const _=l.data.field(g.field);if(Po(_))throw new A(T.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+g.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===_){const E=g.field.canonicalString();throw new A(T.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${E}' (used as the orderBy) does not exist.`)}d.push(_)}return new Es(d,u)}(n._query,n.firestore._databaseId,e,t[0]._document,i);{const s=Wn(n.firestore);return function(r,o,l,u,d,g){const _=r.explicitOrderBy;if(d.length>_.length)throw new A(T.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const E=[];for(let x=0;x<d.length;x++){const P=d[x];if(_[x].field.isKeyField()){if("string"!=typeof P)throw new A(T.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof P}`);if(!Uo(r)&&-1!==P.indexOf("/"))throw new A(T.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to ${u}() must be a plain document ID, but '${P}' contains a slash.`);const F=r.path.child(X.fromString(P));if(!O.isDocumentKey(F))throw new A(T.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to ${u}() must result in a valid document path, but '${F}' is not because it contains an odd number of segments.`);const Z=new O(F);E.push(_r(o,Z))}else{const F=ed(l,u,P);E.push(F)}}return new Es(E,g)}(n._query,n.firestore._databaseId,s,e,t,i)}}function ud(n,e,t){if("string"==typeof(t=(0,$.m9)(t))){if(""===t)throw new A(T.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Uo(e)&&-1!==t.indexOf("/"))throw new A(T.INVALID_ARGUMENT,`Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const i=e.path.child(X.fromString(t));if(!O.isDocumentKey(i))throw new A(T.INVALID_ARGUMENT,`Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return _r(n,new O(i))}if(t instanceof se)return _r(n,t._key);throw new A(T.INVALID_ARGUMENT,`Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: ${Kr(t)}.`)}function hd(n,e){if(!Array.isArray(n)||0===n.length)throw new A(T.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`);if(n.length>10)throw new A(T.INVALID_ARGUMENT,`Invalid Query. '${e.toString()}' filters support a maximum of 10 elements in the value array.`)}function dd(n,e,t){if(!t.isEqual(e))throw new A(T.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${e.toString()}' and so you must also use '${e.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${t.toString()}' instead.`)}class xc{convertValue(e,t="none"){switch(Gn(e)){case 0:return null;case 1:return e.booleanValue;case 2:return we(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(bi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw M()}}convertObject(e,t){const i={};return Bn(e.fields,(s,r)=>{i[s]=this.convertValue(r,t)}),i}convertGeoPoint(e){return new $r(we(e.latitude),we(e.longitude))}convertArray(e,t){return(e.values||[]).map(i=>this.convertValue(i,t))}convertServerTimestamp(e,t){switch(t){case"previous":const i=Fl(e);return null==i?null:this.convertValue(i,t);case"estimate":return this.convertTimestamp(vs(e));default:return null}}convertTimestamp(e){const t=rn(e);return new Ce(t.seconds,t.nanos)}convertDocumentKey(e,t){const i=X.fromString(e);z(Nu(i));const s=new Hi(i.get(1),i.get(3)),r=new O(i.popFirst(5));return s.isEqual(t)||ve(`Document ${r} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),r}}function Xr(n,e,t){let i;return i=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,i}class Sm extends xc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dt(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new se(this.firestore,null,t)}}class fd{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Wn(e)}set(e,t,i){this._verifyNotCommitted();const s=mn(e,this._firestore),r=Xr(s.converter,t,i),o=Yr(this._dataReader,"WriteBatch.set",s._key,r,null!==s.converter,i);return this._mutations.push(o.toMutation(s._key,be.none())),this}update(e,t,i,...s){this._verifyNotCommitted();const r=mn(e,this._firestore);let o;return o="string"==typeof(t=(0,$.m9)(t))||t instanceof Kt?Ec(this._dataReader,"WriteBatch.update",r._key,t,i,s):Tc(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(o.toMutation(r._key,be.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=mn(e,this._firestore);return this._mutations=this._mutations.concat(new Cs(t._key,be.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new A(T.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function mn(n,e){if((n=(0,$.m9)(n)).firestore!==e)throw new A(T.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class ei extends xc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Dt(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new se(this.firestore,null,t)}}function pd(n,e,t){n=W(n,se);const i=W(n.firestore,de),s=Xr(n.converter,e,t);return Yi(i,[Yr(Wn(i),"setDoc",n._key,s,null!==n.converter,t).toMutation(n._key,be.none())])}function gd(n,e,t,...i){n=W(n,se);const s=W(n.firestore,de),r=Wn(s);let o;return o="string"==typeof(e=(0,$.m9)(e))||e instanceof Kt?Ec(r,"updateDoc",n._key,e,t,i):Tc(r,"updateDoc",n._key,e),Yi(s,[o.toMutation(n._key,be.exists(!0))])}function md(n,...e){var t,i,s;n=(0,$.m9)(n);let r={includeMetadataChanges:!1},o=0;"object"!=typeof e[o]||wc(e[o])||(r=e[o],o++);const l={includeMetadataChanges:r.includeMetadataChanges};if(wc(e[o])){const _=e[o];e[o]=null===(t=_.next)||void 0===t?void 0:t.bind(_),e[o+1]=null===(i=_.error)||void 0===i?void 0:i.bind(_),e[o+2]=null===(s=_.complete)||void 0===s?void 0:s.bind(_)}let u,d,g;if(n instanceof se)d=W(n.firestore,de),g=Ii(n._key.path),u={next:_=>{e[o]&&e[o](Cc(d,n,_))},error:e[o+1],complete:e[o+2]};else{const _=W(n,Be);d=W(_.firestore,de),g=_._query;const E=new ei(d);u={next:x=>{e[o]&&e[o](new pn(d,E,_,x))},error:e[o+1],complete:e[o+2]},rd(n._query)}return function(_,E,x,P){const F=new zr(P),Z=new Ua(E,F,x);return _.asyncQueue.enqueueAndForget((0,S.Z)(function*(){return ka(yield $i(_),Z)})),()=>{F.Xo(),_.asyncQueue.enqueueAndForget((0,S.Z)(function*(){return Oa(yield $i(_),Z)}))}}(Se(d),g,l,u)}function Yi(n,e){return function(t,i){const s=new xe;return t.asyncQueue.enqueueAndForget((0,S.Z)(function*(){return function(n,e,t){return za.apply(this,arguments)}(yield yc(t),i,s)})),s.promise}(Se(n),e)}function Cc(n,e,t){const i=t.docs.get(e._key),s=new ei(n);return new Zt(n,s,e._key,i,new Jn(t.hasPendingWrites,t.fromCache),e.converter)}class Om extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Wn(e)}get(e){const t=mn(e,this._firestore),i=new Sm(this._firestore);return this._transaction.lookup([t._key]).then(s=>{if(!s||1!==s.length)return M();const r=s[0];if(r.isFoundDocument())return new zs(this._firestore,i,r.key,r,t.converter);if(r.isNoDocument())return new zs(this._firestore,i,t._key,null,t.converter);throw M()})}set(e,t,i){const s=mn(e,this._firestore),r=Xr(s.converter,t,i),o=Yr(this._dataReader,"Transaction.set",s._key,r,null!==s.converter,i);return this._transaction.set(s._key,o),this}update(e,t,i,...s){const r=mn(e,this._firestore);let o;return o="string"==typeof(t=(0,$.m9)(t))||t instanceof Kt?Ec(this._dataReader,"Transaction.update",r._key,t,i,s):Tc(this._dataReader,"Transaction.update",r._key,t),this._transaction.update(r._key,o),this}delete(e){const t=mn(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=mn(e,this._firestore),i=new ei(this._firestore);return super.get(e).then(s=>new Zt(this._firestore,i,t._key,s._document,new Jn(!1,!1),t.converter))}}function Ac(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new A("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function yd(){if("undefined"==typeof Uint8Array)throw new A("unimplemented","Uint8Arrays are not available in this environment.")}function _d(){if("undefined"==typeof atob)throw new A("unimplemented","Blobs are unavailable in Firestore in this environment.")}(function(n){_i=n})(Qt.SDK_VERSION),(0,Qt._registerComponent)(new _n.wA("firestore",(n,{options:e})=>{const t=n.getProvider("app").getImmediate(),i=new de(t,new _f(n.getProvider("auth-internal")));return e=Object.assign({useFetchStreams:!0},e),i._setSettings(e),i},"PUBLIC")),(0,Qt.registerVersion)(Pl,"3.1.1",void 0),(0,Qt.registerVersion)(Pl,"3.1.1","esm2017");class Zs{constructor(e){this._delegate=e}static fromBase64String(e){return _d(),new Zs(Dt.fromBase64String(e))}static fromUint8Array(e){return yd(),new Zs(Dt.fromUint8Array(e))}toBase64(){return _d(),this._delegate.toBase64()}toUint8Array(){return yd(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Rc(n){return function(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const i of["next","error","complete"])if(i in t&&"function"==typeof t[i])return!0;return!1}(n)}class Zm{enableIndexedDbPersistence(e,t){return function(n,e){Qh(n=W(n,de));const t=Se(n),i=n._freezeSettings(),s=new uc;return Yh(t,s,new Ph(s,i.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function(n){Qh(n=W(n,de));const e=Se(n),t=n._freezeSettings(),i=new uc;return Yh(e,i,new kg(i,t.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function(n){if(n._initialized&&!n._terminated)throw new A(T.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new xe;return n._queue.enqueueAndForgetEvenWhileRestricted((0,S.Z)(function*(){try{yield(t=(0,S.Z)(function*(i){if(!pt.bt())return Promise.resolve();const s=i+"main";yield pt.delete(s)}),function(i){return t.apply(this,arguments)})(na(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class vd{constructor(e,t,i){this._delegate=t,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},e instanceof Hi||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&ys("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,i={}){!function(n,e,t,i={}){var s;const r=(n=W(n,qs))._getSettings();if("firestore.googleapis.com"!==r.host&&r.host!==e&&ys("Host has been set in both settings() and useEmulator(), emulator host will be used"),n._setSettings(Object.assign(Object.assign({},r),{host:`${e}:${t}`,ssl:!1})),i.mockUserToken){let o,l;if("string"==typeof i.mockUserToken)o=i.mockUserToken,l=ke.MOCK_USER;else{o=(0,$.Sg)(i.mockUserToken,null===(s=n._app)||void 0===s?void 0:s.options.projectId);const u=i.mockUserToken.sub||i.mockUserToken.user_id;if(!u)throw new A(T.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new ke(u)}n._credentials=new yf(new Nl(o,l))}}(this._delegate,e,t,i)}enableNetwork(){return function(n){return function(n){return n.asyncQueue.enqueue((0,S.Z)(function*(){const e=yield Oh(n),t=yield Mh(n);return e.setNetworkEnabled(!0),function(i){const s=N(i);return s.Kr.delete(0),Vs(s)}(t)}))}(Se(n=W(n,de)))}(this._delegate)}disableNetwork(){return function(n){return function(n){return n.asyncQueue.enqueue((0,S.Z)(function*(){const e=yield Oh(n),t=yield Mh(n);return e.setNetworkEnabled(!1),(i=(0,S.Z)(function*(s){const r=N(s);r.Kr.add(0),yield Bi(r),r.Wr.set("Offline")}),function(s){return i.apply(this,arguments)})(t);var i}))}(Se(n=W(n,de)))}(this._delegate)}enablePersistence(e){let t=!1,i=!1;return e&&(t=!!e.synchronizeTabs,i=!!e.experimentalForceOwningTab,Bh("synchronizeTabs",t,"experimentalForceOwningTab",i)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function(n){return function(e){const t=new xe;return e.asyncQueue.enqueueAndForget((0,S.Z)(function*(){return function(n,e){return Ha.apply(this,arguments)}(yield yc(e),t)})),t.promise}(Se(n=W(n,de)))}(this._delegate)}onSnapshotsInSync(e){return function(n,e){return function(n,e){const t=new zr(e);return n.asyncQueue.enqueueAndForget((0,S.Z)(function*(){return i=yield $i(n),s=t,N(i).Zr.add(s),void s.next();var i,s})),()=>{t.Xo(),n.asyncQueue.enqueueAndForget((0,S.Z)(function*(){return i=yield $i(n),s=t,void N(i).Zr.delete(s);var i,s}))}}(Se(n=W(n,de)),wc(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new A("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Qi(this,Kh(this._delegate,e))}catch(t){throw je(t,"collection()","Firestore.collection()")}}doc(e){try{return new lt(this,Zr(this._delegate,e))}catch(t){throw je(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Ke(this,function(n,e){if(n=W(n,qs),vc("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new A(T.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Be(n,null,(t=e,new qt(X.emptyPath(),t)));var t}(this._delegate,e))}catch(t){throw je(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function(n,e){return function(n,e){const t=new xe;return n.asyncQueue.enqueueAndForget((0,S.Z)(function*(){const i=yield(s=n,jr(s).then(r=>r.datastore));var s;new Mg(n.asyncQueue,i,e,t).run()})),t.promise}(Se(n),t=>e(new Om(n,t)))}(this._delegate,t=>e(new wd(this,t)))}batch(){return Se(this._delegate),new bd(new fd(this._delegate,e=>Yi(this._delegate,e)))}loadBundle(e){return function(n,e){const t=Se(n=W(n,de)),i=new Qg;return function(n,e,t,i){const s=function(r,o){let l;return l="string"==typeof r?(new TextEncoder).encode(r):r,u=function(u,d){if(u instanceof Uint8Array)return Nh(u,d);if(u instanceof ArrayBuffer)return Nh(new Uint8Array(u),d);if(u instanceof ReadableStream)return u.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),new Lg(u,o);var u}(t,Us(e));n.asyncQueue.enqueueAndForget((0,S.Z)(function*(){!function(n,e,t){const i=N(n);var s;(s=(0,S.Z)(function*(r,o,l){try{const u=yield o.getMetadata();if(yield function(E,x){const P=N(E),F=Re(x.createTime);return P.persistence.runTransaction("hasNewerBundle","readonly",Z=>P.Je.getBundleMetadata(Z,x.id)).then(Z=>!!Z&&Z.createTime.compareTo(F)>=0)}(r.localStore,u))return yield o.close(),void l._completeWith((E=u,{taskState:"Success",documentsLoaded:E.totalDocuments,bytesLoaded:E.totalBytes,totalDocuments:E.totalDocuments,totalBytes:E.totalBytes}));l._updateProgress(bh(u));const d=new hg(u,r.localStore,o.N);let g=yield o.Qo();for(;g;){const E=yield d.fo(g);E&&l._updateProgress(E),g=yield o.Qo()}const _=yield d.complete();yield jt(r,_.En,void 0),yield function(E,x){const P=N(E);return P.persistence.runTransaction("Save bundle","readwrite",F=>P.Je.saveBundleMetadata(F,x))}(r.localStore,u),l._completeWith(_.progress)}catch(u){ys("SyncEngine",`Loading bundle failed with ${u}`),l._failWith(u)}var E}),function(r,o,l){return s.apply(this,arguments)})(i,e,t).then(()=>{i.sharedClientState.notifyBundleLoaded()})}(yield yc(n),s,i)}))}(t,n._databaseId,e,i),i}(this._delegate,e)}namedQuery(e){return function(n,e){return function(n,e){return n.asyncQueue.enqueue((0,S.Z)(function*(){return function(t,i){const s=N(t);return s.persistence.runTransaction("Get named query","readonly",r=>s.Je.getNamedQuery(r,i))}(yield mc(n),e)}))}(Se(n=W(n,de)),e).then(t=>t?new Be(n,null,t.query):null)}(this._delegate,e).then(t=>t?new Ke(this,t):null)}}class Jr extends xc{constructor(e){super(),this.firestore=e}convertBytes(e){return new Zs(new Dt(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return lt.forKey(t,this.firestore,null)}}class wd{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Jr(e)}get(e){const t=ni(e);return this._delegate.get(t).then(i=>new $s(this._firestore,new Zt(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,t.converter)))}set(e,t,i){const s=ni(e);return i?(Ac("Transaction.set",i),this._delegate.set(s,t,i)):this._delegate.set(s,t),this}update(e,t,i,...s){const r=ni(e);return 2===arguments.length?this._delegate.update(r,t):this._delegate.update(r,t,i,...s),this}delete(e){const t=ni(e);return this._delegate.delete(t),this}}class bd{constructor(e){this._delegate=e}set(e,t,i){const s=ni(e);return i?(Ac("WriteBatch.set",i),this._delegate.set(s,t,i)):this._delegate.set(s,t),this}update(e,t,i,...s){const r=ni(e);return 2===arguments.length?this._delegate.update(r,t):this._delegate.update(r,t,i,...s),this}delete(e){const t=ni(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class ti{constructor(e,t,i){this._firestore=e,this._userDataWriter=t,this._delegate=i}fromFirestore(e,t){const i=new js(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Hs(this._firestore,i),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const i=ti.INSTANCES;let s=i.get(e);s||(s=new WeakMap,i.set(e,s));let r=s.get(t);return r||(r=new ti(e,new Jr(e),t),s.set(t,r)),r}}ti.INSTANCES=new WeakMap;class lt{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Jr(e)}static forPath(e,t,i){if(e.length%2!=0)throw new A("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new lt(t,new se(t._delegate,i,new O(e)))}static forKey(e,t,i){return new lt(t,new se(t._delegate,i,e))}get id(){return this._delegate.id}get parent(){return new Qi(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Qi(this.firestore,Kh(this._delegate,e))}catch(t){throw je(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,$.m9)(e))instanceof se&&Zh(this._delegate,e)}set(e,t){t=Ac("DocumentReference.set",t);try{return t?pd(this._delegate,e,t):pd(this._delegate,e)}catch(i){throw je(i,"setDoc()","DocumentReference.set()")}}update(e,t,...i){try{return 1===arguments.length?gd(this._delegate,e):gd(this._delegate,e,t,...i)}catch(s){throw je(s,"updateDoc()","DocumentReference.update()")}}delete(){return function(n){return Yi(W(n.firestore,de),[new Cs(n._key,be.none())])}(this._delegate)}onSnapshot(...e){const t=Td(e),i=Ed(e,s=>new $s(this.firestore,new Zt(this.firestore._delegate,this._userDataWriter,s._key,s._document,s.metadata,this._delegate.converter)));return md(this._delegate,t,i)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function(n){n=W(n,se);const e=W(n.firestore,de),t=Se(e),i=new ei(e);return function(n,e){const t=new xe;return n.asyncQueue.enqueueAndForget((0,S.Z)(function*(){return(i=(0,S.Z)(function*(s,r,o){try{const l=yield function(u,d){const g=N(u);return g.persistence.runTransaction("read document","readonly",_=>g.Qn.An(_,d))}(s,r);l.isFoundDocument()?o.resolve(l):l.isNoDocument()?o.resolve(null):o.reject(new A(T.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(l){const u=zi(l,`Failed to get document '${r} from cache`);o.reject(u)}}),function(s,r,o){return i.apply(this,arguments)})(yield mc(n),e,t);var i})),t.promise}(t,n._key).then(s=>new Zt(e,i,n._key,s,new Jn(null!==s&&s.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===(null==e?void 0:e.source)?function(n){n=W(n,se);const e=W(n.firestore,de);return Fh(Se(e),n._key,{source:"server"}).then(t=>Cc(e,n,t))}(this._delegate):function(n){n=W(n,se);const e=W(n.firestore,de);return Fh(Se(e),n._key).then(t=>Cc(e,n,t))}(this._delegate),t.then(i=>new $s(this.firestore,new Zt(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(e){return new lt(this.firestore,this._delegate.withConverter(e?ti.getInstance(this.firestore,e):null))}}function je(n,e,t){return n.message=n.message.replace(e,t),n}function Td(n){for(const e of n)if("object"==typeof e&&!Rc(e))return e;return{}}function Ed(n,e){var t,i;let s;return s=Rc(n[0])?n[0]:Rc(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:r=>{s.next&&s.next(e(r))},error:null===(t=s.error)||void 0===t?void 0:t.bind(s),complete:null===(i=s.complete)||void 0===i?void 0:i.bind(s)}}class $s{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new lt(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return sd(this._delegate,e._delegate)}}class Hs extends $s{data(e){const t=this._delegate.data(e);return function(n,e){n||M()}(void 0!==t),t}}class Ke{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Jr(e)}where(e,t,i){try{return new Ke(this.firestore,gn(this._delegate,function(n,e,t){const i=e,s=Wr("where",n);return new gm(s,i,t)}(e,t,i)))}catch(s){throw je(s,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Ke(this.firestore,gn(this._delegate,function(n,e="asc"){const t=e,i=Wr("orderBy",n);return new ym(i,t)}(e,t)))}catch(i){throw je(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Ke(this.firestore,gn(this._delegate,function(n){return zh("limit",n),new od("limit",n,"F")}(e)))}catch(t){throw je(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Ke(this.firestore,gn(this._delegate,function(n){return zh("limitToLast",n),new od("limitToLast",n,"L")}(e)))}catch(t){throw je(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Ke(this.firestore,gn(this._delegate,function(...n){return new ad("startAt",n,!0)}(...e)))}catch(t){throw je(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Ke(this.firestore,gn(this._delegate,function(...n){return new ad("startAfter",n,!1)}(...e)))}catch(t){throw je(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Ke(this.firestore,gn(this._delegate,function(...n){return new cd("endBefore",n,!0)}(...e)))}catch(t){throw je(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Ke(this.firestore,gn(this._delegate,function(...n){return new cd("endAt",n,!1)}(...e)))}catch(t){throw je(t,"endAt()","Query.endAt()")}}isEqual(e){return $h(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?function(n){n=W(n,Be);const e=W(n.firestore,de),t=Se(e),i=new ei(e);return function(n,e){const t=new xe;return n.asyncQueue.enqueueAndForget((0,S.Z)(function*(){return(i=(0,S.Z)(function*(s,r,o){try{const l=yield Fr(s,r,!0),u=new Ih(r,l.Gn),d=u.Io(l.documents),g=u.applyChanges(d,!1);o.resolve(g.snapshot)}catch(l){const u=zi(l,`Failed to execute query '${r} against cache`);o.reject(u)}}),function(s,r,o){return i.apply(this,arguments)})(yield mc(n),e,t);var i})),t.promise}(t,n._query).then(s=>new pn(e,i,n,s))}(this._delegate):"server"===(null==e?void 0:e.source)?function(n){n=W(n,Be);const e=W(n.firestore,de),t=Se(e),i=new ei(e);return Uh(t,n._query,{source:"server"}).then(s=>new pn(e,i,n,s))}(this._delegate):function(n){n=W(n,Be);const e=W(n.firestore,de),t=Se(e),i=new ei(e);return rd(n._query),Uh(t,n._query).then(s=>new pn(e,i,n,s))}(this._delegate),t.then(i=>new Pc(this.firestore,new pn(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...e){const t=Td(e),i=Ed(e,s=>new Pc(this.firestore,new pn(this.firestore._delegate,this._userDataWriter,this._delegate,s._snapshot)));return md(this._delegate,t,i)}withConverter(e){return new Ke(this.firestore,this._delegate.withConverter(e?ti.getInstance(this.firestore,e):null))}}class Hm{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Hs(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Pc{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Ke(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new Hs(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new Hm(this._firestore,t))}forEach(e,t){this._delegate.forEach(i=>{e.call(t,new Hs(this._firestore,i))})}isEqual(e){return sd(this._delegate,e._delegate)}}class Qi extends Ke{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new lt(this.firestore,e):null}doc(e){try{return new lt(this.firestore,void 0===e?Zr(this._delegate):Zr(this._delegate,e))}catch(t){throw je(t,"doc()","CollectionReference.doc()")}}add(e){return function(n,e){const t=W(n.firestore,de),i=Zr(n),s=Xr(n.converter,e);return Yi(t,[Yr(Wn(n.firestore),"addDoc",i._key,s,null!==n.converter,{}).toMutation(i._key,be.exists(!1))]).then(()=>i)}(this._delegate,e).then(t=>new lt(this.firestore,t))}isEqual(e){return Zh(this._delegate,e._delegate)}withConverter(e){return new Qi(this.firestore,this._delegate.withConverter(e?ti.getInstance(this.firestore,e):null))}}function ni(n){return W(n,se)}class Nc{constructor(...e){this._delegate=new Kt(...e)}static documentId(){return new Nc(Le.keyField().canonicalString())}isEqual(e){return(e=(0,$.m9)(e))instanceof Kt&&this._delegate._internalPath.isEqual(e._internalPath)}}class ii{constructor(e){this._delegate=e}static serverTimestamp(){const e=new bc("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new ii(e)}static delete(){const e=new Gs("deleteField");return e._methodName="FieldValue.delete",new ii(e)}static arrayUnion(...e){const t=function(...n){return new lm("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new ii(t)}static arrayRemove(...e){const t=function(...n){return new um("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new ii(t)}static increment(e){const t=function(n){return new hm("increment",n)}(e);return t._methodName="FieldValue.increment",new ii(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const Ym={Firestore:vd,GeoPoint:$r,Timestamp:Ce,Blob:Zs,Transaction:wd,WriteBatch:bd,DocumentReference:lt,DocumentSnapshot:$s,Query:Ke,QueryDocumentSnapshot:Hs,QuerySnapshot:Pc,CollectionReference:Qi,FieldPath:Nc,FieldValue:ii,setLogLevel:function(n){!function(n){sn.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};!function(n){(function(n,e){n.INTERNAL.registerComponent(new _n.wA("firestore-compat",t=>((e,t)=>new vd(e,t,new Zm))(t.getProvider("app-compat").getImmediate(),t.getProvider("firestore").getImmediate()),"PUBLIC").setServiceProps(Object.assign({},Ym)))})(n),n.registerVersion("@firebase/firestore-compat","0.1.4")}(Ct.Z);var yn=I(3820),Xm=I(2965);function Id(n,e){return function(n,e=re.z){return new f.y(t=>{let i;return null!=e?e.schedule(()=>{i=n.onSnapshot({includeMetadataChanges:!0},t)}):i=n.onSnapshot({includeMetadataChanges:!0},t),()=>{null!=i&&i()}})}(n,e)}function kc(n,e){return Id(n,e).pipe((0,pe.U)(t=>({payload:t,type:"query"})))}function eo(n,e){return kc(n,e).pipe((0,Ne.O)(void 0),(0,me.G)(),(0,pe.U)(([t,i])=>{const s=i.payload.docChanges(),r=s.map(o=>({type:o.type,payload:o}));return t&&JSON.stringify(t.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((o,l)=>{const u=s.find(g=>g.doc.ref.isEqual(o.ref)),d=null==t?void 0:t.payload.docs.find(g=>g.ref.isEqual(o.ref));u&&JSON.stringify(u.doc.metadata)===JSON.stringify(o.metadata)||!u&&d&&JSON.stringify(d.metadata)===JSON.stringify(o.metadata)||r.push({type:"modified",payload:{oldIndex:l,newIndex:l,type:"modified",doc:o}})}),r}))}function Sd(n,e,t){return eo(n,t).pipe((0,st.R)((i,s)=>function(n,e,t){return e.forEach(i=>{t.indexOf(i.type)>-1&&(n=function(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return Lc(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return Lc(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Lc(n,e.oldIndex,1)}return n}(n,i))}),n}(i,s.map(r=>r.payload),e),[]),(0,Yt.x)(),(0,pe.U)(i=>i.map(s=>({type:s.type,payload:s}))))}function Lc(n,e,t,...i){const s=n.slice();return s.splice(e,t,...i),s}function Dd(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}I(7841);class xd{constructor(e,t,i){this.ref=e,this.query=t,this.afs=i}stateChanges(e){let t=eo(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe((0,pe.U)(i=>i.filter(s=>e.indexOf(s.type)>-1)))),t.pipe((0,Ne.O)(void 0),(0,me.G)(),(0,ne.h)(([i,s])=>s.length>0||!i),(0,pe.U)(([i,s])=>s),J.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,st.R)((t,i)=>[...t,...i],[]))}snapshotChanges(e){const t=Dd(e);return Sd(this.query,t,this.afs.schedulers.outsideAngular).pipe(J.iC)}valueChanges(e={}){return kc(this.query,this.afs.schedulers.outsideAngular).pipe((0,pe.U)(t=>t.payload.docs.map(i=>e.idField?Object.assign(Object.assign({},i.data()),{[e.idField]:i.id}):i.data())),J.iC)}get(e){return(0,V.D)(this.query.get(e)).pipe(J.iC)}add(e){return this.ref.add(e)}doc(e){return new Cd(this.ref.doc(e),this.afs)}}class Cd{constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const i=this.ref.collection(e),{ref:s,query:r}=Ad(i,t);return new xd(s,r,this.afs)}snapshotChanges(){return function(n,e){return Id(n,e).pipe((0,Ne.O)(void 0),(0,me.G)(),(0,pe.U)(([t,i])=>i.exists?(null==t?void 0:t.exists)?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(J.iC)}valueChanges(e={}){return this.snapshotChanges().pipe((0,pe.U)(({payload:t})=>e.idField?Object.assign(Object.assign({},t.data()),{[e.idField]:t.id}):t.data()))}get(e){return(0,V.D)(this.ref.get(e)).pipe(J.iC)}}class iy{constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?eo(this.query,this.afs.schedulers.outsideAngular).pipe((0,pe.U)(t=>t.filter(i=>e.indexOf(i.type)>-1)),(0,ne.h)(t=>t.length>0),J.iC):eo(this.query,this.afs.schedulers.outsideAngular).pipe(J.iC)}auditTrail(e){return this.stateChanges(e).pipe((0,st.R)((t,i)=>[...t,...i],[]))}snapshotChanges(e){const t=Dd(e);return Sd(this.query,t,this.afs.schedulers.outsideAngular).pipe(J.iC)}valueChanges(e={}){return kc(this.query,this.afs.schedulers.outsideAngular).pipe((0,pe.U)(i=>i.payload.docs.map(s=>e.idField?Object.assign({[e.idField]:s.id},s.data()):s.data())),J.iC)}get(e){return(0,V.D)(this.query.get(e)).pipe(J.iC)}}const sy=new v.OlP("angularfire2.enableFirestorePersistence"),ry=new v.OlP("angularfire2.firestore.persistenceSettings"),oy=new v.OlP("angularfire2.firestore.settings"),ay=new v.OlP("angularfire2.firestore.use-emulator");function Ad(n,e=(t=>t)){return{query:e(n),ref:n}}let cy=(()=>{class n{constructor(t,i,s,r,o,l,u,d,g,_,E,x,P,F,Z,fe,gt){this.schedulers=u;const xt=(0,$e.on)(t,l,i),$t=g;_&&(0,yn.nw)(xt,l,E,P,F,Z,x,fe),[this.firestore,this.persistenceEnabled$]=(0,$e.cc)(`${xt.name}.firestore`,"AngularFirestore",xt.name,()=>{const Ht=l.runOutsideAngular(()=>xt.firestore());if(r&&Ht.settings(r),$t&&Ht.useEmulator(...$t),s&&!(0,ri.PM)(o)){const to=()=>{try{return(0,V.D)(Ht.enablePersistence(d||void 0).then(()=>!0,()=>!1))}catch(uy){return"undefined"!=typeof console&&console.warn(uy),(0,j.of)(!1)}};return[Ht,l.runOutsideAngular(to)]}return[Ht,(0,j.of)(!1)]},[r,$t,s])}collection(t,i){let s;s="string"==typeof t?this.firestore.collection(t):t;const{ref:r,query:o}=Ad(s,i),l=this.schedulers.ngZone.run(()=>r);return new xd(l,o,this)}collectionGroup(t,i){const s=i||(o=>o),r=this.firestore.collectionGroup(t);return new iy(s(r),this)}doc(t){let i;i="string"==typeof t?this.firestore.doc(t):t;const s=this.schedulers.ngZone.run(()=>i);return new Cd(s,this)}createId(){return this.firestore.collection("_").doc().id}}return n.\u0275fac=function(t){return new(t||n)(v.LFG($e.Dh),v.LFG($e.xv,8),v.LFG(sy,8),v.LFG(oy,8),v.LFG(v.Lbi),v.LFG(v.R0b),v.LFG(J.HU),v.LFG(ry,8),v.LFG(ay,8),v.LFG(yn.zQ,8),v.LFG(yn.Qv,8),v.LFG(yn.L6,8),v.LFG(yn._Q,8),v.LFG(yn.rT,8),v.LFG(yn.lh,8),v.LFG(yn.f7,8),v.LFG(Xm.nm,8))},n.\u0275prov=v.Yz7({token:n,factory:n.\u0275fac,providedIn:"any"}),n})(),ly=(()=>{class n{constructor(t){this.db=t,this._dbPath="/repository",this.repositoryRef=t.collection(this._dbPath)}get data(){return this.repositoryRef}setUrl(t){this.repositoryRef=this.db.collection(t),this._dbPath=t}updateData(t){return this._dbPath="/templateff",this.db.collection(this._dbPath).add(t).then(i=>i)}createRepository(t){return this._dbPath="/repositoryNew",this.db.collection(this._dbPath).add(t).then(i=>i)}}return n.\u0275fac=function(t){return new(t||n)(v.LFG(cy))},n.\u0275prov=v.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})()},531:(si,Ze,I)=>{I.d(Ze,{F:()=>V});var v=I(7636),re=I(7716),f=I(625);let V=(()=>{class j{constructor(Ne){this._ovelay=Ne}display(Ne,me){const pe=Ne;this.overlayRef=this._ovelay.create({hasBackdrop:!0,backdropClass:"cdk-overlay-transparent-backdrop",panelClass:"vorkurt-overlay",positionStrategy:this._ovelay.position().flexibleConnectedTo(pe).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"center",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"end",overlayY:"top"}])}),this.component=new v.C5(me),this.overlayRef.attach(this.component),this.overlayRef.backdropClick().subscribe(()=>{this.overlayRef.detach(),this.overlayRef.dispose()})}closeOverlay(){this.overlayRef.detach()}}return j.\u0275fac=function(Ne){return new(Ne||j)(re.LFG(f.aV))},j.\u0275prov=re.Yz7({token:j,factory:j.\u0275fac,providedIn:"root"}),j})()},2809:(si,Ze,I)=>{I.d(Ze,{f:()=>f});var v=I(6215),re=I(7716);let f=(()=>{class V{constructor(){this.timerArray=new Array,this._counterData=new v.X(new Array),this.counterData$=this._counterData.asObservable()}sendCounterData(J){J.id=0===this.timerArray.length?1:this.timerArray.length+1,this.timerArray.push(J),this._counterData.next(this.timerArray)}}return V.\u0275fac=function(J){return new(J||V)},V.\u0275prov=re.Yz7({token:V,factory:V.\u0275fac,providedIn:"root"}),V})()}}]);